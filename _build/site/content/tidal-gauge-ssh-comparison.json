{"version":3,"kind":"Notebook","sha256":"cbe9eabedabb2ddec40f2ed433b4b385c69534caace6673cd8b02beb5affde81","slug":"tidal-gauge-ssh-comparison","location":"/Tidal_gauge_ssh_comparison.ipynb","dependencies":[],"frontmatter":{"title":"A comparison of model SSH and tidal gauge data","content_includes_title":false,"kernelspec":{"name":"roms-tools","display_name":"Python (My roms-tools Kernel)","language":"python"},"exports":[{"format":"ipynb","filename":"Tidal_gauge_ssh_comparison.ipynb","url":"/Tidal_gauge_ssh_comp-5925e0340aa156965b032fee9a4668f5.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import subprocess\nimport os\n\nimport netCDF4\nimport numpy as np\nimport glob\nimport time\nimport matplotlib.pyplot as plt\nimport copy\nimport xarray as xr\nfrom datetime import datetime, timedelta \nfrom roms_regrid import *\nfrom celluloid import Camera \nimport cartopy.crs as ccrs\nimport seawater as sw\nimport pandas as pd","key":"lDzxrlTn94"},{"type":"outputs","id":"B33Kx2WfMHBqa2RZwW9hF","children":[],"key":"wYscXswiCG"}],"key":"CXIvetoeRf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\nimport xarray as xr\n\n# Read file\nf='/home/x-uheede/R/HAFRO/Grundartangi_01012024-30122024.xlsx'\ngrundartangi = pd.read_excel(f, decimal=',')\n\n# Parse time\ntime = grundartangi['Timabil'].str.strip()\ntime = pd.to_datetime(time, format=\"%H:%M\\n%d.%m.%Y\", dayfirst=True)\n\n# Replace column\ngrundartangi['time'] = time\n\n# Set time as index (optional but recommended)\ngrundartangi = grundartangi.set_index('time')\n\n# Convert to xarray\nds = xr.Dataset.from_dataframe(grundartangi)\nds = ds.sortby(\"time\")\nds\n","key":"elBYdgeUFY"},{"type":"outputs","id":"9-KtQEiXhGAXa6iqDsB3O","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"f6dce6fcb50a91f02d660354e001f845","path":"/f6dce6fcb50a91f02d660354e001f845.html"},"text/plain":{"content":"<xarray.Dataset> Size: 5MB\nDimensions:               (time: 52561)\nCoordinates:\n  * time                  (time) datetime64[ns] 420kB 2024-01-01 ... 2024-12-31\nData variables:\n    Timabil               (time) object 420kB '00:00 01.01.2024 ' ... '00:00 ...\n    Flodtafla (m)         (time) float64 420kB 2.56 2.46 2.36 ... 1.01 0.97 0.93\n    Sj (m)                (time) float64 420kB 2.9 2.83 2.73 ... -3.73 -3.73\n    Vindur (m/s)          (time) int64 420kB 1 1 1 1 2 1 1 3 ... 7 8 7 8 8 8 8 8\n    Hvidda (m/s)          (time) int64 420kB 1 2 2 2 2 2 2 ... 9 9 9 10 10 10 9\n    Vindatt               (time) int64 420kB 57 356 354 341 37 ... 59 58 58 59\n    Loftværstingur (hpa)  (time) int64 420kB 998 998 998 998 ... 1013 1013 1013\n    Lofthiti ©            (time) float64 420kB -4.0 -5.2 -4.7 ... -5.1 -4.5 -4.6\n    Sjavarhiti ©          (time) float64 420kB 2.1 2.1 2.1 2.2 ... 1.5 1.6 1.7\n    Selta (PSU)           (time) float64 420kB 20.54 20.52 20.53 ... 20.05 20.05\n    Unnamed: 10           (time) object 420kB '  ' '  ' '  ' ... '  ' '  ' '  '","content_type":"text/plain"}}},"children":[],"key":"JxUVy6GWG7"}],"key":"fhBVQMUCAy"}],"key":"FKC3ZOVPCd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"grundartangi","key":"cDWJr99bBQ"},{"type":"outputs","id":"N7ohuefy_Oi_AfwgF9m5E","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Timabil</th>\n      <th>Flodtafla (m)</th>\n      <th>Sj (m)</th>\n      <th>Vindur (m/s)</th>\n      <th>Hvidda (m/s)</th>\n      <th>Vindatt</th>\n      <th>Loftværstingur (hpa)</th>\n      <th>Lofthiti ©</th>\n      <th>Sjavarhiti ©</th>\n      <th>Selta (PSU)</th>\n      <th>Unnamed: 10</th>\n    </tr>\n    <tr>\n      <th>time</th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2024-12-31 00:00:00</th>\n      <td>00:00 31.12.2024</td>\n      <td>0.93</td>\n      <td>-3.73</td>\n      <td>8</td>\n      <td>9</td>\n      <td>59</td>\n      <td>1013</td>\n      <td>-4.6</td>\n      <td>1.7</td>\n      <td>20.05</td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>2024-12-30 23:50:00</th>\n      <td>23:50 30.12.2024</td>\n      <td>0.97</td>\n      <td>-3.73</td>\n      <td>8</td>\n      <td>10</td>\n      <td>58</td>\n      <td>1013</td>\n      <td>-4.5</td>\n      <td>1.6</td>\n      <td>20.05</td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>2024-12-30 23:40:00</th>\n      <td>23:40 30.12.2024</td>\n      <td>1.01</td>\n      <td>-3.73</td>\n      <td>8</td>\n      <td>10</td>\n      <td>58</td>\n      <td>1013</td>\n      <td>-5.1</td>\n      <td>1.5</td>\n      <td>20.05</td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>2024-12-30 23:30:00</th>\n      <td>23:30 30.12.2024</td>\n      <td>1.07</td>\n      <td>-3.73</td>\n      <td>8</td>\n      <td>10</td>\n      <td>59</td>\n      <td>1013</td>\n      <td>-4.8</td>\n      <td>1.5</td>\n      <td>20.05</td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>2024-12-30 23:20:00</th>\n      <td>23:20 30.12.2024</td>\n      <td>1.13</td>\n      <td>-3.73</td>\n      <td>8</td>\n      <td>9</td>\n      <td>57</td>\n      <td>1013</td>\n      <td>-4.7</td>\n      <td>1.5</td>\n      <td>20.05</td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>2024-01-01 00:40:00</th>\n      <td>00:40 01.01.2024</td>\n      <td>2.16</td>\n      <td>2.52</td>\n      <td>2</td>\n      <td>2</td>\n      <td>37</td>\n      <td>998</td>\n      <td>-3.0</td>\n      <td>2.2</td>\n      <td>20.55</td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>2024-01-01 00:30:00</th>\n      <td>00:30 01.01.2024</td>\n      <td>2.26</td>\n      <td>2.63</td>\n      <td>1</td>\n      <td>2</td>\n      <td>341</td>\n      <td>998</td>\n      <td>-4.1</td>\n      <td>2.2</td>\n      <td>20.55</td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>2024-01-01 00:20:00</th>\n      <td>00:20 01.01.2024</td>\n      <td>2.36</td>\n      <td>2.73</td>\n      <td>1</td>\n      <td>2</td>\n      <td>354</td>\n      <td>998</td>\n      <td>-4.7</td>\n      <td>2.1</td>\n      <td>20.53</td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>2024-01-01 00:10:00</th>\n      <td>00:10 01.01.2024</td>\n      <td>2.46</td>\n      <td>2.83</td>\n      <td>1</td>\n      <td>2</td>\n      <td>356</td>\n      <td>998</td>\n      <td>-5.2</td>\n      <td>2.1</td>\n      <td>20.52</td>\n      <td></td>\n    </tr>\n    <tr>\n      <th>2024-01-01 00:00:00</th>\n      <td>00:00 01.01.2024</td>\n      <td>2.56</td>\n      <td>2.90</td>\n      <td>1</td>\n      <td>1</td>\n      <td>57</td>\n      <td>998</td>\n      <td>-4.0</td>\n      <td>2.1</td>\n      <td>20.54</td>\n      <td></td>\n    </tr>\n  </tbody>\n</table>\n<p>52561 rows × 11 columns</p>\n</div>","content_type":"text/html"},"text/plain":{"content":"                               Timabil  Flodtafla (m)  Sj (m)  Vindur (m/s)  \\\ntime                                                                          \n2024-12-31 00:00:00  00:00 31.12.2024            0.93   -3.73             8   \n2024-12-30 23:50:00  23:50 30.12.2024            0.97   -3.73             8   \n2024-12-30 23:40:00  23:40 30.12.2024            1.01   -3.73             8   \n2024-12-30 23:30:00  23:30 30.12.2024            1.07   -3.73             8   \n2024-12-30 23:20:00  23:20 30.12.2024            1.13   -3.73             8   \n...                                ...            ...     ...           ...   \n2024-01-01 00:40:00  00:40 01.01.2024            2.16    2.52             2   \n2024-01-01 00:30:00  00:30 01.01.2024            2.26    2.63             1   \n2024-01-01 00:20:00  00:20 01.01.2024            2.36    2.73             1   \n2024-01-01 00:10:00  00:10 01.01.2024            2.46    2.83             1   \n2024-01-01 00:00:00  00:00 01.01.2024            2.56    2.90             1   \n\n                     Hvidda (m/s)  Vindatt  Loftværstingur (hpa)  Lofthiti ©  \\\ntime                                                                           \n2024-12-31 00:00:00             9       59                  1013        -4.6   \n2024-12-30 23:50:00            10       58                  1013        -4.5   \n2024-12-30 23:40:00            10       58                  1013        -5.1   \n2024-12-30 23:30:00            10       59                  1013        -4.8   \n2024-12-30 23:20:00             9       57                  1013        -4.7   \n...                           ...      ...                   ...         ...   \n2024-01-01 00:40:00             2       37                   998        -3.0   \n2024-01-01 00:30:00             2      341                   998        -4.1   \n2024-01-01 00:20:00             2      354                   998        -4.7   \n2024-01-01 00:10:00             2      356                   998        -5.2   \n2024-01-01 00:00:00             1       57                   998        -4.0   \n\n                     Sjavarhiti ©  Selta (PSU) Unnamed: 10  \ntime                                                        \n2024-12-31 00:00:00           1.7        20.05              \n2024-12-30 23:50:00           1.6        20.05              \n2024-12-30 23:40:00           1.5        20.05              \n2024-12-30 23:30:00           1.5        20.05              \n2024-12-30 23:20:00           1.5        20.05              \n...                           ...          ...         ...  \n2024-01-01 00:40:00           2.2        20.55              \n2024-01-01 00:30:00           2.2        20.55              \n2024-01-01 00:20:00           2.1        20.53              \n2024-01-01 00:10:00           2.1        20.52              \n2024-01-01 00:00:00           2.1        20.54              \n\n[52561 rows x 11 columns]","content_type":"text/plain"}}},"children":[],"key":"Grd6iWmD68"}],"key":"OED5gt7wmW"}],"key":"qJdqZKZBx7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(ds.time)","key":"dwSlOCarPB"},{"type":"outputs","id":"fLe0FnsFeJfiSrVwWDDfD","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fde862b8429ebe9c8c985c71278c2a58","path":"/fde862b8429ebe9c8c985c71278c2a58.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"SbQUGyYerz"}],"key":"S7yoUruVkK"}],"key":"qOEYddhGnL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"\nmodel_grid_path=\"/home/x-uheede/S/Iceland2_MARBL_2024_60m/P_INPUT/Iceland2_grid_MAT1.nc\"\n# Grid parameters, only modify these if grid is made in MATLAB\nvert_levels=60\ntheta_s_model=5\ntheta_b_model=2\nhc_model=300\nmodel_data_path=\"/anvil/scratch/x-uheede/Iceland2_NOMARBL_2024_RHALF/Iceland2_MARBL_2024_his.20240?????????.nc\"\n","key":"Va4eW7ggVc"},{"type":"outputs","id":"K1ykOJljC6vC4etUauM4s","children":[],"key":"V8s4B6vDEa"}],"key":"h1Jor6rn1r"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from roms_tools import Grid, ROMSOutput\ngrid = Grid.from_file(\n    model_grid_path\n)\n","key":"OJsEZDX0FM"},{"type":"outputs","id":"8FlKdjOE9c1DjTmztOudD","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-12-09 14:53:09 - WARNING - Vertical coordinates (Cs_r, Cs_w) not found in grid file.\n2025-12-09 14:53:09 - INFO - === Preparing the vertical coordinate system using N = 100, theta_s = 5.0, theta_b = 2.0, hc = 300.0 ===\n2025-12-09 14:53:09 - INFO - Total time: 0.004 seconds\n2025-12-09 14:53:09 - INFO - ================================================================================================\n"},"children":[],"key":"vhMHLY3zvL"}],"key":"v17PkD9fWS"}],"key":"PuoJiGktKE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#Only run this cell if grid is made in MATLAB\ngrid.update_vertical_coordinate(N=vert_levels, theta_s=theta_s_model, theta_b=theta_b_model, hc=hc_model, verbose=False)","key":"UZPt573n5P"},{"type":"outputs","id":"hPOJtXS9_NfNpe7EmHp-8","children":[],"key":"U18NuJ5dvM"}],"key":"GnTL1405UY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import xarray as xr\nimport numpy as np\ntarget_depth_levels=[1,2,3,4,5,7,9,10,12,14,15,16,18,20,26,30,36,40,50,80] # Specify depth levels of interest\n# Load ROMS output using your pattern\nroms_output = ROMSOutput(\n    grid=grid,\n    path=[\n        model_data_path,\n    ],\n    use_dask=True,\n)\n\nds_model = roms_output.regrid(var_names=[\"zeta\"])","key":"G6WRklbvaq"},{"type":"outputs","id":"YilAAm6YIRKyei6NyUomV","children":[],"key":"sAQqiotxqZ"}],"key":"wMFA9hK4N2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds_model.load()","key":"eC7f8DP1R1"},{"type":"outputs","id":"eoLCPTxi5Qx8cuDx2u5xH","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":55,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"84b7d779a40c4d9d9b8722220429677b","path":"/84b7d779a40c4d9d9b8722220429677b.html"},"text/plain":{"content":"<xarray.Dataset> Size: 7GB\nDimensions:  (time: 5002, lat: 481, lon: 721)\nCoordinates:\n  * time     (time) datetime64[ns] 40kB 2024-02-01T12:00:00 ... 2024-08-27T04...\n  * lat      (lat) float32 2kB 63.0 63.0 63.01 63.01 ... 64.99 64.99 65.0 65.0\n  * lon      (lon) float32 3kB 336.0 336.0 336.0 336.0 ... 339.0 339.0 339.0\nData variables:\n    zeta     (time, lat, lon) float32 7GB nan nan nan nan ... nan nan nan nan\nAttributes: (12/45)\n    global_x:           512\n    global_y:           512\n    title:              Iceland2_MARBL_2024 , 200 m  resolution\n    grid_file:          /anvil/scratch/x-uheede/Iceland2_MARBL_2024_60m/P_INP...\n    forcing_files:       /anvil/scratch/x-uheede/Iceland2_MARBL_2024_60m/P_IN...\n    forcing_info:       \n    ...                 ...\n    river_frc_options:  OFF\n    pipe_frc_options:   OFF\n    particle_options:   OFF\n    git_version:        \n    type:               ROMS history file\n    regrid_method:      bilinear","content_type":"text/plain"}}},"children":[],"key":"PaRp5l4SxE"}],"key":"BKlDtVbEU5"}],"key":"NJo3DX4Iso"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Identify duplicates in the time coordinate\nduplicates = ds_model['time'].to_index().duplicated()\n\n# Drop duplicate time steps\nds_model_unique = ds_model.sel(time=~duplicates)\n","key":"PdIciGKG6n"},{"type":"outputs","id":"0VHNvBxWev32MV5gQgbrJ","children":[],"key":"g4eQouswJB"}],"key":"cc4YXx9lFV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure(figsize=(14,5))\nplt.plot(ds[\"time\"].sel(time=slice('2024-06-01','2024-07-31')), ds[\"Flodtafla (m)\"].sel(time=slice('2024-06-01','2024-07-31')), color=\"steelblue\")\nplt.title(\"Sea Surface Height (Flodtafla) — Timeseries\")\nplt.xlabel(\"Time\")\nplt.ylabel(\"Sea Surface Height (m)\")\nplt.grid(True)\nplt.tight_layout()\nplt.show()","key":"Bfkw5tX9R5"},{"type":"outputs","id":"TBD3R4GTLffGiVc8oOSQz","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a0799cc9307e1e9d8873a5be48ac8cb8","path":"/a0799cc9307e1e9d8873a5be48ac8cb8.png"},"text/plain":{"content":"<Figure size 1400x500 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"pxxkNXAt6g"}],"key":"B45SoPomb7"}],"key":"WODs38svP8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\n\n#64.358799°N 21.769334°W\n\n# Convert lon_W to 0–360 range\nlon_target = 360 - 21.769334   # = 338.2242\nlat_target = 64.358799\n\n# Select nearest model grid point for zeta\nzeta_point = ds_model_unique[\"zeta\"].sel(\n    lon=lon_target, \n    lat=lat_target, \n    method=\"nearest\"\n)\n\n# Select same time window\nt0, t1 = \"2024-04-01\", \"2024-08-15\"\n\nssh_obs = ds[\"Flodtafla (m)\"].sel(time=slice(t0, t1))\nssh_time = ds[\"time\"].sel(time=slice(t0, t1))\n\nzeta_mod = zeta_point.sel(time=slice(t0, t1))\n\n\n# -------------------------------\n# 2-panel figure\n# -------------------------------\nfig, (ax1, ax2) = plt.subplots(\n    2, 1, figsize=(15, 8), sharex=True,\n    gridspec_kw={\"height_ratios\": [1, 1]}\n)\n\n# -------------------------------------\n# Panel 1 — Observed Flodtafla\n# -------------------------------------\nax1.plot(ssh_time, ssh_obs, color=\"steelblue\")\nax1.set_title(\"Observed Sea-surface Height (tidal gauge)\")\nax1.set_ylabel(\"SSH (m)\")\nax1.grid(True)\n\n# -------------------------------------\n# Panel 2 — Modeled zeta\n# -------------------------------------\nax2.plot(zeta_mod[\"time\"], zeta_mod, color=\"darkorange\")\nax2.set_title(\n    f\"Modeled Sea-surface Height (zeta)\\n(lat={lat_target:.4f}°, lon={lon_target:.4f}°)\"\n)\nax2.set_ylabel(\"SSH (m)\")\nax2.set_xlabel(\"Time\")\nax2.grid(True)\n\nplt.tight_layout()\nplt.show()\n","key":"cPoaJXReB1"},{"type":"outputs","id":"PFM8sPDTDSTLygtoRun5r","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f6e72e31b9397208df401dce9e9470a0","path":"/f6e72e31b9397208df401dce9e9470a0.png"},"text/plain":{"content":"<Figure size 1500x800 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"lYqZc4orLi"}],"key":"S8sPZc30tU"}],"key":"KPTuvlnVgG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\n\n# 64.358799°N 21.769334°W\n\n# Convert lon_W to 0–360 range\nlon_target = 360 - 21.769334   # = 338.230666\nlat_target = 64.358799\n\n# Select nearest model grid point for zeta\nzeta_point = ds_model_unique[\"zeta\"].sel(\n    lon=lon_target, \n    lat=lat_target, \n    method=\"nearest\"\n)\n\n# Select same time window\nt0, t1 = \"2024-04-01\", \"2024-08-15\"\n\nssh_obs = ds[\"Flodtafla (m)\"].sel(time=slice(t0, t1))\nssh_time = ds[\"time\"].sel(time=slice(t0, t1))\n\nzeta_mod = zeta_point.sel(time=slice(t0, t1))\n\n\n# --------------------------------------------------------\n# Compute mean SSH for observations and model\n# --------------------------------------------------------\nmean_obs = float(ssh_obs.mean())\nmean_mod = float(zeta_mod.mean())\n\n# Compute offset so means match\noffset = mean_obs - mean_mod\n\nprint(\"Mean observed SSH  :\", mean_obs)\nprint(\"Mean modeled SSH   :\", mean_mod)\nprint(\"Vertical offset Δ  :\", offset)\n\n# Apply correction\nzeta_mod_corrected = zeta_mod + offset\n\n\n# --------------------------------------------------------\n# Plot 2-panel figure\n# --------------------------------------------------------\nfig, (ax1, ax2) = plt.subplots(\n    2, 1, figsize=(15, 8), sharex=True,\n    gridspec_kw={\"height_ratios\": [1, 1]}\n)\n\n# -------------------------------------\n# Panel 1 — Observed Flodtafla\n# -------------------------------------\nax1.plot(ssh_time, ssh_obs, color=\"steelblue\")\nax1.set_title(\"Observed Sea-surface Height (tidal gauge)\")\nax1.set_ylabel(\"SSH (m)\")\nax1.grid(True)\n\n# -------------------------------------\n# Panel 2 — Modeled zeta (mean-corrected)\n# -------------------------------------\nax2.plot(zeta_mod_corrected[\"time\"], zeta_mod_corrected, color=\"darkorange\")\nax2.set_title(\n    f\"Modeled Sea-surface Height (zeta) — Mean Adjusted\\n\"\n    f\"(lat={lat_target:.4f}°, lon={lon_target:.4f}°)\"\n)\nax2.set_ylabel(\"SSH (m)\")\nax2.set_xlabel(\"Time\")\nax2.grid(True)\n\nplt.tight_layout()\nplt.show()\n","key":"lxMngawvXV"},{"type":"outputs","id":"XKi3azXC2UW96OyGzjw9W","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Mean observed SSH  : 2.244110401459855\nMean modeled SSH   : -0.8107247948646545\nVertical offset Δ  : 3.0548351963245097\n"},"children":[],"key":"PouZdxfMJ3"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"112deb4ab80220ad06c55e6c8363dbaf","path":"/112deb4ab80220ad06c55e6c8363dbaf.png"},"text/plain":{"content":"<Figure size 1500x800 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"hr5JrisUZB"}],"key":"QcdNBgBemj"}],"key":"ryLR1ofSMx"}],"key":"vC0ElFtbns"},"references":{"cite":{"order":[],"data":{}}}}