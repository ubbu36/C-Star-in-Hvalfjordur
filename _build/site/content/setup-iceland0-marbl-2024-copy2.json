{"version":3,"kind":"Notebook","sha256":"9dcf071219334019631c7ac47dbc294a04203e8b6daa696f48fd2309b5053a84","slug":"setup-iceland0-marbl-2024-copy2","location":"/SETUP_Iceland0_MARBL_2024-Copy2.ipynb","dependencies":[],"frontmatter":{"title":"ROMS-TOOLS setup for Iceland0_MARBL_2024","content_includes_title":false,"kernelspec":{"name":"romstools-test","display_name":"Python (tomstools-test)","language":"python"},"exports":[{"format":"ipynb","filename":"SETUP_Iceland0_MARBL_2024-Copy2.ipynb","url":"/SETUP_Iceland0_MARBL-c202859190860724de6b36e4165ba413.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"First step is to set up the outer grid using ROMS-TOOLS and save the grid file.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zU4kYfM4wV"}],"key":"uF7V3EJDpv"}],"key":"NRN1kt0VY5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import xarray as xr\nfrom roms_tools import Grid","key":"Of0oVO2ytr"},{"type":"outputs","id":"fo5-NZ2TlJKUSWKMIun8L","children":[],"key":"nUOyOVERwn"}],"key":"oEmhFi5VVL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"project='/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/'\ndatasets='/anvil/projects/x-ees250129/Datasets/'\nmodel_name='Iceland0'\nchild_name='Iceland1'\ngrid_path='/anvil/projects/x-ees250129/x-uheede/MATLAB/setup_s2r_phys+bgc/1.Make_grid/Iceland0_grid_MAT.nc'","key":"IZmUbIEv0Z"},{"type":"outputs","id":"Q25UgmanG11ttYjmllcYe","children":[],"key":"QQTLhIYBE4"}],"key":"tNXXu4R3jY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#%%time\n\n#grid = Grid(\n#    nx=512,  # number of grid points in x-direction\n#    ny=512,  # number of grid points in y-direction\n#    size_x=1280,  # domain size in x-direction (in km)\n#    size_y=1280,  # domain size in y-direction (in km)\n#    center_lon=-25,  # longitude of the center of the domain\n#    center_lat=63,  # latitude of the center of the domain\n#    rot=-20,  # rotation of the grid (in degrees)\n#    topography_source={\n#        \"name\": \"SRTM15\",\n#        \"path\":datasets+\"SRTM15/SRTM15_V2.6.nc\"},\n#    N=100,  # number of vertical layers\n#    verbose=True,\n#)","key":"yT8dQbF7VI"},{"type":"outputs","id":"eUNlUfyGBxbFWgszBFRSW","children":[],"key":"omHZCvtUYc"}],"key":"Z874RolFCV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"grid = Grid.from_file(grid_path)","key":"h6MSUBaM4N"},{"type":"outputs","id":"j2MkFOgAStS93BklynWeV","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-20 13:00:02 - WARNING - Vertical coordinates (Cs_r, Cs_w) not found in grid file.\n2025-11-20 13:00:02 - INFO - === Preparing the vertical coordinate system using N = 100, theta_s = 5.0, theta_b = 2.0, hc = 300.0 ===\n2025-11-20 13:00:02 - INFO - Total time: 0.004 seconds\n2025-11-20 13:00:02 - INFO - ================================================================================================\n"},"children":[],"key":"Mihda1lpAE"}],"key":"P4ZaLYv6nr"}],"key":"ehhJXnU7K3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"\n","key":"dTY0JzbUn3"},{"type":"outputs","id":"w2Cl_CoCQnIUle7N5Jkru","children":[],"key":"GH3sIxHHG5"}],"key":"CVfQhNnPIK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"grid.update_vertical_coordinate(N=60, theta_s=5.0, theta_b=2.0, hc=300.0, verbose=False)","key":"B1Kf7PZTSM"},{"type":"outputs","id":"gkFetC7zDbkhxLB1FH7xH","children":[],"key":"jgPfXwPhsC"}],"key":"w2dc9jMgyd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"Tv3h9HKNNK"},{"type":"outputs","id":"ciDXdPr0zTwLZqdrg0MYZ","children":[],"key":"qqcFlZ31Yj"}],"key":"dZB8pokaI7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"grid.ds","key":"nkLpgkap54"},{"type":"outputs","id":"GJCoM5fN_sAZ3ZZbFQsFB","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"79aa83984adb5e4831a256ae48e0b6df","path":"/79aa83984adb5e4831a256ae48e0b6df.html"},"text/plain":{"content":"<xarray.Dataset> Size: 31MB\nDimensions:       (one: 1, eta_rho: 514, xi_rho: 514, xi_u: 513, eta_v: 513,\n                   eta_coarse: 258, xi_coarse: 258, s_rho: 60, s_w: 61)\nCoordinates:\n    lon_rho       (eta_rho, xi_rho) float64 2MB ...\n    lat_rho       (eta_rho, xi_rho) float64 2MB ...\n    lat_u         (eta_rho, xi_u) float64 2MB 58.73 58.73 58.73 ... 65.43 65.41\n    lon_u         (eta_rho, xi_u) float64 2MB 320.7 320.8 320.8 ... 352.9 352.9\n    lat_v         (eta_v, xi_rho) float64 2MB 58.74 58.74 58.74 ... 65.41 65.4\n    lon_v         (eta_v, xi_rho) float64 2MB 320.7 320.7 320.8 ... 352.9 352.9\n    lat_coarse    (eta_coarse, xi_coarse) float64 533kB 58.72 58.72 ... 65.41\n    lon_coarse    (eta_coarse, xi_coarse) float64 533kB 320.7 320.8 ... 353.0\nDimensions without coordinates: one, eta_rho, xi_rho, xi_u, eta_v, eta_coarse,\n                                xi_coarse, s_rho, s_w\nData variables: (12/20)\n    spherical     (one) |S1 1B ...\n    angle         (eta_rho, xi_rho) float64 2MB ...\n    h             (eta_rho, xi_rho) float64 2MB ...\n    hraw          (eta_rho, xi_rho) float64 2MB ...\n    f             (eta_rho, xi_rho) float64 2MB ...\n    pm            (eta_rho, xi_rho) float64 2MB ...\n    ...            ...\n    angle_coarse  (eta_coarse, xi_coarse) float64 533kB -0.1261 ... -0.6262\n    mask_coarse   (eta_coarse, xi_coarse) int32 266kB 1 1 1 1 1 1 ... 1 1 1 1 1\n    sigma_r       (s_rho) float32 240B -0.9917 -0.975 ... -0.025 -0.008333\n    Cs_r          (s_rho) float32 240B -0.9865 -0.9579 ... -0.0002471 -2.743e-05\n    sigma_w       (s_w) float32 244B -1.0 -0.9833 -0.9667 ... -0.01667 0.0\n    Cs_w          (s_w) float32 244B -1.0 -0.9725 -0.9429 ... -0.0001098 0.0\nAttributes:\n    Title:     ROMS grid by Easy Grid. Settings: nx: 512 ny: 512 xsize: 1280 ...\n    Date:      14-Oct-2025\n    Type:      ROMS grid produced by Easy Grid\n    straddle:  False\n    theta_s:   5.0\n    theta_b:   2.0\n    hc:        300.0","content_type":"text/plain"}}},"children":[],"key":"aIkeObl34W"}],"key":"nSydYjio6H"}],"key":"WNL70jNVFT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#mat_grid['h'].plot()","key":"Jg3JvY7VOv"},{"type":"outputs","id":"HspdNaNlyYOST5tw10WbM","children":[],"key":"LvGAFzbQH4"}],"key":"d6Bio1K4dA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"grid.plot()\n","key":"hFc9Iye6Gm"},{"type":"outputs","id":"bPDnO1DS-wUPNbz25UZXI","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c0617ebc27dd8444d13f1e7f858dd719","path":"/c0617ebc27dd8444d13f1e7f858dd719.png"},"text/plain":{"content":"<Figure size 1300x700 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"Mgirv0WsbU"}],"key":"D46vxzsOZL"}],"key":"XHWlbDoHPp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"filepath = project+model_name+'_grid_60.nc'\nyaml_filepath=project+model_name+'_grid_60.yaml'","key":"HZlYrPAfvt"},{"type":"outputs","id":"UQV6sfkltlNb5OP1N-pMn","children":[],"key":"nxX5KejSin"}],"key":"LVBAeccq3l"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"grid.save(filepath)","key":"rihXLQ3i2p"},{"type":"outputs","id":"az04aIOEdpYcU5TRqMFRu","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-20 13:00:03 - INFO - Writing the following NetCDF files:\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_grid_60.nc\n"},"children":[],"key":"TTvY7YHfSZ"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"[PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_grid_60.nc')]","content_type":"text/plain"}}},"children":[],"key":"Jh8pQJBzR1"}],"key":"Vz2RHiLWNL"}],"key":"znpAgiXkeG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"grid.to_yaml(yaml_filepath)","key":"Ylz0nsCwCO"},{"type":"outputs","id":"oGGcL4sncUmSVG3mZf-Lg","children":[],"key":"cdwQ8YDuIH"}],"key":"rI0tBn5TbP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"tpxo_path = datasets+\"TPXO/TPXO10.v2/\"\ntpxo_dict = {\n    \"grid\": tpxo_path + \"grid_tpxo10v2.nc\",\n    \"h\": tpxo_path + \"h_tpxo10.v2.nc\",\n    \"u\": tpxo_path + \"u_tpxo10.v2.nc\",\n}","key":"urwmosUh8Z"},{"type":"outputs","id":"WToWIUE8weIUV8JnhrwIR","children":[],"key":"YHNUSXe4lV"}],"key":"NbVkydhG5T"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next, we set up tidal forcing:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IH0Jll5OSF"}],"key":"qg0odzF124"}],"key":"m4toegeF2l"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from roms_tools import TidalForcing","key":"xDbgEk4sV2"},{"type":"outputs","id":"XxflvYVT8VXsaXUJJVs_D","children":[],"key":"t0jhOAJ5dt"}],"key":"zI57m7IbQK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from datetime import datetime","key":"hJKICriC01"},{"type":"outputs","id":"xrgyQdb9KH9T-N7BlvHK4","children":[],"key":"hA4uzfi01v"}],"key":"WQSwXRtsSi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model_reference_date = datetime(2000, 1, 1)","key":"NI3qB2yVzQ"},{"type":"outputs","id":"4OlSP-f3zbTxmglE0GvIV","children":[],"key":"x6aMPrAtiE"}],"key":"cZdVUi0V3w"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"\ntidal_forcing = TidalForcing(\n    grid=grid,\n    source={\"name\": \"TPXO\", \"path\": tpxo_dict},\n    ntides=15,  # Number of constituents to consider <= 15. Default is 10.\n    model_reference_date=model_reference_date,  # Model reference date. Default is January 1, 2000.\n    use_dask=True\n)","key":"l3cBZH9mMl"},{"type":"outputs","id":"7_BizmaizZk86ZChyOaoB","children":[],"key":"C7jLTO7yk1"}],"key":"i0RMu2ABo1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"filepath = project+model_name+\"_tides.nc\"","key":"BA14s09wQv"},{"type":"outputs","id":"2s-pAq5S_AtBi2xGUNVfp","children":[],"key":"Vh27vyQwfY"}],"key":"Lj4pucEL91"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%time tidal_forcing.save(filepath)","key":"HE0u90kA87"},{"type":"outputs","id":"iP6BybLIgviYfn5IoN1jp","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-20 13:00:08 - INFO - Writing the following NetCDF files:\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_tides.nc\n"},"children":[],"key":"hkR7vYlfe5"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[########################################] | 100% Completed | 7.18 sms\nCPU times: user 3min 4s, sys: 1.58 s, total: 3min 5s\nWall time: 7.35 s\n"},"children":[],"key":"BLC8lWqAP3"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/plain":{"content":"[PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_tides.nc')]","content_type":"text/plain"}}},"children":[],"key":"alZfJIam4B"}],"key":"ivnk8IQAfQ"}],"key":"kuvGGq2Hmv"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"For the surface forcing, we use ERA5 plus the unified BGC dataset","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y0YSP1JThW"}],"key":"SWh2Ghl9R3"}],"key":"Sg3q0Guejr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from roms_tools import Grid, SurfaceForcing","key":"neDQffOVGQ"},{"type":"outputs","id":"ZP5Lkiizu4Av2Rb6SALl1","children":[],"key":"UK9NPVPbWY"}],"key":"k7oDTUBQWg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"start_time = datetime(2024, 1, 1)\nend_time = datetime(2024, 6, 1)\nstart_time1 = datetime(2024, 6, 1)\nend_time1 = datetime(2024, 12, 1)","key":"XW5gj66syJ"},{"type":"outputs","id":"DMNSUne9_7ixjTuu39XG1","children":[],"key":"n8oVDlPLS7"}],"key":"fgFdphBTV9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"surface_forcing_kwargs = {\n    \"grid\": grid,\n    \"start_time\": start_time,\n    \"end_time\": end_time,\n    \"type\": \"physics\",\n    \"model_reference_date\": datetime(2000, 1, 1), # this is the default\n}","key":"xkL8yJo2W8"},{"type":"outputs","id":"ioLj6GWZtZJIvluHbZId4","children":[],"key":"YWyQrVD9Dv"}],"key":"SJaIQk7pe9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"surface_forcing_kwargs1 = {\n    \"grid\": grid,\n    \"start_time\": start_time1,\n    \"end_time\": end_time1,\n    \"type\": \"physics\",\n    \"model_reference_date\": datetime(2000, 1, 1), # this is the default\n}","key":"Y113UoY7td"},{"type":"outputs","id":"yAw1uGocxmu0vFgwZB1EJ","children":[],"key":"kijwjGNDkU"}],"key":"qQ7WqHmsrq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n\nsurface_forcing = SurfaceForcing(\n    **surface_forcing_kwargs,\n    source={\"name\": \"ERA5\"},\n    use_dask=True,\n)","key":"dltvHPFMIM"},{"type":"outputs","id":"f45kOO3OE9qmOPmkAegvJ","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-20 13:00:16 - INFO - No path specified for ERA5 source; defaulting to ARCO ERA5 dataset on Google Cloud.\n2025-11-20 13:02:02 - INFO - Data will be interpolated onto the grid coarsened by factor 2. Remember to set `interp_frc = 1` in your `bulk_frc.opt` ROMS option file.\n"},"children":[],"key":"fk5zemquGy"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"CPU times: user 4min 40s, sys: 8.72 s, total: 4min 48s\nWall time: 2min 46s\n"},"children":[],"key":"NpsqNvjyPi"}],"key":"QJqSlDVTW2"}],"key":"TecA01t5uH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n\nsurface_forcing1 = SurfaceForcing(\n    **surface_forcing_kwargs1,\n    source={\"name\": \"ERA5\"},\n    use_dask=True,\n)","key":"hMH7F1599K"},{"type":"outputs","id":"FatAw54u2WW0XvQFT1ee9","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-20 13:03:02 - INFO - No path specified for ERA5 source; defaulting to ARCO ERA5 dataset on Google Cloud.\n2025-11-20 13:04:54 - INFO - Data will be interpolated onto the grid coarsened by factor 2. Remember to set `interp_frc = 1` in your `bulk_frc.opt` ROMS option file.\n"},"children":[],"key":"TQipo47itS"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"CPU times: user 3min 12s, sys: 7.63 s, total: 3min 20s\nWall time: 2min 55s\n"},"children":[],"key":"mD81hNgm4L"}],"key":"zyHqd85SAE"}],"key":"pewJ1GZ4TN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"surface_forcing.plot(\"uwnd\", time=0)","key":"m2q5YvziqC"},{"type":"outputs","id":"xWM7iVT5G7DULZW2sQJFX","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[########################################] | 100% Completed | 404.59 ms\n"},"children":[],"key":"WCfaslzVHi"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"025e12a8a74008ff9b28c342188dc190","path":"/025e12a8a74008ff9b28c342188dc190.png"},"text/plain":{"content":"<Figure size 1300x700 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"qZzvTzytdK"}],"key":"wY3vmgQuKn"}],"key":"Bt3jpVpUqS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#cesm_bgc_path = \"/global/cfs/projectdirs/m4746/Datasets/CESM_REGRIDDED/CESM-surface_lowres_regridded.nc\"\nunified_bgc_path = datasets+\"UNIFIED/BGCdataset.nc\"","key":"wurbAhXmmJ"},{"type":"outputs","id":"RUHeZeIWIAbrEg_IRRi39","children":[],"key":"SQ06nSkj1I"}],"key":"HGGhnoNUXU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n\nunified_bgc_surface_forcing = SurfaceForcing(\n    grid=grid,\n    start_time=start_time,\n    end_time=end_time,\n    source={\"name\": \"UNIFIED\", \"path\": unified_bgc_path, \"climatology\": True},\n    type=\"bgc\",\n    use_dask=True,\n)","key":"apmJyIMnok"},{"type":"outputs","id":"zrJN2kI-8q4MflgPhSNIU","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-20 13:06:02 - INFO - Data will be interpolated onto the grid coarsened by factor 2. Remember to set `interp_frc = 1` in your `bgc.opt` ROMS option file.\n"},"children":[],"key":"EIfTdfIHL6"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"CPU times: user 138 ms, sys: 10.9 ms, total: 149 ms\nWall time: 500 ms\n"},"children":[],"key":"sfD346CTL3"}],"key":"eCs8WIyDwx"}],"key":"CMDggs6dm6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"filepath = project+model_name+\"_surface_forcing2024.nc\"","key":"ONspiE8e9M"},{"type":"outputs","id":"Dla-PDrl5PoQoW1M2dsIC","children":[],"key":"v1YkNr0ua8"}],"key":"uhuvUTIQY5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"filepath1 = project+model_name+\"_surface_forcing2024.nc\"","key":"bSGyJNM8UZ"},{"type":"outputs","id":"SWhNvz4KoQ-WsLMlzqvvf","children":[],"key":"JdhSXPxUQo"}],"key":"XzrtIlvkHj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%time surface_forcing.save(filepath)","key":"sUJDNhvVW7"},{"type":"outputs","id":"74e3TbyRFFKfF8X7o794z","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-20 13:06:04 - INFO - Writing the following NetCDF files:\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202401.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202402.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202403.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202404.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202405.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202406.nc\n"},"children":[],"key":"RZAjqDpUfB"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[########################################] | 100% Completed | 162.15 s\n[########################################] | 100% Completed | 145.96 s\n[########################################] | 100% Completed | 170.19 s\n[########################################] | 100% Completed | 192.96 s\n[########################################] | 100% Completed | 192.20 s\n[########################################] | 100% Completed | 517.91 ms\nCPU times: user 6h 3min 30s, sys: 2min 28s, total: 6h 5min 59s\nWall time: 15min 40s\n"},"children":[],"key":"HApJ89gD1d"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":30,"metadata":{},"data":{"text/plain":{"content":"[PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202401.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202402.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202403.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202404.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202405.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202406.nc')]","content_type":"text/plain"}}},"children":[],"key":"rHYXPVMVJx"}],"key":"r2rGymBlZF"}],"key":"SCS6xDhwq6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%time surface_forcing1.save(filepath1)","key":"hbLlLK8aAQ"},{"type":"outputs","id":"cyowMHN3xcsstxUJpeasi","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-20 13:21:45 - INFO - Writing the following NetCDF files:\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202406.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202407.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202408.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202409.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202410.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202411.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202412.nc\n"},"children":[],"key":"xmIl0IQzAA"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[########################################] | 100% Completed | 195.17 s\n[########################################] | 100% Completed | 199.92 s\n[########################################] | 100% Completed | 214.15 s\n[########################################] | 100% Completed | 203.79 s\n[########################################] | 100% Completed | 160.58 s\n[########################################] | 100% Completed | 156.47 s\n[########################################] | 100% Completed | 408.13 ms\nCPU times: user 7h 39min 27s, sys: 3min 3s, total: 7h 42min 31s\nWall time: 20min 21s\n"},"children":[],"key":"S6ZXNZbYgp"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/plain":{"content":"[PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202406.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202407.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202408.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202409.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202410.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202411.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_surface_forcing2024_202412.nc')]","content_type":"text/plain"}}},"children":[],"key":"xSty0UklHB"}],"key":"Hn30mdrnZ0"}],"key":"uCxBNg8ynS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"filepath = project+model_name+\"_bgc_surface_forcing.nc\"","key":"rKIScZm74D"},{"type":"outputs","id":"U_Iy095ijSwnj4C9iiMhq","children":[],"key":"kIZaGO5uQC"}],"key":"UlDKDcay7z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%time unified_bgc_surface_forcing.save(filepath)","key":"GVpzSagfzo"},{"type":"outputs","id":"vR8tYqc5P0mC2iRqiGBZC","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-20 13:42:04 - INFO - Writing the following NetCDF files:\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_bgc_surface_forcing_clim.nc\n"},"children":[],"key":"xPcUXMnjD8"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[########################################] | 100% Completed | 302.94 ms\nCPU times: user 211 ms, sys: 11.9 ms, total: 223 ms\nWall time: 840 ms\n"},"children":[],"key":"qZ5MlV9xlz"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"text/plain":{"content":"[PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_bgc_surface_forcing_clim.nc')]","content_type":"text/plain"}}},"children":[],"key":"Geef6SjoHr"}],"key":"NhghcUwiAB"}],"key":"TUFa2HRrRp"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Next we generate the initial file","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PUb2ijmyqT"}],"key":"PsZGn6SL1e"}],"key":"NtYz9EHd4R"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from roms_tools import Grid, InitialConditions","key":"y4fOjdsWGX"},{"type":"outputs","id":"NnaDt1ll4XQ-ysmUxPZxf","children":[],"key":"TQfHEGL6sv"}],"key":"n8ZxmxxYQD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from datetime import datetime","key":"xWwXGPY35n"},{"type":"outputs","id":"hotlmWbRlIatLC3S1e6sY","children":[],"key":"M9WZ2tnmhC"}],"key":"LMRcqtnSpC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ini_time = datetime(2024, 1, 5)","key":"rPxRUveSxn"},{"type":"outputs","id":"4AejPnV8NkB0SoKADvVtR","children":[],"key":"ljKNcdJmWW"}],"key":"JmmzQ3a1Kr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"path = datasets+\"GLORYS/ICELAND_DOMAIN/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-05_no_depth_zos.nc\"","key":"t4oNqQw6n3"},{"type":"outputs","id":"-X7iqS_pgabaj7RcjDr6O","children":[],"key":"DaaPMtXkkU"}],"key":"uyZoBcyCrd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n\ninitial_conditions_with_unified_bgc = InitialConditions(\n    grid=grid,\n    ini_time=ini_time,\n    source={\"name\": \"GLORYS\", \"path\": path},\n    bgc_source={\n        \"name\": \"UNIFIED\",\n        \"path\": unified_bgc_path,\n        \"climatology\": True,\n    },  # bgc_source is optional\n    model_reference_date=datetime(2000, 1, 1), # this is the default\n    use_dask=True,\n)","key":"pV1h9BhCQr"},{"type":"outputs","id":"Wmg7VnlRSnDdjTnz6-_zE","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-20 13:42:05 - INFO - Sea surface height will NOT be used to adjust depth coordinates.\n"},"children":[],"key":"IewhAdF1ri"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"CPU times: user 1min 20s, sys: 31.7 s, total: 1min 52s\nWall time: 10.9 s\n"},"children":[],"key":"gqNssGLlBV"}],"key":"VAJEowoFMB"}],"key":"KDJXk5qbMD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"filepath = project+model_name+\"_initial_conditions_60m.nc\"","key":"OBNzKLyK5B"},{"type":"outputs","id":"nG0bQ3cG-0BCJLheNIU0Q","children":[],"key":"zMJ22mtzCe"}],"key":"PAWwE8C4Vl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%time initial_conditions_with_unified_bgc.save(filepath)","key":"lACnfHd9hH"},{"type":"outputs","id":"7MU47G65FjBtcujSBL9IU","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-20 13:42:16 - INFO - Writing the following NetCDF files:\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_initial_conditions_60m.nc\n"},"children":[],"key":"mEyCoD8Rs6"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[########################################] | 100% Completed | 131.41 s\nCPU times: user 25min 33s, sys: 5min 44s, total: 31min 17s\nWall time: 2min 13s\n"},"children":[],"key":"jeUdA13R0x"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"text/plain":{"content":"[PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_initial_conditions_60m.nc')]","content_type":"text/plain"}}},"children":[],"key":"PxSyaPeZDp"}],"key":"mqnuoFHgiJ"}],"key":"HvoyNhJh0N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"glorys_path = [\n    datasets+\"/GLORYS/ICELAND_DOMAIN/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-*_no_depth_zos.nc\"]","key":"RfPLFMRWX3"},{"type":"outputs","id":"ci_0KREqO02FqAFeFZQEQ","children":[],"key":"i37J5K2OvG"}],"key":"DCAxkpKUn2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#glorys_path = [\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-04_no_depth_zos.nc\",  # include data from day before start time\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-05_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-06_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-07_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-08_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-09_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-10_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-11_no_depth_zos.nc\",  # include data from day after end time\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-12_no_depth_zos.nc\", \n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-13_no_depth_zos.nc\", \n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-14_no_depth_zos.nc\",  # include data from day before start time\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-15_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-16_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-17_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-18_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-19_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-20_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-21_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-22_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-23_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-24_no_depth_zos.nc\",  # include data from day before start time\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-25_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-26_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-27_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-28_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-29_no_depth_zos.nc\",\n#    \"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-30_no_depth_zos.nc\",\n#    #\"/global/cfs/cdirs/m4632/uheede/GLORYS/2024/cmems_mod_glo_phy_myint_0.083deg_P1D-m_multi-vars_52.50W-2.67E_44.33N-74.42N_1.54-3992.48m_2024-01-31_no_depth_zos.nc\"\n#]","key":"Li2Aefgvum"},{"type":"outputs","id":"PKNPc2gpZSIiNbjpi757n","children":[],"key":"Yrbzca8DUF"}],"key":"RzhlJS49le"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from roms_tools import Grid, BoundaryForcing","key":"eDmF9CNEgz"},{"type":"outputs","id":"p7qmoNZbAZvp77TVf_7Bd","children":[],"key":"sltLwptjbe"}],"key":"f8hr7ZwZ0y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"start_time = datetime(2024, 1, 1)\nend_time = datetime(2024, 6, 30)","key":"IUM2a5xCCA"},{"type":"outputs","id":"ieNyBTWeeIMEkZQyRaPU7","children":[],"key":"YpexvQxUZV"}],"key":"wbBkdmUH7Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"start_time1 = datetime(2024, 6, 1)\nend_time1 = datetime(2024, 12, 30)","key":"wfdBrZDhED"},{"type":"outputs","id":"Zy1eIzg61iUZ5-pxPXmgG","children":[],"key":"azuIr5GbXx"}],"key":"oA3iUyycup"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n\nboundary_forcing = BoundaryForcing(\n    grid=grid,\n    start_time=start_time,\n    end_time=end_time,\n    boundaries={\n        \"south\": True,\n        \"east\": True,\n        \"north\": True,  \n        \"west\": True,\n    },\n    source={\"name\": \"GLORYS\", \"path\": glorys_path},\n    type=\"physics\",  # \"physics\" or \"bgc\"; default is \"physics\"\n    model_reference_date=datetime(2000, 1, 1), # this is the default\n    use_dask=True,\n)","key":"P9P4BYcHez"},{"type":"outputs","id":"oiI5fHatxwymZ247Vkvzx","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-20 13:44:29 - INFO - Sea surface height will NOT be used to adjust depth coordinates.\n"},"children":[],"key":"tqbyzYFoAG"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"CPU times: user 9.49 s, sys: 2.57 s, total: 12.1 s\nWall time: 4min 50s\n"},"children":[],"key":"zDCyPcf8xy"}],"key":"neBbAzcwqH"}],"key":"ZrjwscuqDn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n\nboundary_forcing1 = BoundaryForcing(\n    grid=grid,\n    start_time=start_time1,\n    end_time=end_time1,\n    boundaries={\n        \"south\": True,\n        \"east\": True,\n        \"north\": True,  \n        \"west\": True,\n    },\n    source={\"name\": \"GLORYS\", \"path\": glorys_path},\n    type=\"physics\",  # \"physics\" or \"bgc\"; default is \"physics\"\n    model_reference_date=datetime(2000, 1, 1), # this is the default\n    use_dask=True,\n)","key":"cPZvjnFZoC"},{"type":"outputs","id":"VJkIq4ph4esoT_LcRrdaU","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-20 13:49:20 - INFO - Sea surface height will NOT be used to adjust depth coordinates.\n2025-11-20 13:54:39 - WARNING - No records found at or after the end_time: 2024-12-30 00:00:00.\n"},"children":[],"key":"sWmE4SQ8ub"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"CPU times: user 12 s, sys: 2.63 s, total: 14.6 s\nWall time: 5min 25s\n"},"children":[],"key":"dVl9ftxmiE"}],"key":"klk0BMmQ1l"}],"key":"vuPIiifxdM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n\nunified_bgc_boundary_forcing = BoundaryForcing(\n    grid=grid,\n    start_time=start_time,\n    end_time=end_time,\n    boundaries={\n        \"south\": True,\n        \"east\": True,\n        \"north\": True,  \n        \"west\": True,\n    },\n    source={\"name\": \"UNIFIED\", \"path\": unified_bgc_path, \"climatology\": True},\n    type=\"bgc\",\n    use_dask=True,\n)","key":"R1Xp8orRKa"},{"type":"outputs","id":"TSPA244KgM7y3kcUm3NDC","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-20 13:54:46 - INFO - Sea surface height will NOT be used to adjust depth coordinates.\n"},"children":[],"key":"HWcNOiHOeB"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"CPU times: user 5.44 s, sys: 69.7 ms, total: 5.51 s\nWall time: 6.4 s\n"},"children":[],"key":"BL1dN77ba9"}],"key":"yiTjqHfqoC"}],"key":"RN7Uvrj8qC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"filepath = project+model_name+\"_bgc_boundary_forcing_2024.nc\"\n%time unified_bgc_boundary_forcing.save(filepath)\n","key":"J7lyWyvmBe"},{"type":"outputs","id":"qPN5WDlFuGaypvNk_03B0","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-20 13:54:52 - INFO - Writing the following NetCDF files:\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_bgc_boundary_forcing_2024_clim.nc\n"},"children":[],"key":"WHjIJTtlo7"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[########################################] | 100% Completed | 98.60 s\nCPU times: user 1min 4s, sys: 13.9 s, total: 1min 18s\nWall time: 1min 40s\n"},"children":[],"key":"xrqSaOd0LR"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":49,"metadata":{},"data":{"text/plain":{"content":"[PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_bgc_boundary_forcing_2024_clim.nc')]","content_type":"text/plain"}}},"children":[],"key":"ipPuFkNPBX"}],"key":"fTBeNnFs2e"}],"key":"H1MKQRHrH7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"filepath = project+model_name+\"_boundary_forcing_2024.nc\"\n%time boundary_forcing.save(filepath, group=True)","key":"IAV5MRevXi"},{"type":"outputs","id":"bsZ2TL1pZRuAUqti8e3mC","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-20 13:56:33 - INFO - Writing the following NetCDF files:\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202401.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202402.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202403.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202404.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202405.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202406.nc\n"},"children":[],"key":"EinJTMhL2s"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[########################################] | 100% Completed | 48.10 s\n[########################################] | 100% Completed | 37.60 s\n[########################################] | 100% Completed | 37.16 s\n[########################################] | 100% Completed | 16.34 s\n[########################################] | 100% Completed | 20.15 s\n[########################################] | 100% Completed | 39.81 s\nCPU times: user 1min 57s, sys: 16.3 s, total: 2min 13s\nWall time: 3min 28s\n"},"children":[],"key":"Zxp95nxmKM"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":50,"metadata":{},"data":{"text/plain":{"content":"[PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202401.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202402.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202403.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202404.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202405.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202406.nc')]","content_type":"text/plain"}}},"children":[],"key":"W60AWqmDaz"}],"key":"cnrM6dbUlK"}],"key":"Nq9w7hBuZv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"filepath = project+model_name+\"_boundary_forcing_2024.nc\"\n%time boundary_forcing1.save(filepath, group=True)","key":"WZerTlxQdC"},{"type":"outputs","id":"2KnS_h8QKClYcapU_D2Jr","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-20 14:00:01 - INFO - Writing the following NetCDF files:\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202406.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202407.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202408.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202409.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202410.nc\n/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202411.nc\n"},"children":[],"key":"fkV5XgXE8i"},{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"[########################################] | 100% Completed | 7.96 ss\n[########################################] | 100% Completed | 40.85 s\n[########################################] | 100% Completed | 37.37 s\n[########################################] | 100% Completed | 37.26 s\n[########################################] | 100% Completed | 40.04 s\n[########################################] | 100% Completed | 41.67 s\nCPU times: user 2min 2s, sys: 15.8 s, total: 2min 18s\nWall time: 3min 33s\n"},"children":[],"key":"KYe4aUa9RK"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"text/plain":{"content":"[PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202406.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202407.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202408.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202409.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202410.nc'),\n PosixPath('/anvil/projects/x-ees250129/x-uheede/INPUT_files/Iceland0_MARBL_2024/Iceland0_boundary_forcing_2024_202411.nc')]","content_type":"text/plain"}}},"children":[],"key":"qufEITgZLg"}],"key":"SfJPv5FVfl"}],"key":"MltduG4FfZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"SAHYLH4g2S"},{"type":"outputs","id":"s98fptGue77JS7ZVbNTxV","children":[],"key":"BH0Cw9q6mW"}],"key":"Wt6AxJaB9F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from roms_tools import Grid, ChildGrid","key":"T5jGU4gR4R"},{"type":"outputs","id":"2_BXTQMvU6jFrhg8qI40q","children":[],"key":"y0eC7qTBZc"}],"key":"o1u501OKV8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"parent_grid = grid","key":"ummT0BXirX"},{"type":"outputs","id":"nT4NeZyH6n_in6MOEsB4J","children":[],"key":"SN767L26Xl"}],"key":"l8lhMhinPC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"child_grid_parameters = {\n    \"nx\": 512,\n    \"ny\": 512,\n    \"size_x\": 384,\n    \"size_y\": 384,\n    \"center_lon\": -24,\n    \"center_lat\": 64.9,\n    \"rot\": 0,\n    \"topography_source\": {\n        \"name\": \"SRTM15\",\n        \"path\": datasets+\"SRTM15/SRTM15_V2.6.nc\"},\n    \"N\":60  # number of vertical layers\n}","key":"PJxosdu28O"},{"type":"outputs","id":"Zpp7m3fP3WPAoXGJXoWhd","children":[],"key":"OwKTjcOWpM"}],"key":"HCVvH7N5BM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"child_grid = ChildGrid(\n    **child_grid_parameters,\n    parent_grid=parent_grid,\n    boundaries={\n        \"south\": True,\n        \"east\": True,\n        \"north\": True,\n        \"west\": True,\n    },  # this is the default\n    metadata={\"prefix\": \"child\", \"period\": 1800.0}  # this is the default\n)","key":"zjrt4BkeGE"},{"type":"outputs","id":"Tf6Zs5iXBvibdZGGILSH1","children":[{"type":"output","jupyter_data":{"ename":"KeyboardInterrupt","evalue":"","output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mKeyboardInterrupt\u001b[39m                         Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[55]\u001b[39m\u001b[32m, line 1\u001b[39m\n\u001b[32m----> \u001b[39m\u001b[32m1\u001b[39m child_grid = \u001b[43mChildGrid\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m      2\u001b[39m \u001b[43m    \u001b[49m\u001b[43m*\u001b[49m\u001b[43m*\u001b[49m\u001b[43mchild_grid_parameters\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m      3\u001b[39m \u001b[43m    \u001b[49m\u001b[43mparent_grid\u001b[49m\u001b[43m=\u001b[49m\u001b[43mparent_grid\u001b[49m\u001b[43m,\u001b[49m\n\u001b[32m      4\u001b[39m \u001b[43m    \u001b[49m\u001b[43mboundaries\u001b[49m\u001b[43m=\u001b[49m\u001b[43m{\u001b[49m\n\u001b[32m      5\u001b[39m \u001b[43m        \u001b[49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43msouth\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m:\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mTrue\u001b[39;49;00m\u001b[43m,\u001b[49m\n\u001b[32m      6\u001b[39m \u001b[43m        \u001b[49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43meast\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m:\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mTrue\u001b[39;49;00m\u001b[43m,\u001b[49m\n\u001b[32m      7\u001b[39m \u001b[43m        \u001b[49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43mnorth\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m:\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mTrue\u001b[39;49;00m\u001b[43m,\u001b[49m\n\u001b[32m      8\u001b[39m \u001b[43m        \u001b[49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43mwest\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m:\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43;01mTrue\u001b[39;49;00m\u001b[43m,\u001b[49m\n\u001b[32m      9\u001b[39m \u001b[43m    \u001b[49m\u001b[43m}\u001b[49m\u001b[43m,\u001b[49m\u001b[43m  \u001b[49m\u001b[38;5;66;43;03m# this is the default\u001b[39;49;00m\n\u001b[32m     10\u001b[39m \u001b[43m    \u001b[49m\u001b[43mmetadata\u001b[49m\u001b[43m=\u001b[49m\u001b[43m{\u001b[49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43mprefix\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m:\u001b[49m\u001b[43m \u001b[49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43mchild\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43mperiod\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m:\u001b[49m\u001b[43m \u001b[49m\u001b[32;43m1800.0\u001b[39;49m\u001b[43m}\u001b[49m\u001b[43m  \u001b[49m\u001b[38;5;66;43;03m# this is the default\u001b[39;49;00m\n\u001b[32m     11\u001b[39m \u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m<string>:20\u001b[39m, in \u001b[36m__init__\u001b[39m\u001b[34m(self, nx, ny, size_x, size_y, center_lon, center_lat, rot, N, theta_s, theta_b, hc, topography_source, hmin, verbose, parent_grid, boundaries, metadata)\u001b[39m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/roms-tools/roms_tools/setup/nesting.py:86\u001b[39m, in \u001b[36mChildGrid.__post_init__\u001b[39m\u001b[34m(self)\u001b[39m\n\u001b[32m     84\u001b[39m \u001b[38;5;28msuper\u001b[39m().__post_init__()\n\u001b[32m     85\u001b[39m \u001b[38;5;28mself\u001b[39m._map_child_boundaries_onto_parent_grid_indices(verbose=\u001b[38;5;28mself\u001b[39m.verbose)\n\u001b[32m---> \u001b[39m\u001b[32m86\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43m_modify_child_topography_and_mask\u001b[49m\u001b[43m(\u001b[49m\u001b[43mverbose\u001b[49m\u001b[43m=\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mverbose\u001b[49m\u001b[43m)\u001b[49m\n\n\u001b[36mFile \u001b[39m\u001b[32m~/roms-tools/roms_tools/setup/nesting.py:117\u001b[39m, in \u001b[36mChildGrid._modify_child_topography_and_mask\u001b[39m\u001b[34m(self, verbose)\u001b[39m\n\u001b[32m    114\u001b[39m \u001b[38;5;28;01mwith\u001b[39;00m Timed(\u001b[33m\"\u001b[39m\u001b[33m=== Modifying child topography and mask ===\u001b[39m\u001b[33m\"\u001b[39m, verbose=verbose):\n\u001b[32m    115\u001b[39m     \u001b[38;5;66;03m# Prepare parent and child grid datasets by adjusting longitudes for dateline crossing\u001b[39;00m\n\u001b[32m    116\u001b[39m     parent_grid_ds, child_grid_ds = \u001b[38;5;28mself\u001b[39m._prepare_grid_datasets()\n\u001b[32m--> \u001b[39m\u001b[32m117\u001b[39m     child_grid_ds = \u001b[43mmodify_child_topography_and_mask\u001b[49m\u001b[43m(\u001b[49m\n\u001b[32m    118\u001b[39m \u001b[43m        \u001b[49m\u001b[43mparent_grid_ds\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mchild_grid_ds\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mboundaries\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m.\u001b[49m\u001b[43mhmin\u001b[49m\n\u001b[32m    119\u001b[39m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    121\u001b[39m     \u001b[38;5;66;03m# Finalize grid datasets by adjusting longitudes back to [0, 360] range\u001b[39;00m\n\u001b[32m    122\u001b[39m     parent_grid_ds, child_grid_ds = \u001b[38;5;28mself\u001b[39m._finalize_grid_datasets(\n\u001b[32m    123\u001b[39m         parent_grid_ds, child_grid_ds\n\u001b[32m    124\u001b[39m     )\n\n\u001b[36mFile \u001b[39m\u001b[32m~/roms-tools/roms_tools/setup/nesting.py:653\u001b[39m, in \u001b[36mmodify_child_topography_and_mask\u001b[39m\u001b[34m(parent_grid_ds, child_grid_ds, boundaries, hmin)\u001b[39m\n\u001b[32m    650\u001b[39m xi = (child_grid_ds.lon_rho.values, child_grid_ds.lat_rho.values)\n\u001b[32m    652\u001b[39m values = parent_grid_ds[\u001b[33m\"\u001b[39m\u001b[33mh\u001b[39m\u001b[33m\"\u001b[39m].values.ravel()\n\u001b[32m--> \u001b[39m\u001b[32m653\u001b[39m h_parent_interpolated = \u001b[43mgriddata\u001b[49m\u001b[43m(\u001b[49m\u001b[43mpoints\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mvalues\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mxi\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mmethod\u001b[49m\u001b[43m=\u001b[49m\u001b[33;43m\"\u001b[39;49m\u001b[33;43mlinear\u001b[39;49m\u001b[33;43m\"\u001b[39;49m\u001b[43m)\u001b[49m\n\u001b[32m    654\u001b[39m h_parent_interpolated = xr.DataArray(\n\u001b[32m    655\u001b[39m     h_parent_interpolated, dims=(\u001b[33m\"\u001b[39m\u001b[33meta_rho\u001b[39m\u001b[33m\"\u001b[39m, \u001b[33m\"\u001b[39m\u001b[33mxi_rho\u001b[39m\u001b[33m\"\u001b[39m)\n\u001b[32m    656\u001b[39m )\n\u001b[32m    658\u001b[39m values = parent_grid_ds[\u001b[33m\"\u001b[39m\u001b[33mmask_rho\u001b[39m\u001b[33m\"\u001b[39m].values.ravel()\n\n\u001b[36mFile \u001b[39m\u001b[32m~/.conda/envs/2024.02-py311/romstools-test/lib/python3.13/site-packages/scipy/interpolate/_ndgriddata.py:321\u001b[39m, in \u001b[36mgriddata\u001b[39m\u001b[34m(points, values, xi, method, fill_value, rescale)\u001b[39m\n\u001b[32m    318\u001b[39m \u001b[38;5;28;01melif\u001b[39;00m method == \u001b[33m'\u001b[39m\u001b[33mlinear\u001b[39m\u001b[33m'\u001b[39m:\n\u001b[32m    319\u001b[39m     ip = LinearNDInterpolator(points, values, fill_value=fill_value,\n\u001b[32m    320\u001b[39m                               rescale=rescale)\n\u001b[32m--> \u001b[39m\u001b[32m321\u001b[39m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mip\u001b[49m\u001b[43m(\u001b[49m\u001b[43mxi\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m    322\u001b[39m \u001b[38;5;28;01melif\u001b[39;00m method == \u001b[33m'\u001b[39m\u001b[33mcubic\u001b[39m\u001b[33m'\u001b[39m \u001b[38;5;129;01mand\u001b[39;00m ndim == \u001b[32m2\u001b[39m:\n\u001b[32m    323\u001b[39m     ip = CloughTocher2DInterpolator(points, values, fill_value=fill_value,\n\u001b[32m    324\u001b[39m                                     rescale=rescale)\n\n\u001b[31mKeyboardInterrupt\u001b[39m: "},"children":[],"key":"Sc2sYcVc05"}],"key":"CQB4eOqDz2"}],"key":"AFJc0NCeQB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"child_grid.plot_nesting(with_dim_names=True)","key":"ZmtXzb8DOA"},{"type":"outputs","id":"J508DKhSacElvEr1M2bia","children":[],"key":"njI2PFQzGC"}],"key":"FIcSJ0hFIm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"filepath = project+child_name+\"_grid.nc\"\nchild_grid.save(filepath=filepath)","key":"y3kTdl9fXC"},{"type":"outputs","id":"yTPMWceeLOLz6Jhf0A3G2","children":[],"key":"TIubXQKwda"}],"key":"yZHzukRX5w"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"filepath_nesting = project+child_name+\"_edata.nc\"","key":"qTMGw3USBm"},{"type":"outputs","id":"Rrc7BWE4qoKIvy-igtnGK","children":[],"key":"IwaTvJYsX7"}],"key":"bFJrqfIrFD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"child_grid.save_nesting(filepath=filepath_nesting)","key":"g1Punt50aR"},{"type":"outputs","id":"256mDFJ8pGojIKSHT26fy","children":[],"key":"FrBsD3bx86"}],"key":"xDcDHpxs6l"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from roms_tools import partition_netcdf","key":"L1nrAOuYZ5"},{"type":"outputs","id":"NsYHe_32DT9hpRJnuHStf","children":[],"key":"PRjxbZYJD1"}],"key":"D9XhQ7YbYN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%time partition_netcdf(project+model_name+'_grid.nc', np_eta=16, np_xi=16, output_dir='/home/x-uheede/S/Iceland0_MARBL_2024/P_INPUT')","key":"AeqCXhrbDW"},{"type":"outputs","id":"13NDUsQSAPTjro3aAiNAP","children":[],"key":"A5m5KsTIDN"}],"key":"iKqA8scWos"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%time partition_netcdf(project+model_name+'_tides.nc', np_eta=16, np_xi=16, output_dir='/home/x-uheede/S/Iceland0_MARBL_2024/P_INPUT')","key":"vX2x8pr7zs"},{"type":"outputs","id":"S1OPrWy5OBx6WxFRCm5b1","children":[],"key":"bKas3L2r7s"}],"key":"QHBheBj27g"}],"key":"RSIf12hSYB"},"references":{"cite":{"order":[],"data":{}}}}