{"version":3,"kind":"Notebook","sha256":"f7dbbbe5da3fed7b1252a70e78a5c790ec5be1c91e67f527455f02abca99aa3c","slug":"regrid-atmfrc-cerra","location":"/regrid_atmfrc_cerra.ipynb","dependencies":[],"frontmatter":{"kernelspec":{"name":"env","display_name":"ROMS_output","language":"python"},"exports":[{"format":"ipynb","filename":"regrid_atmfrc_cerra.ipynb","url":"/regrid_atmfrc_cerra-c5f4f1b9a61af9f5241cadac5d928270.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import subprocess\nimport os\n#import netcdf4\nimport netCDF4\nimport numpy as np\n#import glob\n#import time\nimport matplotlib.pyplot as plt\n#import copy\nimport xarray as xr\n#from datetime import datetime, timedelta \n#from ocean_c_lab_tools import *\n#from celluloid import Camera \n#import PyCO2SYS as csys\n#import seawater as sw\nimport xesmf as xe","visibility":"show","key":"AkxDgHeVpD"},{"type":"outputs","id":"1hX_ttXT5EtukupQkHTQb","children":[],"visibility":"show","key":"GUcCKUfXoC"}],"visibility":"show","key":"oXLa1vjOMi"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"month=7\n\n#x=xr.open_dataset('/global/cfs/cdirs/m4632/uheede/Cerra/cerra_2020_leadtime1_202002.nc',decode_times=False)\nx=xr.open_dataset('/global/cfs/cdirs/m4632/uheede/Cerra/cerra_2020_leadtime1_ex_2020'+str(month)+'.nc',decode_times=False)\nr2=x['r2']\nt2m=x['t2m']\nx=xr.open_dataset('/global/cfs/cdirs/m4632/uheede/Cerra/cerra_2020_leadtime1_20200'+str(month)+'.nc',decode_times=False)\nskt=x['skt']\nssr=x['ssr']\nstrd=x['strd']\ntp=x['tp']\n\nws=x['si10']\nwd=x['wdir10']\n\nu10=ws*np.cos(np.deg2rad(wd))\nv10=ws*np.sin(np.deg2rad(wd))","visibility":"show","key":"TuM8WAxk9V"},{"type":"outputs","id":"aBayHsQI2v5jUoH2BMFKV","children":[],"visibility":"show","key":"hMWuUQKBwx"}],"visibility":"show","key":"giDHvSnPHm"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plt.contour(x.longitude.load())","visibility":"show","key":"qoNthMR5GI"},{"type":"outputs","id":"bltAcJ-aQugZOgFaYkgEK","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ed1d2de4e737b61473eb83e9ad65ace5","path":"/ed1d2de4e737b61473eb83e9ad65ace5.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"Bb7skVBuDy"}],"visibility":"show","key":"L3Ze4uHlEd"}],"visibility":"show","key":"AprpMAOjiF"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"#lon_min=(310)\nlon_min=(x.longitude.min().values)\n#lon_max=(x.longitude.max().values)\nlon_max=(0)\nlon_step=((lon_max-lon_min)/len(x.x))\n\nlat_min=(x.latitude.min().values)\nlat_max=(x.latitude.max().values)\nlat_step=((lat_max-lat_min)/len(x.y))","visibility":"show","key":"kOhyvXoztc"},{"type":"outputs","id":"ijlFZ5oYX4Ya8al9-Mesz","children":[],"visibility":"show","key":"sGLUxPV1fk"}],"visibility":"show","key":"pp7RRaWBWH"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_out = xr.Dataset(\n    {\n        \"lon\": ([\"lon\"], np.arange(lon_min, lon_max, lon_step), {\"units\": \"degrees_north\"}),\n        \"lat\": ([\"lat\"], np.arange(lat_min, lat_max, lat_step), {\"units\": \"degrees_east\"}),\n    }\n)","visibility":"show","key":"s69wMk0hf7"},{"type":"outputs","id":"Fjv5-tshVNivaz0O6BLNl","children":[],"visibility":"show","key":"xULnip1VW0"}],"visibility":"show","key":"LeiEoIgxxb"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"regridder = xe.Regridder(x, ds_out, \"bilinear\")\nr2_regrid=regridder(r2)\nskt_regrid=regridder(skt)\n\nssr_regrid=regridder(ssr)\nstrd_regrid=regridder(strd)\nt2m_regrid=regridder(t2m)\ntp_regrid=regridder(tp)\nu10_regrid=regridder(u10)\nv10_regrid=regridder(v10)","visibility":"show","key":"ee7LmipP9X"},{"type":"outputs","id":"x2uFl3h3toAzAgdiT-RP9","children":[],"visibility":"show","key":"a4Btc8Yf8m"}],"visibility":"show","key":"yWuTwqfCbT"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"r2_regrid.attrs['long name'] = '2 metre relative humidity'\nr2_regrid=r2_regrid.reset_coords(names=\"heightAboveGround\",drop=True)\n\nskt_regrid.attrs['long name'] = 'Skin temperature'\nskt_regrid=skt_regrid.reset_coords(names=\"heightAboveGround\",drop=True)\n\nssr_regrid.attrs['long name'] = 'Surface net short-wave (solar) radiation'\nssr_regrid=ssr_regrid.reset_coords(names=\"heightAboveGround\",drop=True)\n\nstrd_regrid.attrs['long name'] = 'Surface long-wave (thermal) radiation downwards'\nstrd_regrid=strd_regrid.reset_coords(names=\"heightAboveGround\",drop=True)\n\nu10_regrid.attrs['long name'] = '10 metre U wind component'\nu10_regrid=u10_regrid.reset_coords(names=\"heightAboveGround\",drop=True)\n\nv10_regrid.attrs['long name'] = '10 metre V wind component'\nv10_regrid=v10_regrid.reset_coords(names=\"heightAboveGround\",drop=True)\n\nt2m_regrid.attrs['long name'] = '2 metre temperature'\nt2m_regrid=t2m_regrid.reset_coords(names=\"heightAboveGround\",drop=True)\n\ntp_regrid.attrs['long name'] = 'total precipitation'\ntp_regrid=tp_regrid.reset_coords(names=\"heightAboveGround\",drop=True)\n","visibility":"show","key":"wmm2Bn5THE"},{"type":"outputs","id":"4BXuFvnaRZXDkITwFEbGZ","children":[],"visibility":"show","key":"tbFx3vWavS"}],"visibility":"show","key":"Quu6AqN3F7"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"cerra_2020_2 = xr.Dataset({\n    'u10': u10_regrid.squeeze(),\n    'v10': v10_regrid.squeeze(),\n    't2m': t2m_regrid.squeeze(),\n    'r2': r2_regrid.squeeze(),\n    'sst': skt_regrid.squeeze(),\n    'ssr': ssr_regrid.squeeze(),\n    'strd': strd_regrid.squeeze(),\n    'tp': tp_regrid.squeeze(),\n    'time': x['time'],\n    'longitude': u10_regrid.lon,\n    'latitude': u10_regrid.lat,\n    \n})","visibility":"show","key":"dwPFhKv1Sy"},{"type":"outputs","id":"GUI7hjYl-hVkYSA3bglAM","children":[],"visibility":"show","key":"m93C8ZU5In"}],"visibility":"show","key":"xpRJOo3uRb"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"cerra_2020_2.to_netcdf('/global/cfs/cdirs/m4632/uheede/Cerra/regrid/cerra_2020_0'+str(month)+'.nc')","visibility":"show","key":"UAk5JA3YzN"},{"type":"outputs","id":"v5ECGu65rsOang8TUkIlj","children":[],"visibility":"show","key":"cpo4N6D62Y"}],"visibility":"show","key":"qkIvHtVMHh"}],"key":"Agefad4pxh"},"references":{"cite":{"order":[],"data":{}}}}