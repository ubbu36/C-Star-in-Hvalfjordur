{"version":3,"kind":"Notebook","sha256":"8bf860a4fac8333b8dcf7d00c3b7ca6c4b40b2c3802f5771da1b9e4018b52d23","slug":"velocity-analysis-copy1","location":"/velocity_analysis-Copy1.ipynb","dependencies":[],"frontmatter":{"kernelspec":{"name":"xesmf_env","display_name":"xesmf_env","language":"python"},"exports":[{"format":"ipynb","filename":"velocity_analysis-Copy1.ipynb","url":"/velocity_analysis-Co-34c57a08efb3e74fb8d9818d89cf5ce7.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import subprocess\nimport os\nimport pandas as pd\nimport netCDF4\nimport numpy as np\nimport glob\nimport time\nimport matplotlib.pyplot as plt\nimport copy\nimport xarray as xr\nfrom datetime import datetime, timedelta \nimport dask\nfrom scipy.interpolate import griddata\n#from ocean_c_lab_tools import *\n#from celluloid import Camera \n#import PyCO2SYS as csys\nimport seawater as sw\nfrom roms_regrid import *","key":"NTm302eKw8"},{"type":"outputs","id":"5Yd9YZQ5TAj2FRaMn3g0H","children":[],"key":"OeL9g6TCHJ"}],"key":"gh70yVsfwa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"\n\n# Define file paths and station names\nstations = [\"HVIN_1\", \"HVNA_1\", \"HVNV_1\", \"HVSA_1\", \"HVSV_1\"]\nfile_paths = {name: f\"/global/cfs/cdirs/m4632/uheede/Hafro_obsdata/{name}new.nc\" for name in stations}\n\n# Dictionary to store datasets\ndatasets = {}\n\nfor name, path in file_paths.items():\n    ds = xr.open_dataset(path)\n\n    # Select valid depth bins\n    good_bins = ds['iigood'].where(ds['iigood'] < 20).to_numpy()\n    good_bins_nn = good_bins[~np.isnan(good_bins)].astype(int)\n    \n    ds = ds.isel(depth_dim=slice(np.min(good_bins_nn), np.max(good_bins_nn)))\n\n    # Store dataset with adjusted longitude\n    datasets[name] = ds.assign_coords(lon=ds['lon'].load() + 360)\n\n","key":"wf4E3pXQHw"},{"type":"outputs","id":"BGUKGaq8ZnDzS4CRc2VWX","children":[],"key":"CCzGNBvHOD"}],"key":"TkdzhaaLWH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"\n\nsubtract = 739674 - 9189  # Computed constant\nreference_date = pd.to_datetime(\"2000-01-01\")  # Reference date\n\n# Apply transformation to all datasets\nfor name, ds in datasets.items():\n    datetime_series = reference_date + pd.to_timedelta((ds['time'].values - subtract), unit='D')\n    datasets[name] = ds.assign_coords(time_dim=datetime_series)  # Update the time coordinate\n","key":"eosmGWhw8u"},{"type":"outputs","id":"F19IhIgEHrlraU-VEOswU","children":[],"key":"gvx6e0Nkif"}],"key":"ghYTqCtXb6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#model=xr.open_mfdataset('/pscratch/sd/u/uheede/Iceland3_phys_hour/z_Iceland3_MARBL_his.202305????????.nc', combine='nested', concat_dim=[\"time\"])\n#model=xr.open_mfdataset('/global/cfs/cdirs/m4746/Users/ulla/Iceland4_multidye_np4/z_Iceland4_linedye_rnd.201206*.nc', combine='nested', concat_dim=[\"time\"])\nmodel=xr.open_mfdataset('/pscratch/sd/u/uheede/Iceland4_noMARBL/z_Iceland4_riv_rnd.2023??????????.nc', combine='nested', concat_dim=[\"time\"])","key":"SCn2GMnkiO"},{"type":"outputs","id":"wtK6fi3Yarl6t4MXvExIf","children":[],"key":"cbf2KN0PGj"}],"key":"LrVJHKlpzO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"grid=xr.open_mfdataset('/global/cfs/cdirs/m4632/uheede/work/Iceland4_MARBL/INPUT/Iceland4_grd.nc')\n#grid=xr.open_dataset('/global/cfs/cdirs/m4632/uheede/work/Iceland4_BGC/INPUT/Iceland4_grd.nc')","key":"umDKRnGDUl"},{"type":"outputs","id":"QO1E_M6ASFAXr_hF3gXSL","children":[],"key":"OjVWU2vxii"}],"key":"CMQQ3bKLu4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"u_sub=model['u'].sel(depth=-10)\nv_sub=model['v'].sel(depth=-10)","key":"jvdLpLrB1g"},{"type":"outputs","id":"9lOzpp1k5Yc6S8hYV7d4m","children":[],"key":"pHRyWjwuYl"}],"key":"i8CvhnuX4Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"u_rg=roms_regrid_u(grid,u_sub)\nv_rg=roms_regrid_v(grid,v_sub)","key":"LTOdCqVraJ"},{"type":"outputs","id":"y9vZ6mc8HOFPn0Oc4unq2","children":[],"key":"qn7vymtgim"}],"key":"k6dAHE4VTI"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"u_rg.load()\nv_rg.load()","key":"JHD2JGGFMK"},{"type":"outputs","id":"OkooeZ4wiliv-CoylYawz","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=dark],\nhtml[data-theme=dark],\nbody[data-theme=dark],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1F1F1F;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: '►';\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: '▼';\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: '(';\n}\n\n.xr-dim-list:after {\n  content: ')';\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: ',';\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (time: 751, lat: 1442, lon: 721)&gt; Size: 3GB\narray([[[ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        ...,\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.]],\n\n       [[ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        ...,\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.]],\n\n       [[ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        ...,\n...\n        ...,\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.]],\n\n       [[ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        ...,\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.]],\n\n       [[ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        ...,\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.]]], dtype=float32)\nCoordinates:\n    depth    float32 4B -10.0\n  * lon      (lon) float64 6kB 337.7 337.7 337.7 337.7 ... 338.7 338.7 338.7\n  * lat      (lat) float64 12kB 64.22 64.22 64.22 64.22 ... 64.42 64.42 64.42\nDimensions without coordinates: time\nAttributes:\n    regrid_method:  bilinear</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span>time</span>: 751</li><li><span class='xr-has-index'>lat</span>: 1442</li><li><span class='xr-has-index'>lon</span>: 721</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-08e8da5d-fba3-4983-9ceb-46a486ef43bc' class='xr-array-in' type='checkbox' checked><label for='section-08e8da5d-fba3-4983-9ceb-46a486ef43bc' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0</span></div><div class='xr-array-data'><pre>array([[[ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        ...,\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.]],\n\n       [[ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        ...,\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.]],\n\n       [[ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        ...,\n...\n        ...,\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.]],\n\n       [[ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        ...,\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.]],\n\n       [[ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        ...,\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-f537b02c-c6c7-455e-aaa5-cd303956f521' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f537b02c-c6c7-455e-aaa5-cd303956f521' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>depth</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-10.0</div><input id='attrs-6e6a5481-41ad-4f9a-b1a8-5c5ee1adb5ee' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6e6a5481-41ad-4f9a-b1a8-5c5ee1adb5ee' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-53bdcafc-3570-41b8-ad20-23b00b4176ef' class='xr-var-data-in' type='checkbox'><label for='data-53bdcafc-3570-41b8-ad20-23b00b4176ef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(-10., dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>337.7 337.7 337.7 ... 338.7 338.7</div><input id='attrs-4e7c943c-2ef9-401d-be53-c36a56e020ef' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4e7c943c-2ef9-401d-be53-c36a56e020ef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6accee9b-106e-4e7d-8ddf-62cfe10d943f' class='xr-var-data-in' type='checkbox'><label for='data-6accee9b-106e-4e7d-8ddf-62cfe10d943f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([337.745685, 337.746946, 337.748206, ..., 338.650534, 338.651794,\n       338.653054])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>64.22 64.22 64.22 ... 64.42 64.42</div><input id='attrs-a2c45b5a-e65a-4ccc-b91a-e8cce9242a00' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a2c45b5a-e65a-4ccc-b91a-e8cce9242a00' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9b134e2e-e516-4f92-b238-37bb9b012f45' class='xr-var-data-in' type='checkbox'><label for='data-9b134e2e-e516-4f92-b238-37bb9b012f45' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([64.221147, 64.221283, 64.22142 , ..., 64.417476, 64.417612, 64.417749])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b92821e7-c58b-4193-b671-1991ac154eba' class='xr-section-summary-in' type='checkbox'  ><label for='section-b92821e7-c58b-4193-b671-1991ac154eba' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3fa5a925-847a-42c3-917c-0fafdcfb2e8f' class='xr-index-data-in' type='checkbox'/><label for='index-3fa5a925-847a-42c3-917c-0fafdcfb2e8f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([337.74568546967896,  337.7469457041597, 337.74820593864047,\n        337.7494661731212,   337.750726407602,  337.7519866420827,\n        337.7532468765635, 337.75450711104423,   337.755767345525,\n       337.75702758000574,\n       ...\n       338.64171218549455,  338.6429724199753, 338.64423265445606,\n        338.6454928889368, 338.64675312341757,  338.6480133578983,\n        338.6492735923791,  338.6505338268598,  338.6517940613406,\n       338.65305429582133],\n      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=721))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e564097d-3ca9-4444-970e-598ce1af3d05' class='xr-index-data-in' type='checkbox'/><label for='index-e564097d-3ca9-4444-970e-598ce1af3d05' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([64.22114671124693, 64.22128314558039, 64.22141957991384,\n        64.2215560142473, 64.22169244858075, 64.22182888291421,\n       64.22196531724767, 64.22210175158112, 64.22223818591458,\n       64.22237462024803,\n       ...\n       64.41652067675561, 64.41665711108907, 64.41679354542252,\n       64.41692997975598, 64.41706641408943, 64.41720284842289,\n       64.41733928275634,  64.4174757170898, 64.41761215142326,\n       64.41774858575671],\n      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=1442))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4502b4a0-c0e5-4a54-a3f8-cd0e90da6c24' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4502b4a0-c0e5-4a54-a3f8-cd0e90da6c24' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>regrid_method :</span></dt><dd>bilinear</dd></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray (time: 751, lat: 1442, lon: 721)> Size: 3GB\narray([[[ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        ...,\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.]],\n\n       [[ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        ...,\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.]],\n\n       [[ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        ...,\n...\n        ...,\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.]],\n\n       [[ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        ...,\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.]],\n\n       [[ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        [ 0.,  0.,  0., ..., nan,  0.,  0.],\n        ...,\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.],\n        [ 0.,  0.,  0., ...,  0.,  0.,  0.]]], dtype=float32)\nCoordinates:\n    depth    float32 4B -10.0\n  * lon      (lon) float64 6kB 337.7 337.7 337.7 337.7 ... 338.7 338.7 338.7\n  * lat      (lat) float64 12kB 64.22 64.22 64.22 64.22 ... 64.42 64.42 64.42\nDimensions without coordinates: time\nAttributes:\n    regrid_method:  bilinear","content_type":"text/plain"}}},"children":[],"key":"ndt4bWpsdg"}],"key":"Nso1i9x713"}],"key":"k8zRpkOzLe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"\nreference_date = np.datetime64('2000-01-01T00:00:00')\n\n# Convert seconds to datetime\ndatetime_array = reference_date + (model['ocean_time']).astype('timedelta64[s]')\n","key":"UaY4Px4VsG"},{"type":"outputs","id":"Uh3R33TQt7wT9olC4ro_Z","children":[],"key":"faZ8gD5OF0"}],"key":"x2pdwKz4N2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model['ocean_time']=datetime_array","key":"ATBnfbigZ8"},{"type":"outputs","id":"FltWGzSFApZ2GoU0KWhDA","children":[],"key":"j4PZU2ojIN"}],"key":"Uu5RxORAjK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"datasets","key":"ft6SiBCsuv"},{"type":"outputs","id":"opmIWYBWrpI3NPpUMbCa6","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":38,"metadata":{},"data":{"text/plain":{"content":"{'HVIN_1': <xarray.Dataset> Size: 6MB\n Dimensions:   (time_dim: 19068, depth_dim: 12, lat_dim: 1, lon_dim: 1)\n Coordinates:\n     lon       (lon_dim) float64 8B 338.5\n   * time_dim  (time_dim) datetime64[ns] 153kB 2024-04-05T08:00:00.000003349 ....\n Dimensions without coordinates: depth_dim, lat_dim, lon_dim\n Data variables:\n     time      (time_dim) float64 153kB 7.393e+05 7.393e+05 ... 7.395e+05\n     depth     (depth_dim) float64 96B ...\n     lat       (lat_dim) float64 8B ...\n     u         (depth_dim, time_dim) float64 2MB ...\n     v         (depth_dim, time_dim) float64 2MB ...\n     w         (depth_dim, time_dim) float64 2MB ...\n     iigood    (depth_dim) float64 96B 2.0 3.0 4.0 5.0 ... 10.0 11.0 12.0 13.0,\n 'HVNA_1': <xarray.Dataset> Size: 2MB\n Dimensions:   (time_dim: 19058, depth_dim: 4, lat_dim: 1, lon_dim: 1)\n Coordinates:\n     lon       (lon_dim) float64 8B 338.3\n   * time_dim  (time_dim) datetime64[ns] 152kB 2024-04-05T08:00:00.000003349 ....\n Dimensions without coordinates: depth_dim, lat_dim, lon_dim\n Data variables:\n     time      (time_dim) float64 152kB 7.393e+05 7.393e+05 ... 7.395e+05\n     depth     (depth_dim) float64 32B ...\n     lat       (lat_dim) float64 8B ...\n     u         (depth_dim, time_dim) float64 610kB ...\n     v         (depth_dim, time_dim) float64 610kB ...\n     w         (depth_dim, time_dim) float64 610kB ...\n     iigood    (depth_dim) float64 32B 2.0 3.0 4.0 5.0,\n 'HVNV_1': <xarray.Dataset> Size: 3MB\n Dimensions:   (time_dim: 19030, depth_dim: 5, lat_dim: 1, lon_dim: 1)\n Coordinates:\n     lon       (lon_dim) float64 8B 338.1\n   * time_dim  (time_dim) datetime64[ns] 152kB 2024-04-05T08:00:00.000003349 ....\n Dimensions without coordinates: depth_dim, lat_dim, lon_dim\n Data variables:\n     time      (time_dim) float64 152kB 7.393e+05 7.393e+05 ... 7.395e+05\n     depth     (depth_dim) float64 40B ...\n     lat       (lat_dim) float64 8B ...\n     u         (depth_dim, time_dim) float64 761kB ...\n     v         (depth_dim, time_dim) float64 761kB ...\n     w         (depth_dim, time_dim) float64 761kB ...\n     iigood    (depth_dim) float64 40B 2.0 3.0 4.0 5.0 6.0,\n 'HVSA_1': <xarray.Dataset> Size: 2MB\n Dimensions:   (time_dim: 19054, depth_dim: 4, lat_dim: 1, lon_dim: 1)\n Coordinates:\n     lon       (lon_dim) float64 8B 338.3\n   * time_dim  (time_dim) datetime64[ns] 152kB 2024-04-05T08:00:00.000003349 ....\n Dimensions without coordinates: depth_dim, lat_dim, lon_dim\n Data variables:\n     time      (time_dim) float64 152kB 7.393e+05 7.393e+05 ... 7.395e+05\n     depth     (depth_dim) float64 32B ...\n     lat       (lat_dim) float64 8B ...\n     u         (depth_dim, time_dim) float64 610kB ...\n     v         (depth_dim, time_dim) float64 610kB ...\n     w         (depth_dim, time_dim) float64 610kB ...\n     iigood    (depth_dim) float64 32B 2.0 3.0 4.0 5.0,\n 'HVSV_1': <xarray.Dataset> Size: 2MB\n Dimensions:   (time_dim: 19108, depth_dim: 4, lat_dim: 1, lon_dim: 1)\n Coordinates:\n     lon       (lon_dim) float64 8B 338.1\n   * time_dim  (time_dim) datetime64[ns] 153kB 2024-04-05T08:00:00.000003349 ....\n Dimensions without coordinates: depth_dim, lat_dim, lon_dim\n Data variables:\n     time      (time_dim) float64 153kB 7.393e+05 7.393e+05 ... 7.395e+05\n     depth     (depth_dim) float64 32B ...\n     lat       (lat_dim) float64 8B ...\n     u         (depth_dim, time_dim) float64 611kB ...\n     v         (depth_dim, time_dim) float64 611kB ...\n     w         (depth_dim, time_dim) float64 611kB ...\n     iigood    (depth_dim) float64 32B 2.0 3.0 4.0 5.0}","content_type":"text/plain"}}},"children":[],"key":"xfFqBQp8xI"}],"key":"HknlhhyklS"}],"key":"Epkjsafs65"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nimport xarray as xr\nfrom windrose import WindroseAxes\n\n# Define the number of stations\nnum_stations = 5\n\n# Define the observation subset time range (2024)\nobs_time_range = slice('2024-05-05', '2024-07-05')\n\n# Define the model subset time range (2023)\nmodel_time_range = slice('2023-05-05', '2023-07-05')\n\n# Create figure for timeseries plots\nfig, axs = plt.subplots(nrows=num_stations, ncols=2, figsize=(12, 3 * num_stations), sharex=False)\nfig.suptitle(\"Timeseries Comparison: Observations (2024) vs Model (2023)\", fontsize=14)\n\nfor i in range(num_stations):\n\n    # Subset observation data for 2024\n    obs=list(datasets.values())[i]\n    obs_subset = obs.sel(time_dim=obs_time_range)\n    depth_index = (np.abs(obs_subset['depth_dim'].values - 10)).argmin()\n    u_obs = obs_subset['u'].isel(depth_dim=depth_index)[::6]  # Every 6th entry\n    obs_lon=obs.lon\n    obs_lat=obs.lat\n    \n    # Extract model data at station location and for the correct time range\n    u_sel = u_rg.sel(lon=obs_lon.values, method='nearest').sel(lat=obs_lat.values, method='nearest')\n    #u_sel = u_sel.sel(time_dim=model_time_range)  # Select only 2023 data\n\n    # Plot observations (2024)\n    axs[i, 0].plot(obs_subset.time_dim[::6], u_obs, label=\"Observed U (2024)\", color=\"blue\")\n    axs[i, 0].set_title(f\"Station {i+1} - Observations (2024)\")\n    axs[i, 0].tick_params(axis='x', rotation=45)\n    axs[i, 0].legend()\n    \n    # Plot model (2023)\n    axs[i, 1].plot(model['ocean_time'], u_sel.squeeze(), label=\"Model U (2023)\", color=\"green\")\n    axs[i, 1].set_title(f\"Station {i+1} - Model (2023)\")\n    axs[i, 1].tick_params(axis='x', rotation=45)\n    axs[i, 1].legend()\n\nplt.tight_layout()\nplt.show()\n\n\n","key":"TmJvksHw4M"},{"type":"outputs","id":"CxdSyg49SFn5WDmoR0k4I","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3fdf8011c0a1a791b623fb5c00f6f067","path":"/3fdf8011c0a1a791b623fb5c00f6f067.png"},"text/plain":{"content":"<Figure size 1200x1500 with 10 Axes>","content_type":"text/plain"}}},"children":[],"key":"hdC3acvuj4"}],"key":"Hd170smHFb"}],"key":"TO4Q3kVGJr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"obs.lat","key":"hRPxraRIBa"},{"type":"outputs","id":"_yXl1uonzFoKcKpV-ePQf","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=dark],\nhtml[data-theme=dark],\nbody[data-theme=dark],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1F1F1F;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: '►';\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: '▼';\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: '(';\n}\n\n.xr-dim-list:after {\n  content: ')';\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: ',';\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;lat&#x27; (lat_dim: 1)&gt; Size: 8B\narray([64.299167])\nDimensions without coordinates: lat_dim</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'lat'</div><ul class='xr-dim-list'><li><span>lat_dim</span>: 1</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-afb08b42-db89-40e8-8808-b1c63c43bb4f' class='xr-array-in' type='checkbox' checked><label for='section-afb08b42-db89-40e8-8808-b1c63c43bb4f' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>64.3</span></div><div class='xr-array-data'><pre>array([64.299167])</pre></div></div></li><li class='xr-section-item'><input id='section-9fd5fd16-b0d4-49a6-bb7e-6c59703d879d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-9fd5fd16-b0d4-49a6-bb7e-6c59703d879d' class='xr-section-summary'  title='Expand/collapse section'>Coordinates: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-6070c726-0e16-4dc4-ae56-8e5ac8a44dc1' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-6070c726-0e16-4dc4-ae56-8e5ac8a44dc1' class='xr-section-summary'  title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-cd03a38e-aeb2-4050-80c5-f91098ff6d53' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-cd03a38e-aeb2-4050-80c5-f91098ff6d53' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray 'lat' (lat_dim: 1)> Size: 8B\narray([64.299167])\nDimensions without coordinates: lat_dim","content_type":"text/plain"}}},"children":[],"key":"Qa4sKhE8yq"}],"key":"lggYtxd0kx"}],"key":"ivs14CeFeJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom windrose import WindroseAxes\n\n# Define number of stations\nnum_stations = 5\n\n# Create a figure with 2 columns (Obs & Model) and num_stations rows\nfig = plt.figure(figsize=(14, 7 * num_stations),layout='tight')\n\nfig.suptitle(\"Wind Roses: Observations (2024) vs Model (2023)\", fontsize=16)\n\nfor i in range(5):\n\n    # Compute observed wind speed and direction\n    obs=list(datasets.values())[i]\n    obs_subset = obs.sel(time_dim=obs_time_range)\n    depth_index = (np.abs(obs_subset['depth_dim'].values - 10)).argmin()\n    u_obs = obs_subset['u'].sel(depth_dim=depth_index)[::6]\n    v_obs = obs_subset['v'].sel(depth_dim=depth_index)[::6]\n    obs_lon=obs.lon\n    obs_lat=obs.lat\n    direction_obs = (np.arctan2(-u_obs.squeeze().values, -v_obs.squeeze().values) * (180 / np.pi) + 360) % 360\n    speed_obs = np.sqrt(u_obs.squeeze().values**2 + v_obs.squeeze().values**2)\n\n    # Compute model wind speed and direction\n    u_sel = u_rg.sel(lon=obs_lon.values, method='nearest').sel(lat=obs_lat.values, method='nearest')\n    v_sel = v_rg.sel(lon=obs_lon.values, method='nearest').sel(lat=obs_lat.values, method='nearest')\n    \n    direction_model = (np.arctan2(-u_sel.squeeze().values, -v_sel.squeeze().values) * (180 / np.pi) + 360) % 360\n    speed_model = np.sqrt(u_sel.squeeze().values**2 + v_sel.squeeze().values**2)\n\n    # Define subplot positions using bbox (left, bottom, width, height)\n    ax_obs = WindroseAxes(fig, [0.05, 0.75 - (i * 0.2), 0.4, 0.18])  # Left column\n    fig.add_axes(ax_obs)\n    ax_obs.bar(direction_obs, speed_obs, normed=True, opening=0.8, edgecolor='white', bins=np.linspace(0, 0.6, 7))\n    ax_obs.set_title(str(stations[i])+' - Obs (2024)')\n    ax_obs.set_legend()\n    ax_obs.set_rticks([5, 10, 15, 20, 25, 30])\n    ax_obs.set_yticklabels(['5%', '10%', '15%', '20%', '25%', '30%'])\n    \n    ax_model = WindroseAxes(fig, [0.55, 0.75 - (i * 0.2), 0.4, 0.18])  # Right column\n    fig.add_axes(ax_model)\n    ax_model.bar(direction_model, speed_model, normed=True, opening=0.8, edgecolor='white', bins=np.linspace(0, 0.6, 7))\n    ax_model.set_title(str(stations[i])+' - Model (2023)')\n    ax_model.set_legend()\n    ax_model.set_rticks([5, 10, 15, 20, 25, 30])\n    ax_model.set_yticklabels(['5%', '10%', '15%', '20%', '25%', '30%'])\n\nplt.show()\n","key":"Kjm8S7xXC8"},{"type":"outputs","id":"BAoZ7cgqrBzo2oNKFDtPY","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/IPython/core/pylabtools.py:170: UserWarning: This figure includes Axes that are not compatible with tight_layout, so results might be incorrect.\n  fig.canvas.print_figure(bytes_io, **kw)\n"},"children":[],"key":"pJQ8bg0y9K"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d8c4469abd4194e714dcdbdc2c14622d","path":"/d8c4469abd4194e714dcdbdc2c14622d.png"},"text/plain":{"content":"<Figure size 1400x3500 with 10 Axes>","content_type":"text/plain"}}},"children":[],"key":"BYvo9AQ7xT"}],"key":"QCW98MoP92"}],"key":"bhe4HyCd5z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.signal import find_peaks\n\ndef compute_spectrum(time, signal):\n    \"\"\"Compute the FFT and identify spectral peaks.\"\"\"\n    \n    # Compute FFT\n    n = len(signal)\n    dt = np.mean(np.diff(time))  # Time step (assuming uniform spacing)\n    freq = np.fft.rfftfreq(n, d=dt)  # Compute frequency axis\n    spectrum = np.fft.rfft(signal)   # Compute FFT\n    power = np.abs(spectrum)**2      # Compute Power Spectral Density (PSD)\n    \n    # Find peaks in the power spectrum\n    peaks, _ = find_peaks(power, height=np.max(power) * 0.1)  # Peaks with at least 10% of max power\n    \n    return freq, power, peaks\nreference_time = np.datetime64('2000-01-01T00:00:00', 's')\n\n# Example time series (Replace these with your observed and modeled data)\nobs_time = (obs_subset.time_dim[::6].load() - reference_time).astype('timedelta64[h]').astype(int).values\n# Define reference time (2000-01-01T00:00:00)\n\n\n\nmodel_time = (model['ocean_time'].load() - reference_time).astype('timedelta64[h]').astype(int).load().values# Example time axis (modify as needed)\nobs_time=(obs_time-obs_time[0])*10**(-9)*1/3600\nmodel_time=(model_time-model_time[0])*10**(-9)*1/3600\n\nobserved_signal = u_obs.squeeze().values  # Example signal\nmodeled_signal = u_sel.squeeze().values # Example signal\n\n# Compute spectra\nfreq_obs, power_obs, peaks_obs = compute_spectrum(obs_time, observed_signal)\nfreq_mod, power_mod, peaks_mod = compute_spectrum(model_time, modeled_signal)\n\n# Plot results\nplt.figure(figsize=(10, 5))\n\n# Observed Spectrum\nplt.plot(freq_obs, power_obs, label=\"Observed Spectrum\", color='b')\nplt.scatter(freq_obs[peaks_obs], power_obs[peaks_obs], color='r', label=\"Observed Peaks\", zorder=3)\n\n# Modeled Spectrum\nplt.plot(freq_mod, power_mod, label=\"Modeled Spectrum\", color='g', linestyle='dashed')\nplt.scatter(freq_mod[peaks_mod], power_mod[peaks_mod], color='orange', label=\"Modeled Peaks\", zorder=3)\n\nplt.xlabel(\"Frequency (Hz)\")\nplt.ylabel(\"Power\")\nplt.legend()\nplt.title(\"Spectral Peaks in Observed and Modeled Data\")\nplt.grid()\nplt.show()\n\n","key":"XyVV5gcL5T"},{"type":"outputs","id":"zJ0VgeygPO6kgOZNjWv7-","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_1865396/40607730.py:22: UserWarning: Converting non-nanosecond precision timedelta values to nanosecond precision. This behavior can eventually be relaxed in xarray, as it is an artifact from pandas which is now beginning to support non-nanosecond precision values. This warning is caused by passing non-nanosecond np.datetime64 or np.timedelta64 values to the DataArray or Variable constructor; it can be silenced by converting the values to nanosecond precision ahead of time.\n  obs_time = (obs_subset.time_dim[::6].load() - reference_time).astype('timedelta64[h]').astype(int).values\n/tmp/ipykernel_1865396/40607730.py:27: UserWarning: Converting non-nanosecond precision datetime values to nanosecond precision. This behavior can eventually be relaxed in xarray, as it is an artifact from pandas which is now beginning to support non-nanosecond precision values. This warning is caused by passing non-nanosecond np.datetime64 or np.timedelta64 values to the DataArray or Variable constructor; it can be silenced by converting the values to nanosecond precision ahead of time.\n  model_time = (model['ocean_time'].load() - reference_time).astype('timedelta64[h]').astype(int).load().values# Example time axis (modify as needed)\n/tmp/ipykernel_1865396/40607730.py:27: UserWarning: Converting non-nanosecond precision timedelta values to nanosecond precision. This behavior can eventually be relaxed in xarray, as it is an artifact from pandas which is now beginning to support non-nanosecond precision values. This warning is caused by passing non-nanosecond np.datetime64 or np.timedelta64 values to the DataArray or Variable constructor; it can be silenced by converting the values to nanosecond precision ahead of time.\n  model_time = (model['ocean_time'].load() - reference_time).astype('timedelta64[h]').astype(int).load().values# Example time axis (modify as needed)\n"},"children":[],"key":"nrk5Jnq4Fj"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"36748ca4c2fdcccc541cd5de68d2120c","path":"/36748ca4c2fdcccc541cd5de68d2120c.png"},"text/plain":{"content":"<Figure size 1000x500 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"Cag3QmuVzW"}],"key":"KDR56bLSKu"}],"key":"wWxRgpWHjH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy.signal import find_peaks\n\ndef compute_spectrum(time, signal):\n    \"\"\"Compute the FFT and identify spectral peaks.\"\"\"\n    \n    # Compute FFT\n    n = len(signal)\n    dt = np.mean(np.diff(time))  # Time step (assuming uniform spacing)\n    freq = np.fft.rfftfreq(n, d=dt)  # Compute frequency axis\n    spectrum = np.fft.rfft(signal)   # Compute FFT\n    power = np.abs(spectrum)**2      # Compute Power Spectral Density (PSD)\n    \n    # Find peaks in the power spectrum\n    peaks, _ = find_peaks(power, height=np.max(power) * 0.1)  # Peaks with at least 10% of max power\n    \n    return freq, power, peaks\n\n# Reference time\nreference_time = np.datetime64('2000-01-01T00:00:00', 's')\n\n# Convert time to hours\nobs_time = (obs_subset.time_dim[::6].load() - reference_time).astype('timedelta64[h]').astype(int).values\nmodel_time = (model['ocean_time'] - reference_time).astype('timedelta64[h]').astype(int).load().values\nobs_time=(obs_time-obs_time[0])*10**(-9)*1/3600\nmodel_time=(model_time-model_time[0])*10**(-9)*1/3600\n\n# Example signals\nobserved_signal = u_obs.squeeze().values  \nmodeled_signal = u_sel.squeeze().values  \n\n# Compute spectra\nfreq_obs, power_obs, peaks_obs = compute_spectrum(obs_time, observed_signal)\nfreq_mod, power_mod, peaks_mod = compute_spectrum(model_time, modeled_signal)\n\n# Convert frequency to period (avoid division by zero)\nperiod_obs = 1 / freq_obs[1:]  # Ignore first value to avoid division by zero\nperiod_mod = 1 / freq_mod[1:]\n\n# Plot results\nplt.figure(figsize=(10, 5))\n\n# Observed Spectrum\nplt.plot(period_obs, power_obs[1:], label=\"Observed Spectrum\", color='b')\n#plt.scatter(period_obs[peaks_obs - 1], power_obs[peaks_obs][1:], color='r', label=\"Observed Peaks\", zorder=3)\n\n# Modeled Spectrum\nplt.plot(period_mod, power_mod[1:], label=\"Modeled Spectrum\", color='g', linestyle='dashed')\n#plt.scatter(period_mod[peaks_mod - 1], power_mod[peaks_mod][1:], color='orange', label=\"Modeled Peaks\", zorder=3)\n\n#plt.xscale(\"log\")  # Log scale to better show long periods\nplt.xlabel(\"Period (hours)\")\nplt.ylabel(\"Power\")\nplt.legend()\nplt.title(\"Spectral Peaks in Observed and Modeled Data\")\nplt.grid(which=\"both\", linestyle=\"--\", linewidth=0.5)\nplt.gca().invert_xaxis()  # Invert x-axis so long periods are on the right\nplt.xlim(1,24*20)\nplt.show()\n","key":"tXkLZ3VmFR"},{"type":"outputs","id":"jQs_S0iTj8rNR1QTqZ9Et","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_1865396/980353686.py:24: UserWarning: Converting non-nanosecond precision timedelta values to nanosecond precision. This behavior can eventually be relaxed in xarray, as it is an artifact from pandas which is now beginning to support non-nanosecond precision values. This warning is caused by passing non-nanosecond np.datetime64 or np.timedelta64 values to the DataArray or Variable constructor; it can be silenced by converting the values to nanosecond precision ahead of time.\n  obs_time = (obs_subset.time_dim[::6].load() - reference_time).astype('timedelta64[h]').astype(int).values\n/tmp/ipykernel_1865396/980353686.py:25: UserWarning: Converting non-nanosecond precision timedelta values to nanosecond precision. This behavior can eventually be relaxed in xarray, as it is an artifact from pandas which is now beginning to support non-nanosecond precision values. This warning is caused by passing non-nanosecond np.datetime64 or np.timedelta64 values to the DataArray or Variable constructor; it can be silenced by converting the values to nanosecond precision ahead of time.\n  model_time = (model['ocean_time'] - reference_time).astype('timedelta64[h]').astype(int).load().values\n"},"children":[],"key":"OxlnJFoMjH"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9b41933257e19ef8fe5a40fdd9bb2dd4","path":"/9b41933257e19ef8fe5a40fdd9bb2dd4.png"},"text/plain":{"content":"<Figure size 1000x500 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"lvTFtAQn6H"}],"key":"Rw7WlRGk8F"}],"key":"QKiJUp4jdt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\ndef bandpass_filter(time, signal, min_period=10, max_period=15):\n    \"\"\"Filter the signal to retain only frequencies corresponding to periods between min_period and max_period hours.\"\"\"\n    \n    # Compute FFT\n    n = len(signal)\n    dt = np.mean(np.diff(time))  # Time step in hours\n    freq = np.fft.rfftfreq(n, d=dt)  # Frequency axis (in Hz or cycles per hour)\n    spectrum = np.fft.rfft(signal)   # Compute FFT\n\n    # Convert periods to frequencies\n    min_freq = 1 / max_period  # Lower cutoff frequency\n    max_freq = 1 / min_period  # Upper cutoff frequency\n\n    # Zero out frequencies outside the band\n    spectrum[(freq < min_freq) | (freq > max_freq)] = 0\n\n    # Inverse FFT to reconstruct filtered signal\n    filtered_signal = np.fft.irfft(spectrum, n=n)\n\n    return filtered_signal\n\n# Convert time to hours since reference time\nreference_time = np.datetime64('2000-01-01T00:00:00', 's')\nobs_time = (obs_subset.time_dim[::6].load() - reference_time).astype('timedelta64[h]').astype(int).values\nmodel_time = (model['ocean_time'] - reference_time).astype('timedelta64[h]').astype(int).load().values\nobs_time=(obs_time-obs_time[0])*10**(-9)*1/3600\nmodel_time=(model_time-model_time[0])*10**(-9)*1/3600\n\n# Apply band-pass filter\nu_obs_filtered = bandpass_filter(obs_time, u_obs.squeeze().values, min_period=10, max_period=15)\nu_model_filtered = bandpass_filter(model_time, u_sel.squeeze().values, min_period=10, max_period=15)\n\n# Create figure and subplots\nfig, axs = plt.subplots(nrows=2, ncols=1, figsize=(12, 8), sharex=True)\n\n# Plot filtered observed signal\naxs[0].plot(obs_time, u_obs_filtered, label=\"Filtered Observed (10-15h)\", color='b')\naxs[0].set_ylabel(\"Velocity (m/s)\")\naxs[0].set_title(\"Filtered Observed u_obs (10-15h Period)\")\naxs[0].legend()\naxs[0].grid()\n\n# Plot filtered modeled signal\naxs[1].plot(model_time, u_model_filtered, label=\"Filtered Modeled (10-15h)\", color='g')\naxs[1].set_xlabel(\"Time (hours)\")\naxs[1].set_ylabel(\"Velocity (m/s)\")\naxs[1].set_title(\"Filtered Modeled u_model (10-15h Period)\")\naxs[1].legend()\naxs[1].grid()\n\nplt.tight_layout()\nplt.show()\n","key":"YnVPtVQBo7"},{"type":"outputs","id":"p1_lP6jbYs4kliXPZcXNO","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_1865396/2325760596.py:27: UserWarning: Converting non-nanosecond precision timedelta values to nanosecond precision. This behavior can eventually be relaxed in xarray, as it is an artifact from pandas which is now beginning to support non-nanosecond precision values. This warning is caused by passing non-nanosecond np.datetime64 or np.timedelta64 values to the DataArray or Variable constructor; it can be silenced by converting the values to nanosecond precision ahead of time.\n  obs_time = (obs_subset.time_dim[::6].load() - reference_time).astype('timedelta64[h]').astype(int).values\n/tmp/ipykernel_1865396/2325760596.py:28: UserWarning: Converting non-nanosecond precision timedelta values to nanosecond precision. This behavior can eventually be relaxed in xarray, as it is an artifact from pandas which is now beginning to support non-nanosecond precision values. This warning is caused by passing non-nanosecond np.datetime64 or np.timedelta64 values to the DataArray or Variable constructor; it can be silenced by converting the values to nanosecond precision ahead of time.\n  model_time = (model['ocean_time'] - reference_time).astype('timedelta64[h]').astype(int).load().values\n"},"children":[],"key":"AGYr26R1e6"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"af825a600a0a395e2f2172c2737a51c6","path":"/af825a600a0a395e2f2172c2737a51c6.png"},"text/plain":{"content":"<Figure size 1200x800 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"wvzdDmVuMm"}],"key":"Zgl3zW9Lnw"}],"key":"LF5GIDIIoc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\ndef highpass_filter(time, signal, cutoff_period=10):\n    \"\"\"Remove frequencies with periods longer than `cutoff_period` hours (high-pass filter).\"\"\"\n\n    # Compute FFT\n    n = len(signal)\n    dt = np.mean(np.diff(time))  # Time step in hours\n    freq = np.fft.rfftfreq(n, d=dt)  # Frequency axis (in Hz or cycles per hour)\n    spectrum = np.fft.rfft(signal)   # Compute FFT\n\n    # Define cutoff frequency\n    cutoff_freq = 1 / cutoff_period  # Frequency corresponding to the longest period to keep\n\n    # Zero out frequencies below the cutoff (i.e., remove long periods)\n    spectrum[freq < cutoff_freq] = 0\n\n    # Inverse FFT to reconstruct the high-pass filtered signal\n    filtered_signal = np.fft.irfft(spectrum, n=n)\n\n    return filtered_signal\n\n# Apply high-pass filter (removing periods ≥ 10 hours)\nu_obs_highpass = highpass_filter(obs_time, u_obs.squeeze().values, cutoff_period=10)\nu_model_highpass = highpass_filter(model_time, u_sel.squeeze().values, cutoff_period=10)\n\n# Create figure and subplots\nfig, axs = plt.subplots(nrows=2, ncols=1, figsize=(12, 8), sharex=True)\n\n# Plot high-pass filtered observed signal\naxs[0].plot(obs_time, u_obs_highpass, label=\"Observed (Periods < 10h)\", color='b')\naxs[0].set_ylabel(\"Velocity (m/s)\")\naxs[0].set_title(\"High-Pass Filtered Observed u_obs (Periods < 10h)\")\naxs[0].legend()\naxs[0].grid()\n\n# Plot high-pass filtered modeled signal\naxs[1].plot(model_time, u_model_highpass, label=\"Modeled (Periods < 10h)\", color='g')\naxs[1].set_xlabel(\"Time (hours)\")\naxs[1].set_ylabel(\"Velocity (m/s)\")\naxs[1].set_title(\"High-Pass Filtered Modeled u_model (Periods < 10h)\")\naxs[1].legend()\naxs[1].grid()\n\nplt.tight_layout()\nplt.show()\n","key":"R41XZuG8D9"},{"type":"outputs","id":"wk9_lWs-VUzYiLT7butOZ","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"ea16e70ed4b0f9c928e7e402a8d6ab8e","path":"/ea16e70ed4b0f9c928e7e402a8d6ab8e.png"},"text/plain":{"content":"<Figure size 1200x800 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"yXas3uwPPV"}],"key":"ISqjo1Rrab"}],"key":"MrtkVv1Jsh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\ndef lowpass_filter(time, signal, cutoff_period=15):\n    \"\"\"Remove frequencies with periods longer than `cutoff_period` hours (high-pass filter).\"\"\"\n\n    # Compute FFT\n    n = len(signal)\n    dt = np.mean(np.diff(time))  # Time step in hours\n    freq = np.fft.rfftfreq(n, d=dt)  # Frequency axis (in Hz or cycles per hour)\n    spectrum = np.fft.rfft(signal)   # Compute FFT\n\n    # Define cutoff frequency\n    cutoff_freq = 1 / cutoff_period  # Frequency corresponding to the longest period to keep\n\n    # Zero out frequencies below the cutoff (i.e., remove long periods)\n    spectrum[freq > cutoff_freq] = 0\n\n    # Inverse FFT to reconstruct the high-pass filtered signal\n    filtered_signal = np.fft.irfft(spectrum, n=n)\n\n    return filtered_signal\n\n# Apply high-pass filter (removing periods ≥ 10 hours)\nu_obs_lowpass = lowpass_filter(obs_time, u_obs.squeeze().values, cutoff_period=15)\nu_model_lowpass = lowpass_filter(model_time, u_sel.squeeze().values, cutoff_period=15)\n\n# Create figure and subplots\nfig, axs = plt.subplots(nrows=2, ncols=1, figsize=(12, 8), sharex=True)\n\n# Plot high-pass filtered observed signal\naxs[0].plot(obs_time, u_obs_lowpass, label=\"Observed (Periods > 15h)\", color='b')\naxs[0].set_ylabel(\"Velocity (m/s)\")\naxs[0].set_title(\"Low-Pass Filtered Observed u_obs (Periods > 15h)\")\naxs[0].legend()\naxs[0].grid()\n\n# Plot high-pass filtered modeled signal\naxs[1].plot(model_time, u_model_lowpass, label=\"Modeled (Periods > 15h)\", color='g')\naxs[1].set_xlabel(\"Time (hours)\")\naxs[1].set_ylabel(\"Velocity (m/s)\")\naxs[1].set_title(\"Low-Pass Filtered Modeled u_model (Periods > 15h)\")\naxs[1].legend()\naxs[1].grid()\n\nplt.tight_layout()\nplt.show()\n","key":"RyYCIKxiRL"},{"type":"outputs","id":"SOUOhxag5esoHQ2b7jwIu","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2e544b4a764db0eaf4e592891977aeb9","path":"/2e544b4a764db0eaf4e592891977aeb9.png"},"text/plain":{"content":"<Figure size 1200x800 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"CWzE9vl4ov"}],"key":"vqClCUMQQa"}],"key":"fAG9qkRNBi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\n\ndef bandpass_filter(time, signal, low_cutoff=10, high_cutoff=15):\n    \"\"\"Apply a bandpass filter to retain frequencies between `low_cutoff` and `high_cutoff` hours.\"\"\"\n    n = len(signal)\n    dt = np.mean(np.diff(time))\n    freq = np.fft.rfftfreq(n, d=dt)\n    spectrum = np.fft.rfft(signal)\n\n    # Define cutoff frequencies\n    low_freq = 1 / high_cutoff\n    high_freq = 1 / low_cutoff\n\n    # Zero out frequencies outside the band\n    spectrum[(freq < low_freq) | (freq > high_freq)] = 0\n\n    return np.fft.irfft(spectrum, n=n)\n\ndef highpass_filter(time, signal, cutoff_period=10):\n    \"\"\"Remove frequencies with periods longer than `cutoff_period` hours (retain high frequencies).\"\"\"\n    n = len(signal)\n    dt = np.mean(np.diff(time))\n    freq = np.fft.rfftfreq(n, d=dt)\n    spectrum = np.fft.rfft(signal)\n\n    # Define cutoff frequency\n    cutoff_freq = 1 / cutoff_period  \n\n    # Zero out frequencies below the cutoff (remove long periods)\n    spectrum[freq < cutoff_freq] = 0\n\n    return np.fft.irfft(spectrum, n=n)\n\ndef lowpass_filter(time, signal, cutoff_period=15):\n    \"\"\"Remove frequencies with periods shorter than `cutoff_period` hours (retain low frequencies).\"\"\"\n    n = len(signal)\n    dt = np.mean(np.diff(time))\n    freq = np.fft.rfftfreq(n, d=dt)\n    spectrum = np.fft.rfft(signal)\n\n    # Define cutoff frequency\n    cutoff_freq = 1 / cutoff_period  \n\n    # Zero out frequencies above the cutoff (remove short periods)\n    spectrum[freq > cutoff_freq] = 0\n\n    return np.fft.irfft(spectrum, n=n)\n\n# Apply filters to observed and modeled data\nu_obs_bandpass = bandpass_filter(obs_time, u_obs.squeeze().values, low_cutoff=10, high_cutoff=15)\nu_model_bandpass = bandpass_filter(model_time, u_sel.squeeze().values, low_cutoff=10, high_cutoff=15)\n\nu_obs_highpass = highpass_filter(obs_time, u_obs.squeeze().values, cutoff_period=10)\nu_model_highpass = highpass_filter(model_time, u_sel.squeeze().values, cutoff_period=10)\n\nu_obs_lowpass = lowpass_filter(obs_time, u_obs.squeeze().values, cutoff_period=15)\nu_model_lowpass = lowpass_filter(model_time, u_sel.squeeze().values, cutoff_period=15)\n\n# Prepare data for boxplot\ndata = [\n    u_obs_bandpass, u_model_bandpass,\n    u_obs_highpass, u_model_highpass,\n    u_obs_lowpass, u_model_lowpass\n]\n\nlabels = [\n    \"Obs Bandpass (10-15h)\", \"Model Bandpass (10-15h)\",\n    \"Obs High-pass (<10h)\", \"Model High-pass (<10h)\",\n    \"Obs Low-pass (>15h)\", \"Model Low-pass (>15h)\"\n]\n\n# Define colors (Obs = Light Green, Model = Light Blue)\ncolors = ['lightgreen', 'lightblue', 'lightgreen', 'lightblue', 'lightgreen', 'lightblue']\n\n# Create boxplot\nfig, ax = plt.subplots(figsize=(10, 6))\nboxplot = ax.boxplot(data, labels=labels, patch_artist=True, medianprops=dict(color=\"red\"))\n\n# Apply colors to boxes\nfor patch, color in zip(boxplot['boxes'], colors):\n    patch.set_facecolor(color)\n    patch.set_alpha(0.6)  # Transparency for better readability\n\nax.set_ylabel(\"Velocity (m/s)\")\nax.set_title(\"Boxplot of Filtered Velocity Components\")\n\nplt.xticks(rotation=20)  # Rotate labels for better readability\nplt.grid(axis='y', linestyle='--', alpha=0.6)\n\nplt.show()\n","key":"nybv63zndo"},{"type":"outputs","id":"5yxo24Zr8xufsAJ7aWW48","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_1865396/2300157572.py:78: MatplotlibDeprecationWarning: The 'labels' parameter of boxplot() has been renamed 'tick_labels' since Matplotlib 3.9; support for the old name will be dropped in 3.11.\n  boxplot = ax.boxplot(data, labels=labels, patch_artist=True, medianprops=dict(color=\"red\"))\n"},"children":[],"key":"puroK7eB86"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"730caeae196a0af389fc1270c7efa5c6","path":"/730caeae196a0af389fc1270c7efa5c6.png"},"text/plain":{"content":"<Figure size 1000x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"YbExpmzqXY"}],"key":"hjirq4pSci"}],"key":"sOicBCRLsK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#model=xr.open_mfdataset('/pscratch/sd/u/uheede/Iceland3_riv/z_Iceland3_MARBL_rnd.20230[5-6]????????.nc', combine='nested', concat_dim=[\"time\"])\n\n","key":"gxRBmtlNCu"},{"type":"outputs","id":"vhziLONZ6F0yZbpUOZXow","children":[],"key":"gt8vTD3t6Q"}],"key":"wTYa81m2KT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#u=model['u'].sel(depth=[-0,-1,-2,-3,-4,-5,-7,-9,-10,-12,-14,-15,-16,-18,-20,-26,-30,-36,-40,-50,-80]).mean('time')\n#v=model['v'].sel(depth=[-0,-1,-2,-3,-4,-5,-7,-9,-10,-12,-14,-15,-16,-18,-20,-26,-30,-36,-40,-50,-80]).mean('time')\n\n#u=roms_regrid_u(grid,u)\n#v=roms_regrid_v(grid,v)\n#mask=roms_regrid(grid,grid['mask_rho'])\n\n\n","key":"OOzt7DGZxx"},{"type":"outputs","id":"1iKEYG0RijwvXTuF0Drm2","children":[],"key":"bXb3VeucOF"}],"key":"Omj9I3UjuP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#u.load()\n#t.to_netcdf('/global/cfs/cdirs/m4746/Users/ulla/run/Iceland3_MARBL/t_06.nc')\n;","key":"ReepsIOLyI"},{"type":"outputs","id":"QK5JPdVyobFDhyE8mXvxw","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":50,"metadata":{},"data":{"text/plain":{"content":"''","content_type":"text/plain"}}},"children":[],"key":"Yllgb3ePJl"}],"key":"EZCLbM9fId"}],"key":"JQ8FMxycow"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#v.load()","key":"QqYsMupyfC"},{"type":"outputs","id":"3XKZE8h1MN6YGGU_AqYtv","children":[],"key":"dvIl0Tr4QO"}],"key":"elnySNsx5V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"datasets","key":"gYha4xHKAD"},{"type":"outputs","id":"HWrsTaZcMn87E6nUFlXP9","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"text/plain":{"content":"{'HVIN_1': <xarray.Dataset> Size: 6MB\n Dimensions:   (time_dim: 19068, depth_dim: 12, lat_dim: 1, lon_dim: 1)\n Coordinates:\n     lon       (lon_dim) float64 8B 338.5\n   * time_dim  (time_dim) datetime64[ns] 153kB 2024-04-05T08:00:00.000003349 ....\n Dimensions without coordinates: depth_dim, lat_dim, lon_dim\n Data variables:\n     time      (time_dim) float64 153kB 7.393e+05 7.393e+05 ... 7.395e+05\n     depth     (depth_dim) float64 96B ...\n     lat       (lat_dim) float64 8B 64.38\n     u         (depth_dim, time_dim) float64 2MB ...\n     v         (depth_dim, time_dim) float64 2MB ...\n     w         (depth_dim, time_dim) float64 2MB ...\n     iigood    (depth_dim) float64 96B 2.0 3.0 4.0 5.0 ... 10.0 11.0 12.0 13.0,\n 'HVNA_1': <xarray.Dataset> Size: 2MB\n Dimensions:   (time_dim: 19058, depth_dim: 4, lat_dim: 1, lon_dim: 1)\n Coordinates:\n     lon       (lon_dim) float64 8B 338.3\n   * time_dim  (time_dim) datetime64[ns] 152kB 2024-04-05T08:00:00.000003349 ....\n Dimensions without coordinates: depth_dim, lat_dim, lon_dim\n Data variables:\n     time      (time_dim) float64 152kB 7.393e+05 7.393e+05 ... 7.395e+05\n     depth     (depth_dim) float64 32B ...\n     lat       (lat_dim) float64 8B 64.37\n     u         (depth_dim, time_dim) float64 610kB ...\n     v         (depth_dim, time_dim) float64 610kB ...\n     w         (depth_dim, time_dim) float64 610kB ...\n     iigood    (depth_dim) float64 32B 2.0 3.0 4.0 5.0,\n 'HVNV_1': <xarray.Dataset> Size: 3MB\n Dimensions:   (time_dim: 19030, depth_dim: 5, lat_dim: 1, lon_dim: 1)\n Coordinates:\n     lon       (lon_dim) float64 8B 338.1\n   * time_dim  (time_dim) datetime64[ns] 152kB 2024-04-05T08:00:00.000003349 ....\n Dimensions without coordinates: depth_dim, lat_dim, lon_dim\n Data variables:\n     time      (time_dim) float64 152kB 7.393e+05 7.393e+05 ... 7.395e+05\n     depth     (depth_dim) float64 40B ...\n     lat       (lat_dim) float64 8B 64.31\n     u         (depth_dim, time_dim) float64 761kB ...\n     v         (depth_dim, time_dim) float64 761kB ...\n     w         (depth_dim, time_dim) float64 761kB ...\n     iigood    (depth_dim) float64 40B 2.0 3.0 4.0 5.0 6.0,\n 'HVSA_1': <xarray.Dataset> Size: 2MB\n Dimensions:   (time_dim: 19054, depth_dim: 4, lat_dim: 1, lon_dim: 1)\n Coordinates:\n     lon       (lon_dim) float64 8B 338.3\n   * time_dim  (time_dim) datetime64[ns] 152kB 2024-04-05T08:00:00.000003349 ....\n Dimensions without coordinates: depth_dim, lat_dim, lon_dim\n Data variables:\n     time      (time_dim) float64 152kB 7.393e+05 7.393e+05 ... 7.395e+05\n     depth     (depth_dim) float64 32B ...\n     lat       (lat_dim) float64 8B 64.36\n     u         (depth_dim, time_dim) float64 610kB ...\n     v         (depth_dim, time_dim) float64 610kB ...\n     w         (depth_dim, time_dim) float64 610kB ...\n     iigood    (depth_dim) float64 32B 2.0 3.0 4.0 5.0,\n 'HVSV_1': <xarray.Dataset> Size: 2MB\n Dimensions:   (time_dim: 19108, depth_dim: 4, lat_dim: 1, lon_dim: 1)\n Coordinates:\n     lon       (lon_dim) float64 8B 338.1\n   * time_dim  (time_dim) datetime64[ns] 153kB 2024-04-05T08:00:00.000003349 ....\n Dimensions without coordinates: depth_dim, lat_dim, lon_dim\n Data variables:\n     time      (time_dim) float64 153kB 7.393e+05 7.393e+05 ... 7.395e+05\n     depth     (depth_dim) float64 32B ...\n     lat       (lat_dim) float64 8B 64.3\n     u         (depth_dim, time_dim) float64 611kB ...\n     v         (depth_dim, time_dim) float64 611kB ...\n     w         (depth_dim, time_dim) float64 611kB ...\n     iigood    (depth_dim) float64 32B 2.0 3.0 4.0 5.0}","content_type":"text/plain"}}},"children":[],"key":"cxCOnrdAec"}],"key":"uijbFRAtsO"}],"key":"SdKG22PeuV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"wJw9o3b3WM"},{"type":"outputs","id":"J9eusBzpRHE6p64PP5wR4","children":[],"key":"AD1ELgj8HE"}],"key":"MzVUbByhY3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#obs=list(datasets.values())[1]\n\n#plt.plot(obs['u'].mean('time_dim').squeeze(),obs.depth)\n#plt.gca().invert_yaxis()\n\n#u_sel = u.sel(lon=obs_lon.values, method='nearest').sel(lat=obs_lat.values, method='nearest')\n#plt.plot(u_sel.squeeze(),u.depth*(-1))","key":"HQ3ppPC1oX"},{"type":"outputs","id":"6pmSLXl6defE-ULKLcGs_","children":[],"key":"K15MrhPlMz"}],"key":"lvCI1wEKdL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\n\n# Create figure and subplots\nfig, axes = plt.subplots(nrows=1, ncols=5, figsize=(20, 5), sharey=True)\n\n# Loop through each dataset and create a subplot\nfor i, (key, obs) in enumerate(datasets.items()):\n    ax = axes[i]  # Select subplot\n    obs=list(datasets.values())[i]\n    obs_lon=obs.lon\n    obs_lat=obs.lat\n    # Plot observed profile\n    ax.plot(obs['u'].mean('time_dim').squeeze(), obs.depth, label=\"Observed\", color='b')\n\n    # Extract nearest model data\n    u_sel = u.sel(lon=obs_lon.values, method='nearest').sel(lat=obs_lat.values, method='nearest')\n\n    # Plot modeled profile\n    ax.plot(u_sel.squeeze(), u.depth * (-1), label=\"Modeled\", color='r')\n\n    # Reverse y-axis\n    ax.invert_yaxis()\n\n    # Titles and labels\n    ax.set_title(f\"Station {i+1}\")\n    if i == 0:\n        ax.set_ylabel(\"Depth (m)\")\n    ax.set_xlabel(\"Velocity (m/s)\")\n    ax.legend()\n\nplt.tight_layout()\nplt.show()\n","key":"BVX0OTHCkE"},{"type":"outputs","id":"MoCKvtDOff-wAj3BD6Zhj","children":[{"type":"output","jupyter_data":{"ename":"NameError","evalue":"name 'u' is not defined","output_type":"error","traceback":"\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)\nCell \u001b[0;32mIn[54], line 16\u001b[0m\n\u001b[1;32m     13\u001b[0m ax\u001b[38;5;241m.\u001b[39mplot(obs[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mu\u001b[39m\u001b[38;5;124m'\u001b[39m]\u001b[38;5;241m.\u001b[39mmean(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mtime_dim\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39msqueeze(), obs\u001b[38;5;241m.\u001b[39mdepth, label\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mObserved\u001b[39m\u001b[38;5;124m\"\u001b[39m, color\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mb\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[1;32m     15\u001b[0m \u001b[38;5;66;03m# Extract nearest model data\u001b[39;00m\n\u001b[0;32m---> 16\u001b[0m u_sel \u001b[38;5;241m=\u001b[39m \u001b[43mu\u001b[49m\u001b[38;5;241m.\u001b[39msel(lon\u001b[38;5;241m=\u001b[39mobs_lon\u001b[38;5;241m.\u001b[39mvalues, method\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mnearest\u001b[39m\u001b[38;5;124m'\u001b[39m)\u001b[38;5;241m.\u001b[39msel(lat\u001b[38;5;241m=\u001b[39mobs_lat\u001b[38;5;241m.\u001b[39mvalues, method\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mnearest\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\u001b[1;32m     18\u001b[0m \u001b[38;5;66;03m# Plot modeled profile\u001b[39;00m\n\u001b[1;32m     19\u001b[0m ax\u001b[38;5;241m.\u001b[39mplot(u_sel\u001b[38;5;241m.\u001b[39msqueeze(), u\u001b[38;5;241m.\u001b[39mdepth \u001b[38;5;241m*\u001b[39m (\u001b[38;5;241m-\u001b[39m\u001b[38;5;241m1\u001b[39m), label\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mModeled\u001b[39m\u001b[38;5;124m\"\u001b[39m, color\u001b[38;5;241m=\u001b[39m\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mr\u001b[39m\u001b[38;5;124m'\u001b[39m)\n\n\u001b[0;31mNameError\u001b[0m: name 'u' is not defined"},"children":[],"key":"VK8mXUp1hM"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"285925d8593c7a674300d87fbe2c8afe","path":"/285925d8593c7a674300d87fbe2c8afe.png"},"text/plain":{"content":"<Figure size 2000x500 with 5 Axes>","content_type":"text/plain"}}},"children":[],"key":"lpjBM0qcRq"}],"key":"ArvPBaiiwk"}],"key":"d3AvbyrNrn"}],"key":"VDdx8uqeJM"},"references":{"cite":{"order":[],"data":{}}}}