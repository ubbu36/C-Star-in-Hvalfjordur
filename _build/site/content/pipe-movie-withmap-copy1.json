{"version":3,"kind":"Notebook","sha256":"b3100c74eadad06330c0569b6a707c4ce69d1406be5c1c8ed354a0050ce56747","slug":"pipe-movie-withmap-copy1","location":"/pipe_movie_withmap-Copy1.ipynb","dependencies":[],"frontmatter":{"kernelspec":{"name":"romstools-test","display_name":"Python (tomstools-test)","language":"python"},"exports":[{"format":"ipynb","filename":"pipe_movie_withmap-Copy1.ipynb","url":"/pipe_movie_withmap-C-5cd79fdd20d7b29f95270c95d3474ad9.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import xarray as xr\n#import celluloid\nfrom roms_tools import Grid, ROMSOutput\nfrom roms_regrid import *","key":"Iv5NfLuj6O"},{"type":"outputs","id":"hp4QzdzkoCk5E2e6Uj_U4","children":[],"key":"SWbUIyoXqo"}],"key":"WOg1iEyGCF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"grid=xr.open_dataset(\n    \"/home/x-uheede/S/Iceland3_MARBL_2024_60m/P_INPUT/Iceland3_grid_MAT.nc\")\n","key":"fiTpB7xBgw"},{"type":"outputs","id":"xjB7ZDPNmfvGZxUXH0hKR","children":[],"key":"fbZtwxFmmx"}],"key":"e6S2R65cjs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"path=[\n        \"/home/x-uheede/S/Iceland3_MARBL_2024_60m_CDR/Iceland3_MARBL_2024_bgc_dia.20240217020000.nc\",\n        \"/home/x-uheede/S/Iceland3_MARBL_2024_60m_CDR/Iceland3_MARBL_2024_bgc_dia.20240218020000.nc\",\n        \"/home/x-uheede/S/Iceland3_MARBL_2024_60m_CDR/Iceland3_MARBL_2024_bgc_dia.20240219020000.nc\",\n        \"/home/x-uheede/S/Iceland3_MARBL_2024_60m_CDR/Iceland3_MARBL_2024_bgc_dia.20240220020000.nc\",\n        \"/home/x-uheede/S/Iceland3_MARBL_2024_60m_CDR/Iceland3_MARBL_2024_bgc_dia.20240221020000.nc\",\n        \"/home/x-uheede/S/Iceland3_MARBL_2024_60m_CDR/Iceland3_MARBL_2024_bgc_dia.20240222020000.nc\",\n        \"/home/x-uheede/S/Iceland3_MARBL_2024_60m_CDR/Iceland3_MARBL_2024_bgc_dia.20240223020000.nc\",\n    ]","key":"xKkdX0XCGy"},{"type":"outputs","id":"FivcHztQAYter4tIJSkdj","children":[],"key":"cF7M9kwgBP"}],"key":"KZ5gMSOom4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"roms_bgc=xr.open_mfdataset(path, combine='nested', concat_dim=[\"time\"])","key":"jfPYX4c786"},{"type":"outputs","id":"vQeFLbAdnJaBHbgZkq_kl","children":[],"key":"NYJ8rUyKC2"}],"key":"g8VjzWvFUh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"grid = Grid.from_file(\n    \"/home/x-uheede/S/Iceland3_MARBL_2024_60m/P_INPUT/Iceland3_grid_MAT.nc\"\n)","key":"vsGRCeI0fT"},{"type":"outputs","id":"a89Zk8txnF8QXmK2vJMgC","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-19 12:38:39 - WARNING - Vertical coordinates (Cs_r, Cs_w) not found in grid file.\n2025-11-19 12:38:39 - INFO - === Preparing the vertical coordinate system using N = 100, theta_s = 5.0, theta_b = 2.0, hc = 300.0 ===\n2025-11-19 12:38:39 - INFO - Total time: 0.003 seconds\n2025-11-19 12:38:39 - INFO - ================================================================================================\n"},"children":[],"key":"cgLjXehxXI"}],"key":"jgFAlSd78a"}],"key":"r3x1r8N1Ti"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"grid.update_vertical_coordinate(N=60, theta_s=5.0, theta_b=2.0, hc=300.0, verbose=False)","key":"kmcoNlPsE2"},{"type":"outputs","id":"hazBdLGUbkblBSK3hbged","children":[],"key":"bwu87O9b2m"}],"key":"Wo8nxioh9Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"roms_output = ROMSOutput(\n    grid=grid,\n    path=path,\n    use_dask=True,\n)\nds_regridded = roms_output.regrid()","key":"LMUorUyO39"},{"type":"outputs","id":"5GAALOiu2SkQD5qbrTTbr","children":[],"key":"gvj2XpBjgG"}],"key":"vJxmsbUCNZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ds_regridded.load()","key":"E0MUIxOoDn"},{"type":"outputs","id":"mY9OCfgnuVKVTlFoVqD8V","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"c7f94c90fb4ade354bc26ede2a5cdd41","path":"/c7f94c90fb4ade354bc26ede2a5cdd41.html"},"text/plain":{"content":"<xarray.Dataset> Size: 8GB\nDimensions:           (time: 168, lat: 965, lon: 1929)\nCoordinates:\n  * time              (time) datetime64[ns] 1kB 2024-02-17T02:00:00 ... 2024-...\n  * lat               (lat) float32 4kB 64.0 64.0 64.0 64.0 ... 65.0 65.0 65.0\n  * lon               (lon) float32 8kB 337.0 337.0 337.0 ... 339.0 339.0 339.0\nData variables:\n    pCO2SURF          (time, lat, lon) float32 1GB nan nan nan ... nan nan nan\n    FG_CO2            (time, lat, lon) float32 1GB nan nan nan ... nan nan nan\n    PH                (time, lat, lon) float32 1GB nan nan nan ... nan nan nan\n    pCO2SURF_ALT_CO2  (time, lat, lon) float32 1GB nan nan nan ... nan nan nan\n    FG_ALT_CO2        (time, lat, lon) float32 1GB nan nan nan ... nan nan nan\n    PH_ALT_CO2        (time, lat, lon) float32 1GB nan nan nan ... nan nan nan\nAttributes: (12/44)\n    global_x:           640\n    global_y:           384\n    title:              Iceland3_MARBL_2024 , 50 m  resolution\n    grid_file:          /anvil/scratch/x-uheede/Iceland3_MARBL_2024_60m/P_INP...\n    forcing_files:       /anvil/scratch/x-uheede/Iceland3_MARBL_2024_60m/P_IN...\n    forcing_info:       \n    ...                 ...\n    tide_options:       OFF\n    river_frc_options:  OFF\n    pipe_frc_options:   OFF\n    particle_options:   OFF\n    git_version:        \n    regrid_method:      bilinear","content_type":"text/plain"}}},"children":[],"key":"s8NAAP53IX"}],"key":"lDRYnPZpTc"}],"key":"LUgKJ2nOH4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib import pyplot as plt\nplt.contourf(ds_regridded.lon,ds_regridded.lat,ds_regridded['PH'].isel(time=2))","key":"LkGxQdyQe2"},{"type":"outputs","id":"BTO-iLweGHRSxhRRHLNsx","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f5186e772f372024fece9fa8b8a5c214","path":"/f5186e772f372024fece9fa8b8a5c214.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"D4aPopczEM"}],"key":"YGGqPjkDdg"}],"key":"NWW79DOpfp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mask_regrid=roms_regrid(grid,grid['mask_rho'])","key":"jZQ1zYMFKc"},{"type":"outputs","id":"VKHkrHlLlMVitPWmLETgf","children":[],"key":"SkOV42LjbV"}],"key":"LENmlOJBZQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ph_regrid=roms_regrid(grid,roms_bgc['PH'])","key":"tTLeg2xR0u"},{"type":"outputs","id":"fCH2wOYH36WflccSsozFC","children":[],"key":"KOcfDSQKS7"}],"key":"XOcMLYt2FR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ph_anom_regrid=roms_regrid(grid,(roms_bgc['PH']-roms_bgc['PH_ALT_CO2']))","key":"dNaMC5u4su"},{"type":"outputs","id":"0LMV7StKHzntFHAm5BXgP","children":[],"key":"kExJuvpx9Q"}],"key":"ALaPl6ymD3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mask_regrid.load()","key":"GgVUVK5v7j"},{"type":"outputs","id":"MTa6p8-3GtGyaqK9jmbWY","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (lat: 642, lon: 386)&gt; Size: 2MB\narray([[0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 1., ..., 0., 0., 0.],\n       [0., 0., 1., ..., 0., 0., 0.],\n       ...,\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.]], shape=(642, 386))\nCoordinates:\n  * lon      (lon) float64 3kB 338.0 338.0 338.0 338.0 ... 338.6 338.7 338.7\n  * lat      (lat) float64 5kB 64.24 64.24 64.24 64.24 ... 64.41 64.41 64.41\nAttributes:\n    regrid_method:  bilinear</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 642</li><li><span class='xr-has-index'>lon</span>: 386</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-fa4bf03b-b153-4896-9f51-f6e40dca6e8c' class='xr-array-in' type='checkbox' checked><label for='section-fa4bf03b-b153-4896-9f51-f6e40dca6e8c' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0</span></div><div class='xr-array-data'><pre>array([[0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 1., ..., 0., 0., 0.],\n       [0., 0., 1., ..., 0., 0., 0.],\n       ...,\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.]], shape=(642, 386))</pre></div></div></li><li class='xr-section-item'><input id='section-b5e4cf96-06df-4129-83d7-d3f0a56f2cc9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b5e4cf96-06df-4129-83d7-d3f0a56f2cc9' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>338.0 338.0 338.0 ... 338.7 338.7</div><input id='attrs-6cee0709-52a9-494e-a8f2-6a5d271d05ab' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6cee0709-52a9-494e-a8f2-6a5d271d05ab' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a972b7d3-bc84-4cb0-bdd4-a2591b83c0f9' class='xr-var-data-in' type='checkbox'><label for='data-a972b7d3-bc84-4cb0-bdd4-a2591b83c0f9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([337.986343, 337.988072, 337.989801, ..., 338.64847 , 338.650199,\n       338.651928], shape=(386,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>64.24 64.24 64.24 ... 64.41 64.41</div><input id='attrs-207d445b-7b6e-41c0-b51f-5f963ecaf323' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-207d445b-7b6e-41c0-b51f-5f963ecaf323' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-52cb4292-1004-4153-a832-9938e8ebdad3' class='xr-var-data-in' type='checkbox'><label for='data-52cb4292-1004-4153-a832-9938e8ebdad3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([64.238069, 64.238339, 64.238609, ..., 64.410745, 64.411015, 64.411285],\n      shape=(642,))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-2bf9f782-88b3-4b5f-9094-ea39c41170ec' class='xr-section-summary-in' type='checkbox'  ><label for='section-2bf9f782-88b3-4b5f-9094-ea39c41170ec' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-687a2995-c165-4486-8e56-2cf540a7edb5' class='xr-index-data-in' type='checkbox'/><label for='index-687a2995-c165-4486-8e56-2cf540a7edb5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([337.98634316612345, 337.98807195800885, 337.98980074989424,\n       337.99152954177964, 337.99325833366504, 337.99498712555044,\n       337.99671591743584, 337.99844470932123, 338.00017350120663,\n       338.00190229309203,\n       ...\n       338.63636891503313, 338.63809770691853,  338.6398264988039,\n        338.6415552906893,  338.6432840825747,  338.6450128744601,\n        338.6467416663455,  338.6484704582309,  338.6501992501163,\n        338.6519280420017],\n      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=386))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-19f12c3e-10f7-4a22-b4c4-dd9afccc44fc' class='xr-index-data-in' type='checkbox'/><label for='index-19f12c3e-10f7-4a22-b4c4-dd9afccc44fc' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([64.23806880220515,  64.2383390305369, 64.23860925886866,\n       64.23887948720042, 64.23914971553218, 64.23941994386394,\n        64.2396901721957, 64.23996040052745, 64.24023062885921,\n       64.24050085719097,\n       ...\n       64.40885310787588, 64.40912333620764,  64.4093935645394,\n       64.40966379287116, 64.40993402120291, 64.41020424953467,\n       64.41047447786643, 64.41074470619819, 64.41101493452994,\n        64.4112851628617],\n      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=642))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c8e77a62-6ffe-42e7-9466-cc4a5c991aec' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c8e77a62-6ffe-42e7-9466-cc4a5c991aec' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>regrid_method :</span></dt><dd>bilinear</dd></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray (lat: 642, lon: 386)> Size: 2MB\narray([[0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 1., ..., 0., 0., 0.],\n       [0., 0., 1., ..., 0., 0., 0.],\n       ...,\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.],\n       [0., 0., 0., ..., 0., 0., 0.]], shape=(642, 386))\nCoordinates:\n  * lon      (lon) float64 3kB 338.0 338.0 338.0 338.0 ... 338.6 338.7 338.7\n  * lat      (lat) float64 5kB 64.24 64.24 64.24 64.24 ... 64.41 64.41 64.41\nAttributes:\n    regrid_method:  bilinear","content_type":"text/plain"}}},"children":[],"key":"B54Zolsq2S"}],"key":"zFnqIwfpNe"}],"key":"QlJD1B63zt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ph_regrid.load()","key":"K3thjeh4Wq"},{"type":"outputs","id":"WGd99T-yZrapXn1hhM15a","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (time: 168, lat: 642, lon: 386)&gt; Size: 167MB\narray([[[0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        ...,\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ]],\n\n       [[0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 4.837577 , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 8.142684 , ..., 0.       , 0.       ,\n         0.       ],\n...\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ]],\n\n       [[0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 4.838207 , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 8.143711 , ..., 0.       , 0.       ,\n         0.       ],\n        ...,\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ]]], shape=(168, 642, 386), dtype=float32)\nCoordinates:\n  * lon      (lon) float64 3kB 338.0 338.0 338.0 338.0 ... 338.6 338.7 338.7\n  * lat      (lat) float64 5kB 64.24 64.24 64.24 64.24 ... 64.41 64.41 64.41\nDimensions without coordinates: time\nAttributes:\n    regrid_method:  bilinear</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span>time</span>: 168</li><li><span class='xr-has-index'>lat</span>: 642</li><li><span class='xr-has-index'>lon</span>: 386</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-263acf3a-e3a7-4e29-b1c3-f37bc775fbab' class='xr-array-in' type='checkbox' checked><label for='section-263acf3a-e3a7-4e29-b1c3-f37bc775fbab' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0</span></div><div class='xr-array-data'><pre>array([[[0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        ...,\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ]],\n\n       [[0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 4.837577 , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 8.142684 , ..., 0.       , 0.       ,\n         0.       ],\n...\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ]],\n\n       [[0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 4.838207 , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 8.143711 , ..., 0.       , 0.       ,\n         0.       ],\n        ...,\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ]]], shape=(168, 642, 386), dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-dfdac83d-408b-4f29-a3a5-3b2ebb04df43' class='xr-section-summary-in' type='checkbox'  checked><label for='section-dfdac83d-408b-4f29-a3a5-3b2ebb04df43' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>338.0 338.0 338.0 ... 338.7 338.7</div><input id='attrs-28017886-1881-47ab-848e-629d83d3b6f3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-28017886-1881-47ab-848e-629d83d3b6f3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fd292789-caa7-4ba0-80d8-7f1976f86444' class='xr-var-data-in' type='checkbox'><label for='data-fd292789-caa7-4ba0-80d8-7f1976f86444' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([337.986343, 337.988072, 337.989801, ..., 338.64847 , 338.650199,\n       338.651928], shape=(386,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>64.24 64.24 64.24 ... 64.41 64.41</div><input id='attrs-09303bf8-45e9-4cbc-adc8-36006eb071ee' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-09303bf8-45e9-4cbc-adc8-36006eb071ee' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7520e5db-a355-4827-8c5d-cda82659f406' class='xr-var-data-in' type='checkbox'><label for='data-7520e5db-a355-4827-8c5d-cda82659f406' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([64.238069, 64.238339, 64.238609, ..., 64.410745, 64.411015, 64.411285],\n      shape=(642,))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-cf9f01ca-01d9-4afb-89fe-d204883165af' class='xr-section-summary-in' type='checkbox'  ><label for='section-cf9f01ca-01d9-4afb-89fe-d204883165af' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-fcdadb0d-b597-4f5b-abab-9651c2b36984' class='xr-index-data-in' type='checkbox'/><label for='index-fcdadb0d-b597-4f5b-abab-9651c2b36984' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([337.98634316612345, 337.98807195800885, 337.98980074989424,\n       337.99152954177964, 337.99325833366504, 337.99498712555044,\n       337.99671591743584, 337.99844470932123, 338.00017350120663,\n       338.00190229309203,\n       ...\n       338.63636891503313, 338.63809770691853,  338.6398264988039,\n        338.6415552906893,  338.6432840825747,  338.6450128744601,\n        338.6467416663455,  338.6484704582309,  338.6501992501163,\n        338.6519280420017],\n      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=386))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-33206f83-e7b4-457b-bbee-b757a34d2350' class='xr-index-data-in' type='checkbox'/><label for='index-33206f83-e7b4-457b-bbee-b757a34d2350' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([64.23806880220515,  64.2383390305369, 64.23860925886866,\n       64.23887948720042, 64.23914971553218, 64.23941994386394,\n        64.2396901721957, 64.23996040052745, 64.24023062885921,\n       64.24050085719097,\n       ...\n       64.40885310787588, 64.40912333620764,  64.4093935645394,\n       64.40966379287116, 64.40993402120291, 64.41020424953467,\n       64.41047447786643, 64.41074470619819, 64.41101493452994,\n        64.4112851628617],\n      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=642))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3ab677e8-bd09-47a1-aa32-3c21e2e9bb38' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3ab677e8-bd09-47a1-aa32-3c21e2e9bb38' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>regrid_method :</span></dt><dd>bilinear</dd></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray (time: 168, lat: 642, lon: 386)> Size: 167MB\narray([[[0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        ...,\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ]],\n\n       [[0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 4.837577 , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 8.142684 , ..., 0.       , 0.       ,\n         0.       ],\n...\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ]],\n\n       [[0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 4.838207 , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 8.143711 , ..., 0.       , 0.       ,\n         0.       ],\n        ...,\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ],\n        [0.       , 0.       , 0.       , ..., 0.       , 0.       ,\n         0.       ]]], shape=(168, 642, 386), dtype=float32)\nCoordinates:\n  * lon      (lon) float64 3kB 338.0 338.0 338.0 338.0 ... 338.6 338.7 338.7\n  * lat      (lat) float64 5kB 64.24 64.24 64.24 64.24 ... 64.41 64.41 64.41\nDimensions without coordinates: time\nAttributes:\n    regrid_method:  bilinear","content_type":"text/plain"}}},"children":[],"key":"l6AP3FGeUQ"}],"key":"nCoiWMYbRV"}],"key":"lf0dyQgEbH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ph_anom_regrid.load()","key":"ICbYZ95F38"},{"type":"outputs","id":"RlxUFgvDnAinBbo6WXyvB","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":15,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (time: 168, lat: 642, lon: 386)&gt; Size: 167MB\narray([[[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n...\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]]],\n      shape=(168, 642, 386), dtype=float32)\nCoordinates:\n  * lon      (lon) float64 3kB 338.0 338.0 338.0 338.0 ... 338.6 338.7 338.7\n  * lat      (lat) float64 5kB 64.24 64.24 64.24 64.24 ... 64.41 64.41 64.41\nDimensions without coordinates: time\nAttributes:\n    regrid_method:  bilinear</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span>time</span>: 168</li><li><span class='xr-has-index'>lat</span>: 642</li><li><span class='xr-has-index'>lon</span>: 386</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-3c395ce5-bbd4-4ff0-9624-0b706b7dafcd' class='xr-array-in' type='checkbox' checked><label for='section-3c395ce5-bbd4-4ff0-9624-0b706b7dafcd' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0</span></div><div class='xr-array-data'><pre>array([[[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n...\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]]],\n      shape=(168, 642, 386), dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-315f668c-44db-4f84-9dc1-1a85eaab8c48' class='xr-section-summary-in' type='checkbox'  checked><label for='section-315f668c-44db-4f84-9dc1-1a85eaab8c48' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>338.0 338.0 338.0 ... 338.7 338.7</div><input id='attrs-b942a8db-e6bf-422e-b678-f5793fc19ea8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b942a8db-e6bf-422e-b678-f5793fc19ea8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2793ac2b-f56d-48cb-b530-e6632816b1ce' class='xr-var-data-in' type='checkbox'><label for='data-2793ac2b-f56d-48cb-b530-e6632816b1ce' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([337.986343, 337.988072, 337.989801, ..., 338.64847 , 338.650199,\n       338.651928], shape=(386,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>64.24 64.24 64.24 ... 64.41 64.41</div><input id='attrs-835d234d-8982-4133-8dff-3c212220e3e7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-835d234d-8982-4133-8dff-3c212220e3e7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0955ec70-4229-49eb-a3aa-7436b21791ca' class='xr-var-data-in' type='checkbox'><label for='data-0955ec70-4229-49eb-a3aa-7436b21791ca' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([64.238069, 64.238339, 64.238609, ..., 64.410745, 64.411015, 64.411285],\n      shape=(642,))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8e9de7e9-8c5a-47fe-828e-3cb907073683' class='xr-section-summary-in' type='checkbox'  ><label for='section-8e9de7e9-8c5a-47fe-828e-3cb907073683' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-12a00832-6644-4e0d-b799-481bb8121533' class='xr-index-data-in' type='checkbox'/><label for='index-12a00832-6644-4e0d-b799-481bb8121533' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([337.98634316612345, 337.98807195800885, 337.98980074989424,\n       337.99152954177964, 337.99325833366504, 337.99498712555044,\n       337.99671591743584, 337.99844470932123, 338.00017350120663,\n       338.00190229309203,\n       ...\n       338.63636891503313, 338.63809770691853,  338.6398264988039,\n        338.6415552906893,  338.6432840825747,  338.6450128744601,\n        338.6467416663455,  338.6484704582309,  338.6501992501163,\n        338.6519280420017],\n      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=386))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-68e63038-71e1-4913-8157-58b6d48f7260' class='xr-index-data-in' type='checkbox'/><label for='index-68e63038-71e1-4913-8157-58b6d48f7260' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([64.23806880220515,  64.2383390305369, 64.23860925886866,\n       64.23887948720042, 64.23914971553218, 64.23941994386394,\n        64.2396901721957, 64.23996040052745, 64.24023062885921,\n       64.24050085719097,\n       ...\n       64.40885310787588, 64.40912333620764,  64.4093935645394,\n       64.40966379287116, 64.40993402120291, 64.41020424953467,\n       64.41047447786643, 64.41074470619819, 64.41101493452994,\n        64.4112851628617],\n      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=642))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a2498cb5-cce9-45c1-b748-87e9956c6766' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a2498cb5-cce9-45c1-b748-87e9956c6766' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>regrid_method :</span></dt><dd>bilinear</dd></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray (time: 168, lat: 642, lon: 386)> Size: 167MB\narray([[[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n...\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]]],\n      shape=(168, 642, 386), dtype=float32)\nCoordinates:\n  * lon      (lon) float64 3kB 338.0 338.0 338.0 338.0 ... 338.6 338.7 338.7\n  * lat      (lat) float64 5kB 64.24 64.24 64.24 64.24 ... 64.41 64.41 64.41\nDimensions without coordinates: time\nAttributes:\n    regrid_method:  bilinear","content_type":"text/plain"}}},"children":[],"key":"RBvTQ6sjd0"}],"key":"UhSpoVaRP6"}],"key":"ruKXAgtCPP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import cartopy.io.img_tiles as cimgt\nimport cartopy.crs as ccrs\nrequest = cimgt.OSM()\nextent = [-21.6, -21.35, 64.325, 64.42]\n\nfrom matplotlib import pyplot as plt\nfrom celluloid import Camera\nimport numpy as np\nfrom IPython.display import HTML\n\nfig, ax = plt.subplots(figsize=(7,7),subplot_kw={'projection': ccrs.Mercator()},layout='tight')\ncamera = Camera(fig)\nax = plt.axes(projection=request.crs)\nax.set_extent(extent)\n\nax.add_image(request, 12)\nk1=7.9\nk2=8.5\nk3=0.05\nlevels=np.arange(k1, k2, k3)\n   \n\nlevels2=np.arange(0, 10, 1)\n\nfor i in range(167):\n    \n    ax.text(0.8, 0.999, 't='+str(i+1)+' hours', transform=ax.transAxes)\n\n    cf2=plt.contourf(ph_regrid.lon,ph_regrid.lat,mask_regrid.where(mask_regrid!=0),levels2, cmap='Greys', transform=ccrs.PlateCarree())\n    \n    cf1=plt.contourf(ph_regrid.lon,ph_regrid.lat,ph_regrid[i,:,:],levels, vmin=7.9, vmax=8.5,transform=ccrs.PlateCarree())\n\n    \n    camera.snap()\n\n    plt.title('fixed point source 96 hr release')\n    \nax.scatter(-21.465, 64.396, color=\"black\", marker=\"v\", transform=ccrs.PlateCarree(),label= \"release point\")\ngls=ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=True,\n                    color='darkgray', alpha=0.5, linestyle='--')\ngls.top_labels=False   # suppress top labels\ngls.right_labels=False # suppress right labels\n\nax.set_extent([-21.6, -21.35, 64.325, 64.42], ccrs.PlateCarree())\nax.legend()\ncb1 = plt.colorbar(cf1,shrink=0.3)\ncb1.set_label('pH', fontsize=10)\n\nanimation = camera.animate()\nHTML(animation.to_html5_video())","key":"v9rWy6aUdG"},{"type":"outputs","id":"T2fVYdVyi_yk9ecfKo-7O","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-14 15:42:37 - INFO - Animation.save using <class 'matplotlib.animation.FFMpegWriter'>\n2025-11-14 15:42:37 - INFO - MovieWriter._run: running command: ffmpeg -f rawvideo -vcodec rawvideo -s 700x700 -pix_fmt rgba -framerate 5.0 -loglevel error -i pipe: -vcodec h264 -pix_fmt yuv420p -y /tmp/tmpijkfgvfx/temp.m4v\n"},"children":[],"key":"d3lYsGoGGc"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"d48f1cd06a8ce652f1a5cbc3a63b4600","path":"/d48f1cd06a8ce652f1a5cbc3a63b4600.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},"children":[],"key":"e0D86dEAEh"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"db4788228f6401e614ce853fdff4a506","path":"/db4788228f6401e614ce853fdff4a506.png"},"text/plain":{"content":"<Figure size 700x700 with 3 Axes>","content_type":"text/plain"}}},"children":[],"key":"cy0HgDDSom"}],"key":"V5kRyYZjJJ"}],"key":"CwMbssMmK8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"animation.save(\"96_hr_30IBC_pH_withmap.mp4\")","key":"Iy5c0N0phD"},{"type":"outputs","id":"TwuVeq8tEJURVMXCYav5U","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-14 15:50:51 - INFO - Animation.save using <class 'matplotlib.animation.FFMpegWriter'>\n2025-11-14 15:50:51 - INFO - MovieWriter._run: running command: ffmpeg -f rawvideo -vcodec rawvideo -s 700x700 -pix_fmt rgba -framerate 5.0 -loglevel error -i pipe: -vcodec h264 -pix_fmt yuv420p -y 96_hr_30IBC_pH_withmap.mp4\n"},"children":[],"key":"CR8d8aiRcz"}],"key":"ELqZjXBadT"}],"key":"JywUnDCxwm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dye1_alk4_rg.shape","key":"Li7zSf5OU9"},{"type":"outputs","id":"XLLZvliWVqfQmztnIdIqF","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"(168, 1442, 722)","content_type":"text/plain"}}},"children":[],"key":"M0CkkjqkW0"}],"key":"hdyK8KzV3T"}],"key":"HB46Eyezcv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import cartopy.io.img_tiles as cimgt\nimport cartopy.crs as ccrs\nrequest = cimgt.OSM()\nextent = [-21.6, -21.35, 64.325, 64.42]\n\nfrom matplotlib import pyplot as plt\nfrom celluloid import Camera\nimport numpy as np\nfrom IPython.display import HTML\n\nfig, ax = plt.subplots(figsize=(7,7),subplot_kw={'projection': ccrs.Mercator()},layout='tight')\ncamera = Camera(fig)\nax = plt.axes(projection=request.crs)\nax.set_extent(extent)\n\nax.add_image(request, 12)\nk1=-0.1\nk2=1.5\nk3=0.05\nlevels=np.arange(k1, k2, k3)\n   \n\nlevels2=np.arange(0, 10, 1)\n\nfor i in range(167):\n    \n    ax.text(0.8, 0.999, 't='+str(i+1)+' hours', transform=ax.transAxes)\n\n    cf2=plt.contourf(ph_regrid.lon,ph_regrid.lat,mask_regrid.where(mask_regrid!=0),levels2, cmap='Greys', transform=ccrs.PlateCarree())\n    \n    cf1=plt.contourf(ph_regrid.lon,ph_regrid.lat,ph_anom_regrid[i,:,:],levels, vmin=-0.5, vmax=1.5,transform=ccrs.PlateCarree())\n\n    \n    camera.snap()\n\n    plt.title('fixed point source 96 hr release')\n    \nax.scatter(-21.465, 64.396, color=\"black\", marker=\"v\", transform=ccrs.PlateCarree(),label= \"release point\")\ngls=ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=True,\n                    color='darkgray', alpha=0.5, linestyle='--')\ngls.top_labels=False   # suppress top labels\ngls.right_labels=False # suppress right labels\n\nax.set_extent([-21.6, -21.35, 64.325, 64.42], ccrs.PlateCarree())\nax.legend()\ncb1 = plt.colorbar(cf1,shrink=0.3)\ncb1.set_label('pH', fontsize=10)\n\nanimation = camera.animate()\nHTML(animation.to_html5_video())","key":"ZJ8WySnMcZ"},{"type":"outputs","id":"rIr-ZuVMI5pa-mpsCgzAa","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"2025-11-14 16:15:32 - INFO - Animation.save using <class 'matplotlib.animation.FFMpegWriter'>\n2025-11-14 16:15:32 - INFO - MovieWriter._run: running command: ffmpeg -f rawvideo -vcodec rawvideo -s 700x700 -pix_fmt rgba -framerate 5.0 -loglevel error -i pipe: -vcodec h264 -pix_fmt yuv420p -y /tmp/tmpgekcdudb/temp.m4v\n"},"children":[],"key":"XwiXSrtgEd"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"a9f769b7b5dc3b7b14f7ca68f301a33c","path":"/a9f769b7b5dc3b7b14f7ca68f301a33c.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},"children":[],"key":"iYXfSq23mu"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5e80a4e5209a2545a44b505f21aae306","path":"/5e80a4e5209a2545a44b505f21aae306.png"},"text/plain":{"content":"<Figure size 700x700 with 3 Axes>","content_type":"text/plain"}}},"children":[],"key":"mR9JOM0vJh"}],"key":"mRJgS6esNy"}],"key":"TcwgQphfyr"}],"key":"lyj7HaGwcu"},"references":{"cite":{"order":[],"data":{}}}}