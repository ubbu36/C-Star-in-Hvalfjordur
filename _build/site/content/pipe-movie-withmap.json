{"version":3,"kind":"Notebook","sha256":"515c2a995cdd449016a28943551a50c83f127f7c9a084841cb71d78e9db43805","slug":"pipe-movie-withmap","location":"/pipe_movie_withmap.ipynb","dependencies":[],"frontmatter":{"kernelspec":{"name":"mypackages","display_name":"Python (My mypackages Kernel)","language":"python"},"exports":[{"format":"ipynb","filename":"pipe_movie_withmap.ipynb","url":"/pipe_movie_withmap-620b752d3c0a21b361ab246a29d9eca2.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import subprocess\nimport os\n\nimport netCDF4\nimport numpy as np\nimport glob\nimport time\nimport matplotlib.pyplot as plt\nimport copy\nimport xarray as xr\nfrom datetime import datetime, timedelta \nfrom roms_regrid import *\nfrom celluloid import Camera \nimport cartopy.crs as ccrs\nimport seawater as sw","key":"TntGMONx72"},{"type":"outputs","id":"4RJ_otZ_B20iChGXnWdFz","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/tmp/ipykernel_1041112/1143814594.py:15: UserWarning: The seawater library is deprecated! Please use gsw instead.\n  import seawater as sw\n"},"children":[],"key":"J5In3Tk0Bs"}],"key":"kaPpPa0ekz"}],"key":"rlFgbCulj6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"grid=xr.open_dataset('/global/cfs/cdirs/m4632/uheede/work/Iceland4_BGC/INPUT/Iceland4_grd.nc')\ngrid_pr=grid\nh=grid['h'].values\nmask_rho=grid['mask_rho'].values\npm=grid['pm'].values\npn=grid['pn'].values","key":"zCghfx5WOV"},{"type":"outputs","id":"cXafqiiC1Z-JualgnVdXh","children":[],"key":"mEtK0aRN3B"}],"key":"i25jzBuITg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"grid['h']","key":"sQTEPxet9G"},{"type":"outputs","id":"h2cvltatT1DDQjh8A38hw","children":[],"key":"OzjDZY4mDG"}],"key":"t1ucF2X9X1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x1=xr.open_mfdataset('/pscratch/sd/u/uheede/Iceland4_noBGC_pip_pt_FLOW/Iceland4_noBGC_FLOW_rnd.201206[2-3][1-9]??0000.nc', combine='nested', concat_dim=[\"time\"])\n#x2=xr.open_mfdataset('/pscratch/sd/u/uheede/Iceland4_noBGC_pip_pt_ens1/Iceland4_noBGC_ens1_rnd.201206*.nc', combine='nested', concat_dim=[\"time\"])\n#x3=xr.open_mfdataset('/pscratch/sd/u/uheede/Iceland4_noBGC_pip_pt_ens2/Iceland4_noBGC_ens2_rnd.2012062[1-6]*.nc', combine='nested', concat_dim=[\"time\"])\n\n","key":"fHftazvqA3"},{"type":"outputs","id":"F_hgIRKtCqqhTb1MlFlru","children":[],"key":"P9TftIXuge"}],"key":"XWHS7xfleM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"mask_regrid=roms_regrid(grid,grid['mask_rho'])\n","key":"f6loIwBdL5"},{"type":"outputs","id":"eOFxxHbR5nbx8X1P5LqIQ","children":[],"key":"dTpZpzmyw2"}],"key":"dhiIHfJmHK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"## calculating depth of each cell\nmask_rho=grid['mask_rho'].values\nh=grid['h'].values\n# Sigma coordinate parameters\nN = 100\ntheta_s = 5\ntheta_b = 2\nhc = 300\n\nk_w = np.linspace(0,N,N+1)\nk_r = np.linspace(1,N,N)\n\nsigma_w = (k_w - N) / N\nsigma_r = (k_r - N - 0.5) / N\n\n# Assuming that theta_s and theta_b are both > 0\n# https://www.myroms.org/wiki/Vertical_S-coordinate\n\ndef Cs(sigma, theta_s, theta_b):\n    C = ( 1 - np.cosh(theta_s * sigma) ) / (np.cosh(theta_s) - 1)\n    C = (np.exp(theta_b * C) - 1) / (1 - np.exp(-theta_b))\n    return C\n\nCs_w = Cs(sigma_w, theta_s, theta_b)\nCs_r = Cs(sigma_r, theta_s, theta_b)\n\nS_w = np.zeros((N+1, h.shape[0], h.shape[1]))\nS_r = np.zeros((N, h.shape[0], h.shape[1]))\nfor i in range(h.shape[0]):\n    for j in range(h.shape[1]):\n        if mask_rho[i,j]:\n            S_w[:,i,j] = (hc * sigma_w + h[i,j]*Cs_w) / (hc + h[i,j])\n            S_r[:,i,j] = (hc * sigma_r + h[i,j]*Cs_r) / (hc + h[i,j])\n\n# zeta is the sea surface height at any given time, here I am using an arbitrary zeta\n\nzeta1=x1['zeta'].isel(time=95).load().values\n\nz_w1 = np.zeros((N+1, h.shape[0], h.shape[1]))\nz_r1 = np.zeros((N, h.shape[0], h.shape[1]))\n\n#zeta2=x2['zeta'].isel(time=48).load().values\n\n#z_w2 = np.zeros((N+1, h.shape[0], h.shape[1]))\n#z_r2 = np.zeros((N, h.shape[0], h.shape[1]))\n\n#zeta3=x3['zeta'].isel(time=48).load().values\n\n#z_w3 = np.zeros((N+1, h.shape[0], h.shape[1]))\n#z_r3 = np.zeros((N, h.shape[0], h.shape[1]))\n\nfor i in range(h.shape[0]):\n    for j in range(h.shape[1]):\n        if mask_rho[i,j]:\n            z_w1[:,i,j] = zeta1[i,j] + (zeta1[i,j] + h[i,j])*S_w[:,i,j]\n            z_r1[:,i,j] = zeta1[i,j] + (zeta1[i,j] + h[i,j])*S_r[:,i,j]\n            #z_w2[:,i,j] = zeta2[i,j] + (zeta2[i,j] + h[i,j])*S_w[:,i,j]\n            #z_r2[:,i,j] = zeta2[i,j] + (zeta2[i,j] + h[i,j])*S_r[:,i,j]\n            #z_w3[:,i,j] = zeta3[i,j] + (zeta3[i,j] + h[i,j])*S_w[:,i,j]\n            #z_r3[:,i,j] = zeta3[i,j] + (zeta3[i,j] + h[i,j])*S_r[:,i,j]\ncell_depths1 = np.zeros((N, h.shape[0], h.shape[1]))\n#cell_depths2 = np.zeros((N, h.shape[0], h.shape[1]))\n#cell_depths3 = np.zeros((N, h.shape[0], h.shape[1]))\n\n\nfor k in np.arange(1,101):\n    cell_depths1[k-1,:,:]=z_w1[k,:,:]-z_w1[k-1,:,:]\n    #cell_depths2[k-1,:,:]=z_w2[k,:,:]-z_w2[k-1,:,:]\n    #cell_depths3[k-1,:,:]=z_w3[k,:,:]-z_w3[k-1,:,:]\n    ","key":"XFSB41zq5L"},{"type":"outputs","id":"jZvNo8orKmE2rbS5Vfjjr","children":[],"key":"Ww1gmWrhJ0"}],"key":"XZ9w6nE4P8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dye1_3d=x1['dye'].isel(time=95).load()\n\n\nmass1=dye1_3d*1/pn*1/pm*cell_depths1\n#mass2=dye2_3d*1/pn*1/pm*cell_depths2\n#mass3=dye3_3d*1/pn*1/pm*cell_depths3\n\ntotal1=np.sum(mass1.load()) #m3\n#total2=np.sum(mass2.load()) #m3\n#total3=np.sum(mass3.load()) #m3\n\nNaOH_test1=9.975*10**3*1000*20 #(mol/L)*1000 (mmol/mol)*1000(L/IBC)*20(IBC)=mmol\nNaOH_test2=9.975*10**3*1000*10\nNaOH_test3=9.975*10**3*1000*5\nNaOH_test4=9.975*10**3*1000*30\n\nalk1_scalar1=NaOH_test1*(1/total1) #mmol/m3\nalk1_scalar2=NaOH_test2*(1/total1)\nalk1_scalar3=NaOH_test3*(1/total1)\nalk1_scalar4=NaOH_test4*(1/total1)\n\n#alk2_scalar1=NaOH_test1*(1/total2) #mmol/m3\n#alk2_scalar2=NaOH_test2*(1/total2)\n#alk2_scalar3=NaOH_test3*(1/total2)\n#alk2_scalar4=NaOH_test4*(1/total2)\n\n#alk3_scalar1=NaOH_test1*(1/total3) #mmol/m3\n#alk3_scalar2=NaOH_test2*(1/total3)\n#alk3_scalar3=NaOH_test3*(1/total3)\n#alk3_scalar4=NaOH_test4*(1/total3)","key":"z5T66EoM7b"},{"type":"outputs","id":"jUAWNsUn9JdluIbMNd6bR","children":[],"key":"yVGs2XnLkl"}],"key":"h9xTWfdnaO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dye1_alk1=x1['dye']*alk1_scalar1\ndye1_alk2=x1['dye']*alk1_scalar2\ndye1_alk3=x1['dye']*alk1_scalar3\ndye1_alk4=x1['dye']*alk1_scalar4\n","key":"jjvT206kgp"},{"type":"outputs","id":"JRR3h4-bHWnZRlLlav1uC","children":[],"key":"AYOYUlrmdp"}],"key":"mTABkMeGyo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dye_alk_surf=dye1_alk4.isel(s_rho=99)\ndye1_alk4_rg=roms_regrid(grid,dye_alk_surf)","key":"SWk2Pl5e4B"},{"type":"outputs","id":"wZurMJFiVJTDe5ub94ab_","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/xarray/core/computation.py:307: PerformanceWarning: Regridding is increasing the number of chunks by a factor of 30.0, you might want to specify sizes in `output_chunks` in the regridder call. Default behaviour is to preserve the chunk sizes from the input (145, 289).\n  result_var = func(*data_vars)\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/dask/array/routines.py:332: PerformanceWarning: Increasing number of chunks by factor of 30\n  intermediate = blockwise(\n"},"children":[],"key":"B7nsp63R6i"}],"key":"NDGtmYu6eA"}],"key":"x6uBTnPdt3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dye1_alk4_rg.load()","key":"iKG3TAlp58"},{"type":"outputs","id":"GPWB5OsXRBqEMLZ8lJnMG","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));\n  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));\n  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));\n  --xr-border-color: var(--jp-border-color2, #e0e0e0);\n  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);\n  --xr-background-color: var(--jp-layout-color0, white);\n  --xr-background-color-row-even: var(--jp-layout-color1, white);\n  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);\n}\n\nhtml[theme=dark],\nhtml[data-theme=dark],\nbody[data-theme=dark],\nbody.vscode-dark {\n  --xr-font-color0: rgba(255, 255, 255, 1);\n  --xr-font-color2: rgba(255, 255, 255, 0.54);\n  --xr-font-color3: rgba(255, 255, 255, 0.38);\n  --xr-border-color: #1F1F1F;\n  --xr-disabled-color: #515151;\n  --xr-background-color: #111111;\n  --xr-background-color-row-even: #111111;\n  --xr-background-color-row-odd: #313131;\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0);\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: '►';\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: '▼';\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: '(';\n}\n\n.xr-dim-list:after {\n  content: ')';\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: ',';\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  margin-bottom: 0;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  background-color: var(--xr-background-color) !important;\n  padding-bottom: 5px !important;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray (time: 168, lat: 1442, lon: 722)&gt; Size: 1GB\narray([[[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n...\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]]])\nCoordinates:\n  * lon      (lon) float64 6kB 337.7 337.7 337.7 337.7 ... 338.7 338.7 338.7\n  * lat      (lat) float64 12kB 64.22 64.22 64.22 64.22 ... 64.42 64.42 64.42\nDimensions without coordinates: time\nAttributes:\n    regrid_method:  bilinear</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'></div><ul class='xr-dim-list'><li><span>time</span>: 168</li><li><span class='xr-has-index'>lat</span>: 1442</li><li><span class='xr-has-index'>lon</span>: 722</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-e681f179-e80b-4895-bea8-d487c760744a' class='xr-array-in' type='checkbox' checked><label for='section-e681f179-e80b-4895-bea8-d487c760744a' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0</span></div><div class='xr-array-data'><pre>array([[[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n...\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]]])</pre></div></div></li><li class='xr-section-item'><input id='section-b0a2ae4f-84c2-4acc-8972-5be4e9f777df' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b0a2ae4f-84c2-4acc-8972-5be4e9f777df' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>337.7 337.7 337.7 ... 338.7 338.7</div><input id='attrs-65b5248e-9eb5-4067-93cd-d080e31879d9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-65b5248e-9eb5-4067-93cd-d080e31879d9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7847b481-43cf-4fb4-92b3-f5d3ba1b531f' class='xr-var-data-in' type='checkbox'><label for='data-7847b481-43cf-4fb4-92b3-f5d3ba1b531f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([337.745681, 337.746939, 337.748198, ..., 338.650544, 338.651802,\n       338.653061])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>64.22 64.22 64.22 ... 64.42 64.42</div><input id='attrs-8f279440-f9db-4efa-9a1f-59f36c7e0ece' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8f279440-f9db-4efa-9a1f-59f36c7e0ece' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a4ee93c0-171b-4822-9d43-93f5031b6069' class='xr-var-data-in' type='checkbox'><label for='data-a4ee93c0-171b-4822-9d43-93f5031b6069' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([64.221147, 64.221283, 64.22142 , ..., 64.417747, 64.417884, 64.418021])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-604082be-23b6-4ab8-9d14-625eb3392c91' class='xr-section-summary-in' type='checkbox'  ><label for='section-604082be-23b6-4ab8-9d14-625eb3392c91' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d80344d4-f5fd-4b74-9d22-1be79564746f' class='xr-index-data-in' type='checkbox'/><label for='index-d80344d4-f5fd-4b74-9d22-1be79564746f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 337.7456809637103, 337.74693946519585,  337.7481979666814,\n       337.74945646816695,  337.7507149696525, 337.75197347113806,\n        337.7532319726236, 337.75449047410916,  337.7557489755947,\n       337.75700747708026,\n       ...\n       338.64173402142313,  338.6429925229087, 338.64425102439424,\n        338.6455095258798, 338.64676802736534,  338.6480265288509,\n       338.64928503033644,   338.650543531822, 338.65180203330755,\n        338.6530605347931],\n      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=722))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-2a6eb091-f511-4e3f-90f2-c14878b4a79d' class='xr-index-data-in' type='checkbox'/><label for='index-2a6eb091-f511-4e3f-90f2-c14878b4a79d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([64.22114671124693, 64.22128333440197, 64.22141995755702,\n       64.22155658071206,  64.2216932038671, 64.22182982702215,\n       64.22196645017719, 64.22210307333224, 64.22223969648728,\n       64.22237631964232,\n       ...\n        64.4167910692692, 64.41692769242424, 64.41706431557928,\n       64.41720093873433, 64.41733756188937, 64.41747418504441,\n       64.41761080819946,  64.4177474313545, 64.41788405450954,\n       64.41802067766459],\n      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=1442))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ddd52647-bbe7-4af7-9cb8-1cfd22f4f041' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ddd52647-bbe7-4af7-9cb8-1cfd22f4f041' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>regrid_method :</span></dt><dd>bilinear</dd></dl></div></li></ul></div></div>","content_type":"text/html"},"text/plain":{"content":"<xarray.DataArray (time: 168, lat: 1442, lon: 722)> Size: 1GB\narray([[[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n...\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]],\n\n       [[0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        ...,\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.],\n        [0., 0., 0., ..., 0., 0., 0.]]])\nCoordinates:\n  * lon      (lon) float64 6kB 337.7 337.7 337.7 337.7 ... 338.7 338.7 338.7\n  * lat      (lat) float64 12kB 64.22 64.22 64.22 64.22 ... 64.42 64.42 64.42\nDimensions without coordinates: time\nAttributes:\n    regrid_method:  bilinear","content_type":"text/plain"}}},"children":[],"key":"PgUGVOXO6l"}],"key":"gETlKva1Du"}],"key":"jPyQVy2z4R"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import cartopy.io.img_tiles as cimgt\n\nrequest = cimgt.OSM()\nextent = [-21.6, -21.35, 64.325, 64.42]\n\nfrom matplotlib import pyplot as plt\nfrom celluloid import Camera\nfrom IPython.display import HTML\n\nfig, ax = plt.subplots(figsize=(7,7),subplot_kw={'projection': ccrs.Mercator()},layout='tight')\ncamera = Camera(fig)\nax = plt.axes(projection=request.crs)\nax.set_extent(extent)\n\nax.add_image(request, 12)\nk1=1\nk2=580\nk3=5\nlevels=np.arange(k1, k2, k3)\n   \n\nlevels2=np.arange(0, 10, 1)\n\nfor i in range(167):\n    \n    ax.text(0.8, 0.999, 't='+str(i+1)+' hours', transform=ax.transAxes)\n\n    cf2=plt.contourf(dye1_alk4_rg.lon,dye1_alk4_rg.lat,mask_regrid.where(mask_regrid!=0),levels2, cmap='Greys', transform=ccrs.PlateCarree())\n    \n    cf1=plt.contourf(dye1_alk4_rg.lon,dye1_alk4_rg.lat,dye1_alk4_rg[i,:,:],levels, vmin=1, vmax=70,transform=ccrs.PlateCarree())\n\n    \n    camera.snap()\n\n    plt.title('fixed point source 96 hr release')\n    \nax.scatter(-21.465, 64.396, color=\"black\", marker=\"v\", transform=ccrs.PlateCarree(),label= \"release point\")\ngls=ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=True,\n                    color='darkgray', alpha=0.5, linestyle='--')\ngls.top_labels=False   # suppress top labels\ngls.right_labels=False # suppress right labels\n\nax.set_extent([-21.6, -21.35, 64.325, 64.42], ccrs.PlateCarree())\nax.legend()\ncb1 = plt.colorbar(cf1,shrink=0.3)\ncb1.set_label('mmol/m$^3$ surf. alk', fontsize=10)\n\nanimation = camera.animate()\nHTML(animation.to_html5_video())","key":"TZHadRjvI1"},{"type":"outputs","id":"1WcFIsYeklKYcsdqqG0Vu","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":25,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"cc58860f6874f2460b699c9ebee2f923","path":"/cc58860f6874f2460b699c9ebee2f923.html"},"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"}}},"children":[],"key":"KVrkncgX7X"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a9f64530684e615fbaa8893dfbb0e684","path":"/a9f64530684e615fbaa8893dfbb0e684.png"},"text/plain":{"content":"<Figure size 700x700 with 3 Axes>","content_type":"text/plain"}}},"children":[],"key":"RXei5TJNhT"}],"key":"GhuURw9GXN"}],"key":"Yqlsw8ha7h"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"animation.save(\"96_hr_30IBC_withmap.mp4\")","key":"LGrV7l5d3p"},{"type":"outputs","id":"fTwzNu1GCXdBf7mpJlM5Y","children":[],"key":"WGsdclIlka"}],"key":"xsbRFTF7A0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dye1_alk4_rg.shape","key":"f4zK2A0sus"},{"type":"outputs","id":"fEW18wZRWlI2wo9zD2r7W","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"(168, 1442, 722)","content_type":"text/plain"}}},"children":[],"key":"oBVU02e8Xr"}],"key":"s0nXYzi5fb"}],"key":"Iv5Ru4Lffo"}],"key":"JzjkTAbRnO"},"references":{"cite":{"order":[],"data":{}}}}