{"version":3,"kind":"Notebook","sha256":"c643534fe7c60d0c15a88b858eee7c8505df2c192778ed47102cf55557e8aec4","slug":"ctd-comparison-river-copy1","location":"/CTD_comparison-RIVER-Copy1.ipynb","dependencies":[],"frontmatter":{"title":"Observation to Model Comparison: CTDs","content_includes_title":false,"kernelspec":{"name":"roms-tools","display_name":"Python (My roms-tools Kernel)","language":"python"},"exports":[{"format":"ipynb","filename":"CTD_comparison-RIVER-Copy1.ipynb","url":"/CTD_comparison-RIVER-9162513ac8376f07bce7cd8cf95fa06a.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"This notebook extracts CDT data in the xls format and extracts model data for those locations and plots\ncomparisons","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"bdHsMgubl2"}],"key":"V1H4CbSIPX"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Note: for now we have April through July 2024 data","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"aXII5QJnPc"}],"key":"LHZlJgukvg"}],"key":"FXkkdSDpNb"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import subprocess\nimport os\nimport pandas as pd\nimport netCDF4\nimport numpy as np\nimport glob\nimport time\nimport matplotlib.pyplot as plt\nimport copy\n\nimport xarray as xr\nfrom datetime import datetime, timedelta \nimport dask\nfrom scipy.interpolate import griddata\n#from ocean_c_lab_tools import *\n#from celluloid import Camera \n#import PyCO2SYS as csys\n#import seawater as sw\nfrom roms_regrid import *","visibility":"show","key":"RoufhWnBJe"},{"type":"outputs","id":"eDu4b5WwKsOHcEHAZiynF","children":[],"visibility":"show","key":"jh3RPgFFqk"}],"visibility":"show","key":"alf5004yZk"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Extract observation data and read into xarray","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PhEY2EHXUF"}],"identifier":"extract-observation-data-and-read-into-xarray","label":"Extract observation data and read into xarray","html_id":"extract-observation-data-and-read-into-xarray","implicit":true,"key":"OE2T4H6AkM"}],"key":"GdWJFtPxix"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"xls = pd.ExcelFile('/home/x-uheede/R/HAFRO/Hafro_cruises.xls')\n\n# combined dataset\ncombo = pd.read_excel(xls, 'combo',decimal='.')\n\nobs=xr.Dataset.from_dataframe(combo)\n\n# reformat into xarray dataset\nobs=obs.set_index(index=['HV','Depth','mon/day/yr'])\nobs=obs.drop_duplicates('index')\nobs=obs.unstack('index')\nobs=obs.rename(name_dict={'mon/day/yr':'time','Depth':'depth','Latitude(¬∞N)':'lat','Longitude(¬∞E)':'lon'})\n","visibility":"show","key":"u0iJVkmAWN"},{"type":"outputs","id":"Oid4lnbrtBO0DZDjYDCrd","children":[],"visibility":"show","key":"oyLavDt7Jl"}],"visibility":"show","key":"Pu4I4Fh1yM"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"extract locations based on HV (which is station ID)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"shfwxWbXcF"}],"identifier":"extract-locations-based-on-hv-which-is-station-id","label":"extract locations based on HV (which is station ID)","html_id":"extract-locations-based-on-hv-which-is-station-id","implicit":true,"key":"KtTIEnyVuS"}],"visibility":"show","key":"hQksH76MMk"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"\n# define location which calculations the average location of each station\ndef get_location(obs, hv_values):\n    locations = []\n    for hv in hv_values:\n        lat = obs['lat'].sel(HV=hv).isel(depth=0).mean('time').squeeze().values\n        lon = obs['lon'].sel(HV=hv).isel(depth=0).mean('time').squeeze().values + 360\n        locations.append([lat, lon])\n    return locations\n\n# List of HV values\nhv_values = range(1, 13)\n\n# Get the locations\nlocations = get_location(obs, hv_values)\n\n\n","visibility":"show","key":"jCGrgMV4Hu"},{"type":"outputs","id":"P4i9AIjr4PeejfcDwFeC9","children":[],"visibility":"show","key":"GyoedkS78j"}],"visibility":"show","key":"wx2CHZew7r"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load and regrid model-data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fu1x50wOvJ"}],"identifier":"load-and-regrid-model-data","label":"Load and regrid model-data","html_id":"load-and-regrid-model-data","implicit":true,"key":"WKtXmEbr1W"}],"visibility":"show","key":"IA8Dg2l1F7"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"\n#x=xr.open_mfdataset('/pscratch/sd/u/uheede/from_expanse/Iceland3/*', combine='nested', concat_dim=[\"time\"])\n# open dataset\nx=xr.open_mfdataset('/home/x-uheede/S/Iceland3_NOMARBL/Iceland3_MARBL_2024_rst.20240[3-4]??00????.nc', combine='nested', concat_dim=[\"time\"])\n\n# open grid\ngrid=xr.open_mfdataset('/home/x-uheede/S/Iceland3_MARBL_2024_60m/P_INPUT/Iceland3_grid_MAT.nc')\nx=x.thin({'time': 24})\nx_mean=x.sel(depth=[-0,-1,-2,-3,-4,-5,-7,-9,-10,-12,-14,-15,-16,-18,-20,-26,-30,-36,-40,-50,-80]).mean('time')\nx_std=x.sel(depth=[-0,-1,-2,-3,-4,-5,-7,-9,-10,-12,-14,-15,-16,-18,-20,-26,-30,-36,-40,-50,-80]).std('time')\nx=xr.concat([x_mean,x_std],dim=\"type\")\nt=x['t']\ns=x['s']\n\n# regridding\nt=roms_regrid(grid,t)\ns=roms_regrid(grid,s)\nmask=roms_regrid(grid,grid['mask_rho'])\nt=t.where(t != 0)\ns=s.where(s != 0)\n;","visibility":"show","key":"XoPHF20VgO"},{"type":"outputs","id":"h2a4X58sxKxLrY3m6GJK3","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"''","content_type":"text/plain"}}},"children":[],"key":"e3RLpxSwXX"}],"visibility":"show","key":"lvGlrnf2pR"}],"visibility":"show","key":"PN7TYm3Gt2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x","key":"cWH1pwTtO7"},{"type":"outputs","id":"4X2staDK8qmOKCyYxgXLU","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/html":{"content_type":"text/html","hash":"f1cce82fd30281db883fad9fad999fef","path":"/f1cce82fd30281db883fad9fad999fef.html"},"text/plain":{"content":"<xarray.Dataset> Size: 350MB\nDimensions:     (type: 2, depth: 21, eta_rho: 722, xi_rho: 722, xi_u: 721,\n                 eta_v: 721)\nCoordinates:\n  * depth       (depth) float32 84B -0.0 -1.0 -2.0 -3.0 ... -40.0 -50.0 -80.0\nDimensions without coordinates: type, eta_rho, xi_rho, xi_u, eta_v\nData variables:\n    ocean_time  (type) float64 16B dask.array<chunksize=(1,), meta=np.ndarray>\n    t           (type, depth, eta_rho, xi_rho) float32 88MB dask.array<chunksize=(1, 21, 722, 722), meta=np.ndarray>\n    s           (type, depth, eta_rho, xi_rho) float32 88MB dask.array<chunksize=(1, 21, 722, 722), meta=np.ndarray>\n    u           (type, depth, eta_rho, xi_u) float32 87MB dask.array<chunksize=(1, 21, 722, 721), meta=np.ndarray>\n    v           (type, depth, eta_v, xi_rho) float32 87MB dask.array<chunksize=(1, 21, 721, 722), meta=np.ndarray>","content_type":"text/plain"}}},"children":[],"key":"nopSWo7JvG"}],"key":"kuGufzwNj2"}],"key":"zo3hoGp4TA"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"t.load()\n#t.to_netcdf('/global/cfs/cdirs/m4746/Users/ulla/run/Iceland3_MARBL/t_06.nc')\n;","visibility":"show","key":"PupqC6d0g7"},{"type":"outputs","id":"9Rv6UqQFAozuht5UXX1n-","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/dask/array/numpy_compat.py:57: RuntimeWarning: invalid value encountered in divide\n  x = np.divide(x1, x2, out)\n"},"children":[],"key":"xygqUAWR75"},{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"''","content_type":"text/plain"}}},"children":[],"key":"wyW9NLMK6w"},{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/dask/array/numpy_compat.py:57: RuntimeWarning: invalid value encountered in divide\n  x = np.divide(x1, x2, out)\n"},"children":[],"key":"sJ1KO1aQei"}],"visibility":"show","key":"ZIK2tlC4hn"}],"visibility":"show","key":"q7Eu4TF0f7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"plot a station overview","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ArPEabsBZW"}],"identifier":"plot-a-station-overview","label":"plot a station overview","html_id":"plot-a-station-overview","implicit":true,"key":"a3Bat7gH75"}],"key":"Anvefhzxoj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"s.load()\n#s.to_netcdf('/global/cfs/cdirs/m4746/Users/ulla/run/Iceland3_MARBL/s_06.nc')\n;","key":"rt9fjC3lu5"},{"type":"outputs","id":"bGOPs3LHmrtR7__kCwUQZ","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"''","content_type":"text/plain"}}},"children":[],"key":"hwra51X3YR"}],"key":"rCNodBQeyA"}],"key":"tDewn8hhyD"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import cartopy\nimport cartopy.crs as ccrs\nimport cartopy.feature as cfeature\nimport cartopy.io.img_tiles as cimgt\nfrom cartopy.mpl.ticker import LongitudeFormatter, LatitudeFormatter\nimport matplotlib.pyplot as plt\n\nfig = plt.figure(figsize=(12, 12), dpi=300)\nax = fig.add_subplot(1, 1, 1, projection=ccrs.PlateCarree())\n\n# Plot the background t contour from ROMS\nax.contourf(t.lon, t.lat, t.isel(depth=0).isel(type=0), transform=ccrs.PlateCarree())\n\n# Plot stations\nfor i, loc in enumerate(locations, start=1):\n    ax.text(loc[1], loc[0], str(i), color='red', size=10, ha='center', va='center', transform=ccrs.PlateCarree())\n\nplt.show()","visibility":"show","key":"c5r9atX5Ty"},{"type":"outputs","id":"J2ewql3yCNZlmLyiKyUGK","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3c99ab31ba2b09091af4324e5356322c","path":"/3c99ab31ba2b09091af4324e5356322c.png"},"text/plain":{"content":"<Figure size 3600x3600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"O6Vi4nhGjo"}],"visibility":"show","key":"P8KQ4yiZQ3"}],"visibility":"show","key":"IVS2Q65voD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"diXuY919e6"},{"type":"outputs","id":"G7G6Qb44kyl8wNt1HdEZd","children":[],"key":"vRUt3YyC3X"}],"key":"b7DA28jsbL"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot mean profiles of each station (Temperature)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pkhbqY9WW7"}],"identifier":"plot-mean-profiles-of-each-station-temperature","label":"Plot mean profiles of each station (Temperature)","html_id":"plot-mean-profiles-of-each-station-temperature","implicit":true,"key":"ZSASCRjCHg"}],"key":"qMhXLuqXVu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"\n# Assuming locations is a list of lat/lon pairs\nt_values = []\ns_values = []\n# Loop over the first 10 locations and store each selection in t_values\nfor i in range(12):\n    lat, lon = locations[i]\n    \n    # Select the 't' values at the nearest lat/lon\n    t_selected = t.sel(lat=lat, method='nearest').sel(lon=lon, method='nearest')\n    s_selected = s.sel(lat=lat, method='nearest').sel(lon=lon, method='nearest')\n    \n    # Store the result in the list\n    t_values.append(t_selected)\n    s_values.append(s_selected)\n\n# Combine the selections into an xarray Dataset or DataArray\nt_values_combined = xr.concat(t_values, dim='location')\ns_values_combined = xr.concat(s_values, dim='location')\n\n# Assign a location coordinate for clarity (optional)\nt_values_combined = t_values_combined.assign_coords(location=('location', range(1, 13)))\ns_values_combined = s_values_combined.assign_coords(location=('location', range(1, 13)))\nt_values_combined['depth']=t_values_combined.depth*(-1)\ns_values_combined['depth']=s_values_combined.depth*(-1)\n# Now you have t_values as an xarray object (Dataset or DataArray)\n#print(t_values_combined)\n","key":"ksEMWwvXnh"},{"type":"outputs","id":"BgZFXQMDmFv4u9N5GBnTh","children":[],"key":"Iab3JMk3Ng"}],"key":"m07UfMA5cL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\n\n# Set up the subplots\nfig, axarr = plt.subplots(nrows=3, ncols=4, figsize=(12, 6*1.2), constrained_layout=True)\nax = axarr.flatten()  # Flatten to make indexing easier\npalette = plt.get_cmap('tab20')\n\n# Loop through 12 locations\nfor i in range(12):\n    loc = i + 1  # location index starts at 1\n\n    # Extract model data\n    model_mean = s_values_combined.sel(type=0).sel(location=loc)\n    model_std = s_values_combined.sel(type=1).sel(location=loc)\n\n    # Plot model average\n    ax[i].plot(model_mean, s_values_combined.depth, label='Model Avg (May-Sep)', color='black')\n\n    # Plot shaded region for model standard deviation\n    ax[i].fill_betweenx(s_values_combined.depth, model_mean - model_std, model_mean + model_std, \n                         color='grey', alpha=0.4, label='Model Std Dev')\n\n    # Extract observed data\n    ax[i].plot(obs['Salinity'].sel(HV=loc).dropna(dim='depth', how='all').sel(time=slice('05-01-2024', '09-15-2024')).mean('time'),\n            obs.sel(HV=loc).dropna(dim='depth', how='all').depth, label='Obs', color=palette(2))\n\n    obs_std = obs['Salinity'].sel(HV=loc).dropna(dim='depth', how='all').sel(time=slice('05-01-2024', '09-15-2024')).std('time')\n\n\n    # Plot shaded region for observed standard deviation\n    ax[i].fill_betweenx(obs.depth, (obs['Salinity'].sel(HV=loc).sel(time=slice('05-01-2024', '09-15-2024')).mean('time')-obs['Salinity'].sel(HV=loc).sel(time=slice('05-01-2024', '09-15-2024')).std('time')),(obs['Salinity'].sel(HV=loc).sel(time=slice('05-01-2024', '09-15-2024')).mean('time')+obs['Salinity'].sel(HV=loc).sel(time=slice('05-01-2024', '09-15-2024')).std('time')), color=palette(2), alpha=0.4)\n\n    # Set depth limits for specific subplots\n    ax[0].set_ylim(0,35)\n    ax[2].set_ylim(0,25)\n    ax[3].set_ylim(0,30)\n    ax[4].set_ylim(0,70)\n    ax[5].set_ylim(0,28)\n    ax[6].set_ylim(0,25)\n    ax[7].set_ylim(0,25)\n    ax[8].set_ylim(0,20)\n    ax[9].set_ylim(0,60)\n    ax[11].set_ylim(0,6)\n\n    # Set title, labels\n    ax[i].set_title(f'Salinity CTD Station: {obs.HV[loc - 1].values}')\n    ax[i].set_xlabel('psu')\n    ax[i].set_ylabel('Depth')\n\n    # Show legend only for the first subplot\n    if i == 1:\n        ax[i].legend()\n\nfor i in range(12):\n    ax[i].invert_yaxis()\n    \n# Display the plot\nplt.show()\n","key":"ELxA6g6NDp"},{"type":"outputs","id":"Cr3isSv-Eq6ylJgz-TgPt","children":[{"type":"output","jupyter_data":{"name":"stderr","output_type":"stream","text":"/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n/global/homes/u/uheede/.conda/envs/xesmf_env/lib/python3.12/site-packages/numpy/lib/_nanfunctions_impl.py:2035: RuntimeWarning: Degrees of freedom <= 0 for slice.\n  var = nanvar(a, axis=axis, dtype=dtype, out=out, ddof=ddof,\n"},"children":[],"key":"WgDl6EbplH"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1fd173d81e657684303d560a26e70297","path":"/1fd173d81e657684303d560a26e70297.png"},"text/plain":{"content":"<Figure size 1200x720 with 12 Axes>","content_type":"text/plain"}}},"children":[],"key":"rf7btoads5"}],"key":"ULS85pnIJ0"}],"key":"LduxFR5iZC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\n\n# Set up the subplots\nfig, axarr = plt.subplots(nrows=3, ncols=4, figsize=(12, 6*1.2), constrained_layout=True)\nax = axarr.flatten()  # Flatten to make indexing easier\npalette = plt.get_cmap('tab20')\n\n# Loop through 12 locations\nfor i in range(12):\n    loc = i + 1  # location index starts at 1\n\n    # Plot model average from mid-May 2012\n    ax[i].plot(t_values_combined.sel(type=0).sel(location=loc), t_values_combined.depth,\n               label='model average from mid-May 2023', color='black')\n    \n    # Plot model standard deviation\n   # ax[i].plot(t_values_combined.sel(type=0).sel(location=loc) + t_values_combined.sel(type=1).sel(location=loc),\n   #            t_values_combined.depth, label='model standard deviation', color='grey', alpha=0.4)\n    \n    #ax[i].plot(t_values_combined.sel(type=0).sel(location=loc) - t_values_combined.sel(type=1).sel(location=loc),\n     #          t_values_combined.depth, color='grey', alpha=0.4)\n    \n    # Plot observed salinity for May 2024\n    ax[i].plot(obs['Temperature'].sel(HV=loc).sel(time=slice('05-01-2024', '05-30-2024')).mean('time'),\n               obs.depth, label='Obs', color=palette(2))\n    \n    ax[i].plot(obs['Temperature'].sel(HV=loc).sel(time=slice('05-01-2024', '05-30-2024')).mean('time')+obs['Temperature'].sel(HV=loc).sel(time=slice('05-01-2024', '05-30-2024')).std('time'),\n               obs.depth, color=palette(2),alpha=0.4)\n    \n    ax[i].plot(obs['Temperature'].sel(HV=loc).sel(time=slice('05-01-2024', '05-30-2024')).mean('time')-obs['Temperature'].sel(HV=loc).sel(time=slice('05-01-2024', '05-30-2024')).std('time'),\n               obs.depth, color=palette(2),alpha=0.4)\n    \n    # Invert y-axis\n    ax[i].invert_yaxis()\n    \n    # Set title, labels, and legend for each subplot\n    ax[i].set_title('Temperature CTD Station: ' + str(obs.HV[loc - 1].values))  # Title for each location\n    ax[i].set_xlabel('psu')\n    ax[i].set_ylabel('Depth')\n    \n    # Set limits (optional)\n    #ax[i].set_xlim(32, 35)  # Example x-axis limits for psu\n    \n    # Only show the legend for the first subplot\n    if i == 0:\n        ax[i].legend()\n\n# Display the plot\nplt.show()\n","key":"fCUUXzRvzj"},{"type":"outputs","id":"6gNdZtjsSrqD6F-tgXOn_","children":[],"key":"ZvWRqfx0aj"}],"key":"wtmHFiFhlQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"create salinity contourplots","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"syXhILraPt"}],"identifier":"create-salinity-contourplots","label":"create salinity contourplots","html_id":"create-salinity-contourplots","implicit":true,"key":"Xt8L2E0bfI"}],"key":"RqalXfBBVx"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"loc = np.array(locations)\nlevels_psu=np.arange(31,35,0.1)\nlevels_t=np.arange(2.5,10,0.2)\ndata_psu1=obs['Salinity'].sel(HV=[1,3,5,7,9,10,12]).mean('time')\ndata_psu2=obs['Salinity'].sel(HV=[2,3,4]).mean('time')\ndata_t=obs['Temperature'].sel(HV=[1,3,5,7,9,10,12]).mean('time')\n\nfig, axarr = plt.subplots(nrows=1, ncols=2, figsize=(6*2, 3), constrained_layout=True)\nax = axarr.flatten()\nc0=ax[0].contourf(loc[[1-1,3-1,5-1,7-1,9-1,10-1,12-1],1]-360,data_psu1.depth, data_psu1.transpose(),levels_psu)\n\n#ax[1].contourf(loc[[1-1,3-1,5-1,7-1,9-1,10-1,12-1],1]-360,data.depth, data_t.transpose(),levels_t)\n#ax[1].invert_yaxis()\nc1=ax[1].contourf(loc[[2-1,3-1,4-1],0],data_psu2.depth, data_psu2.transpose(),levels_psu)\n\nax[0].set_title('along fjord mean salinity profile (Observed)')\nax[0].set_xlabel('longitude')\nax[0].set_ylabel('depth')\nax[0].set_ylim(0,40)\nplt.colorbar(c0,ax=ax[0], orientation='vertical', label='psu',shrink=0.5)\nax[0].invert_yaxis()\n\nax[1].set_title('across fjord mean salinity profile (Observed)')\nax[1].set_xlabel('latitude')\nax[1].set_ylabel('depth')\nax[1].set_ylim(0,40)\nplt.colorbar(c1, ax=ax[1], orientation='vertical', label='psu',shrink=0.5)\nax[1].invert_yaxis()","visibility":"show","key":"N5XrGJ9SAs"},{"type":"outputs","id":"YCfnssUAOObKrpT8VZaW_","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2a384e5a1f73cefb4f182188d998f2ff","path":"/2a384e5a1f73cefb4f182188d998f2ff.png"},"text/plain":{"content":"<Figure size 1200x300 with 4 Axes>","content_type":"text/plain"}}},"children":[],"key":"ruD29JxDb6"}],"visibility":"show","key":"T2K9vZPGQ3"}],"visibility":"show","key":"VRMsfaiEUR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"loc = np.array(locations)\nlevels_psu=np.arange(31,35,0.1)\nlevels_t=np.arange(2.5,10,0.2)\ndata_psu1=s_values_combined.sel(type=0).sel(location=[1,3,5,7,9,10,12])\ndata_psu2=s_values_combined.sel(type=0).sel(location=[2,3,4])\n\n\n#data_t=obs['Temperature'].sel(HV=[1,3,5,7,9,10,12]).mean('time')\n\nfig, axarr = plt.subplots(nrows=1, ncols=2, figsize=(6*2, 3), constrained_layout=True)\nax = axarr.flatten()\nc0=ax[0].contourf(loc[[1-1,3-1,5-1,7-1,9-1,10-1,12-1],1]-360,data_psu1.depth, data_psu1.transpose(),levels_psu)\n\n#ax[1].contourf(loc[[1-1,3-1,5-1,7-1,9-1,10-1,12-1],1]-360,data.depth, data_t.transpose(),levels_t)\n#ax[1].invert_yaxis()\nc1=ax[1].contourf(loc[[2-1,3-1,4-1],0],data_psu2.depth, data_psu2.transpose(),levels_psu)\n\nax[0].set_title('along fjord mean salinity profile (model)')\nax[0].set_xlabel('longitude')\nax[0].set_ylabel('depth')\nax[0].set_ylim(0,40)\nplt.colorbar(c0,ax=ax[0], orientation='vertical', label='psu',shrink=0.5)\nax[0].invert_yaxis()\n\nax[1].set_title('across fjord mean salinity profile (model)')\nax[1].set_xlabel('latitude')\nax[1].set_ylabel('depth')\nax[1].set_ylim(0,40)\nplt.colorbar(c1, ax=ax[1], orientation='vertical', label='psu',shrink=0.5)\nax[1].invert_yaxis()","key":"snBmk1o324"},{"type":"outputs","id":"zCOHwy-UuR4MGWrTm5ubU","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"eae0a458f51c0eb311107ef771d0292e","path":"/eae0a458f51c0eb311107ef771d0292e.png"},"text/plain":{"content":"<Figure size 1200x300 with 4 Axes>","content_type":"text/plain"}}},"children":[],"key":"PeplQFWHed"}],"key":"e7pZl18keU"}],"key":"cvE4ivHlZz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"loc = np.array(locations)\nlevels_psu=np.arange(31,35,0.1)\nlevels_t=np.arange(7,10,0.1)\ndata_psu1=obs['Salinity'].sel(HV=[1,3,5,7,9,10,12]).mean('time')\ndata_psu2=obs['Salinity'].sel(HV=[2,3,4]).mean('time')\ndata_t1=obs['Temperature'].sel(HV=[1,3,5,7,9,10,12]).sel(time=slice('05-01-2024', '09-30-2024')).mean('time')\ndata_t2=obs['Temperature'].sel(HV=[2,3,4]).sel(time=slice('05-01-2024', '09-30-2024')).mean('time')\n\nfig, axarr = plt.subplots(nrows=1, ncols=2, figsize=(6*2, 3), constrained_layout=True)\nax = axarr.flatten()\nc0=ax[0].contourf(loc[[1-1,3-1,5-1,7-1,9-1,10-1,12-1],1]-360,data_t1.depth, data_t1.transpose(),levels_t)\n\n#ax[1].contourf(loc[[1-1,3-1,5-1,7-1,9-1,10-1,12-1],1]-360,data.depth, data_t.transpose(),levels_t)\n#ax[1].invert_yaxis()\nc1=ax[1].contourf(loc[[2-1,3-1,4-1],0],data_t2.depth, data_t2.transpose(),levels_t)\n\nax[0].set_title('along fjord mean salinity profile (Observed)')\nax[0].set_xlabel('longitude')\nax[0].set_ylabel('depth')\nax[0].set_ylim(0,40)\nplt.colorbar(c0,ax=ax[0], orientation='vertical', label='psu',shrink=0.5)\nax[0].invert_yaxis()\n\nax[1].set_title('across fjord mean salinity profile (Observed)')\nax[1].set_xlabel('latitude')\nax[1].set_ylabel('depth')\nax[1].set_ylim(0,40)\nplt.colorbar(c1, ax=ax[1], orientation='vertical', label='psu',shrink=0.5)\nax[1].invert_yaxis()","key":"TGwzrLx99R"},{"type":"outputs","id":"j5bWPRHP_Q8mZ6Bvh1RBr","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4d97ba0d2d806b4173d2d37718e8d22a","path":"/4d97ba0d2d806b4173d2d37718e8d22a.png"},"text/plain":{"content":"<Figure size 1200x300 with 4 Axes>","content_type":"text/plain"}}},"children":[],"key":"oJ5EUSrNyR"}],"key":"dgqbeXQRON"}],"key":"eEv5KMYysA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"loc = np.array(locations)\nlevels_psu=np.arange(31,35,0.1)\nlevels_t=np.arange(7,10,0.1)\ndata_psu1=s_values_combined.sel(type=0).sel(location=[1,3,5,7,9,10,12])\ndata_psu2=s_values_combined.sel(type=0).sel(location=[2,3,4])\n\ndata_t1=t_values_combined.sel(type=0).sel(location=[1,3,5,7,9,10,12])\ndata_t2=t_values_combined.sel(type=0).sel(location=[2,3,4])\n\n\nfig, axarr = plt.subplots(nrows=1, ncols=2, figsize=(6*2, 3), constrained_layout=True)\nax = axarr.flatten()\nc0=ax[0].contourf(loc[[1-1,3-1,5-1,7-1,9-1,10-1,12-1],1]-360,data_t1.depth, data_t1.transpose(),levels_t)\n\n\nc1=ax[1].contourf(loc[[2-1,3-1,4-1],0],data_t2.depth, data_t2.transpose(),levels_t)\n\nax[0].set_title('along fjord mean temperature profile (model)')\nax[0].set_xlabel('longitude')\nax[0].set_ylabel('depth')\nax[0].set_ylim(0,40)\nplt.colorbar(c0,ax=ax[0], orientation='vertical', label='psu',shrink=0.5)\nax[0].invert_yaxis()\n\nax[1].set_title('across fjord mean temperature profile (model)')\nax[1].set_xlabel('latitude')\nax[1].set_ylabel('depth')\nax[1].set_ylim(0,40)\nplt.colorbar(c1, ax=ax[1], orientation='vertical', label='psu',shrink=0.5)\nax[1].invert_yaxis()","key":"etQthxXi4y"},{"type":"outputs","id":"NFGAM5MnwwUQJfYyhz4fF","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"692fb19f1bfd1003da6b86e9aab49eb6","path":"/692fb19f1bfd1003da6b86e9aab49eb6.png"},"text/plain":{"content":"<Figure size 1200x300 with 4 Axes>","content_type":"text/plain"}}},"children":[],"key":"bAG2W66sE4"}],"key":"ntpAzFhOGd"}],"key":"TVUMcjowXo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"\n#x=xr.open_mfdataset('/pscratch/sd/u/uheede/from_expanse/Iceland3/*', combine='nested', concat_dim=[\"time\"])\n# open dataset\nx=xr.open_mfdataset('/pscratch/sd/u/uheede/Iceland3_riv/z_Iceland3_MARBL_rnd.20230[5-9]????????.nc', combine='nested', concat_dim=[\"time\"])\nx=x.thin({'time': 24})\n\nocean_time=x['ocean_time']\nreference_date = np.datetime64('2000-01-01T00:00:00')\n\n# Convert seconds to datetime\ndatetime_array = reference_date + ocean_time.astype('timedelta64[s]')\n\n# open grid\ngrid=xr.open_mfdataset('/global/cfs/cdirs/m4632/uheede/work/Iceland3_MARBL/INPUT/Iceland3_grd.nc')\n\nx_mean=x.sel(depth=[-2,-3,-4,-5]).mean('depth')\nx_std=x.sel(depth=[-2,-3,-4,-5]).mean('depth')\nx=xr.concat([x_mean,x_std],dim=\"type\")\nt=x['t']\ns=x['s']\n\n# regridding\nt=roms_regrid(grid,t)\ns=roms_regrid(grid,s)\nmask=roms_regrid(grid,grid['mask_rho'])\nt=t.where(t != 0)\ns=s.where(s != 0)\n;","key":"rwOwQ09G8C"},{"type":"outputs","id":"giHT0x-glXK4LSuhB_Aqc","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"text/plain":{"content":"''","content_type":"text/plain"}}},"children":[],"key":"xK79OHdijP"}],"key":"vSJ07YkiNK"}],"key":"AjBHlViTu5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"\nt.load()\ns.load()\n;","key":"SIQaUwAezU"},{"type":"outputs","id":"wD2QLPvxDf_WdW7wPeqZZ","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":34,"metadata":{},"data":{"text/plain":{"content":"''","content_type":"text/plain"}}},"children":[],"key":"UhfjlNYL2l"}],"key":"bOxBgZLpqR"}],"key":"OzniRC4SI3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"\n# Assuming locations is a list of lat/lon pairs\nt_values = []\ns_values = []\n# Loop over the first 10 locations and store each selection in t_values\nfor i in range(12):\n    lat, lon = locations[i]\n    \n    # Select the 't' values at the nearest lat/lon\n    t_selected = t.sel(lat=lat, method='nearest').sel(lon=lon, method='nearest')\n    s_selected = s.sel(lat=lat, method='nearest').sel(lon=lon, method='nearest')\n    \n    # Store the result in the list\n    t_values.append(t_selected)\n    s_values.append(s_selected)\n\n# Combine the selections into an xarray Dataset or DataArray\nt_values_combined = xr.concat(t_values, dim='location')\ns_values_combined = xr.concat(s_values, dim='location')\n\n# Assign a location coordinate for clarity (optional)\nt_values_combined = t_values_combined.assign_coords(location=('location', range(1, 13)))\ns_values_combined = s_values_combined.assign_coords(location=('location', range(1, 13)))\n#t_values_combined['depth']=t_values_combined.depth*(-1)\n#s_values_combined['depth']=s_values_combined.depth*(-1)\n# Now you have t_values as an xarray object (Dataset or DataArray)\n#print(t_values_combined)\n","key":"hNWwN738w1"},{"type":"outputs","id":"jfwwCiIPNtp1owT7TrS51","children":[],"key":"iOkes7RVjX"}],"key":"LTfUyGqenU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"","key":"C82cigHlYQ"},{"type":"outputs","id":"F4zFhP-hM_4jzzp6yVeCc","children":[],"key":"stdj7mVLGb"}],"key":"Y6n9VdVveH"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compare with model (to be corrected when new model run is done)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IXX6IDXuGX"}],"identifier":"compare-with-model-to-be-corrected-when-new-model-run-is-done","label":"Compare with model (to be corrected when new model run is done)","html_id":"compare-with-model-to-be-corrected-when-new-model-run-is-done","implicit":true,"key":"xYxEDLniUz"}],"key":"CzCXk5EEsL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import matplotlib.pyplot as plt\n\n# Set up the subplots\nfig, axarr = plt.subplots(nrows=2, ncols=4, figsize=(12, 4*1.2), constrained_layout=True)\nax = axarr.flatten()  # Flatten to make indexing easier\npalette = plt.get_cmap('tab20')\n\n# Plot observed salinity for May 2024\nax[1].plot(obs.time.sel(time=slice('05-01-2024', '09-30-2024')),\n           obs['Salinity'].sel(depth=slice(2,5)).mean('depth').sel(HV=[1,3,4,5,6,7,8,9,10,12]).sel(time=slice('05-01-2024', '09-30-2024')).mean('HV'),\n           label='May', color=palette(2))\n\nax[0].plot(datetime_array, s_values_combined.sel(type=0).sel(location=[1,3,4,5,6,7,8,9,10,12]).mean('location'),\n           label='May', color=palette(1))\n\n# Plot observed salinity for May 2024\nax[3].plot(obs.time.sel(time=slice('05-01-2024', '09-30-2024')),\n           obs['Temperature'].sel(depth=slice(2,5)).mean('depth').sel(HV=[1,3,4,5,6,7,8,9,10,12]).sel(time=slice('05-01-2024', '09-30-2024')).mean('HV'),\n           label='May', color=palette(2))\nax[3].set_ylim(4.5,12.5)\n\nax[2].plot(datetime_array, t_values_combined.sel(type=0).sel(location=[1,3,4,5,6,7,8,9,10,12]).mean('location'),\n           label='May', color=palette(1))\nax[2].set_ylim(4.5,12.5)\nax[5].plot(obs.time.sel(time=slice('05-01-2024', '09-30-2024')),\n           obs['Salinity'].sel(depth=slice(2,5)).mean('depth').sel(HV=[1]).sel(time=slice('05-01-2024', '09-30-2024')).mean('HV'),\n           label='May', color=palette(2))\n\nax[4].plot(datetime_array, s_values_combined.sel(type=0).sel(location=[1]).mean('location'),\n           label='May', color=palette(1))\n\n# Plot observed salinity for May 2024\nax[7].plot(obs.time.sel(time=slice('05-01-2024', '09-30-2024')),\n           obs['Temperature'].sel(depth=slice(2,5)).mean('depth').sel(HV=[1]).sel(time=slice('05-01-2024', '09-30-2024')).mean('HV'),\n           label='May', color=palette(2))\nax[7].set_ylim(4.5,12.5)\nax[6].plot(datetime_array, t_values_combined.sel(type=0).sel(location=[1]).mean('location'),\n           label='May', color=palette(1))\nax[6].set_ylim(4.5,12.5)\n# Rotate x-axis labels for all subplots\nfor a in ax:\n    a.tick_params(axis='x', rotation=45)  # Adjust rotation angle as needed\n    \n    \nax[0].set_title('salinity for all stations,\\n 5 m depth MODEL')\nax[1].set_title('salinity for all stations,\\n 5 m depth OBS')\nax[2].set_title('temperature for all stations,\\n 5 m depth MODEL')\nax[3].set_title('temperate for all stations,\\n 5 m depth OBS')\nax[4].set_title('salinity for station 1,\\n 5 m depth MODEL')\nax[5].set_title('salinity for station 1,\\n 5 m depth OBS')\nax[6].set_title('temperature for station 1,\\n 5 m depth MODEL')\nax[7].set_title('temperate for station 1,\\n 5 m depth OBS')\nplt.show()\n\n","key":"C0TWHay3Wt"},{"type":"outputs","id":"BRoV7C5O0t5Kt5shCje9k","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5b55f7b91cc4954ee7f682608770a5d7","path":"/5b55f7b91cc4954ee7f682608770a5d7.png"},"text/plain":{"content":"<Figure size 1200x480 with 8 Axes>","content_type":"text/plain"}}},"children":[],"key":"XlVRylKxzM"}],"key":"ys9irjdla0"}],"key":"gf8K8easUT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ocean_time.load()","key":"agAaGGZ2Rb"},{"type":"outputs","id":"NSwxh3FNK80vzbjD_0BDp","children":[],"key":"KdkOFAmAwq"}],"key":"DzPMp9Xrzi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x['ocean_time'].load()","key":"i8Yh90z1I2"},{"type":"outputs","id":"plP6X7f6Gnk0mzmxnoGz3","children":[],"key":"NmcPrhRYO7"}],"key":"Em5Jlq422Y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.plot(t_values_combined.sel(type=0).sel(location=3))","key":"cBazqWBLsq"},{"type":"outputs","id":"MEYbWE0-PZnZ8veSGvt1C","children":[],"key":"u2DBaxpNMe"}],"key":"OD8TKLByKW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x","key":"FzmyPwclqo"},{"type":"outputs","id":"lO6sR9k3Dkk3cxbS0Vuxb","children":[],"key":"fdCzX6ffPj"}],"key":"IKVhPC0mnS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"obs","key":"gzG5Y1aR6y"},{"type":"outputs","id":"IcNj3Dbw9jEnFFKI1yMBl","children":[],"key":"V4IgKMWc9U"}],"key":"yTqpWiNczM"}],"key":"mYmxf5j2xR"},"references":{"cite":{"order":[],"data":{}}}}